var Ku=Object.create;var Je=Object.defineProperty;var Wu=Object.getOwnPropertyDescriptor;var zu=Object.getOwnPropertyNames;var Gu=Object.getPrototypeOf,Ju=Object.prototype.hasOwnProperty;var f=(e,t)=>()=>(e&&(t=e(e=0)),t);var w=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),m=(e,t)=>{for(var r in t)Je(e,r,{get:t[r],enumerable:!0})},Ln=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of zu(t))!Ju.call(e,n)&&n!==r&&Je(e,n,{get:()=>t[n],enumerable:!(o=Wu(t,n))||o.enumerable});return e};var v=(e,t,r)=>(r=e!=null?Ku(Gu(e)):{},Ln(t||!e||!e.__esModule?Je(r,"default",{value:e,enumerable:!0}):r,e)),Xu=e=>Ln(Je({},"__esModule",{value:!0}),e);var Mn=w((qy,qn)=>{"use strict";qn.exports=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var o,n,a;if(Array.isArray(t)){if(o=t.length,o!=r.length)return!1;for(n=o;n--!==0;)if(!e(t[n],r[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(a=Object.keys(t),o=a.length,o!==Object.keys(r).length)return!1;for(n=o;n--!==0;)if(!Object.prototype.hasOwnProperty.call(r,a[n]))return!1;for(n=o;n--!==0;){var s=a[n];if(!e(t[s],r[s]))return!1}return!0}return t!==t&&r!==r}});var Un=w(Ee=>{"use strict";var Qu=Ee&&Ee.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ee,"__esModule",{value:!0});Ee.initIsEqual=void 0;var Yu=Qu(Mn()),Zu=()=>{let e={isEqual:Yu.default};globalThis.toddle=e};Ee.initIsEqual=Zu});var j=w(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.toBoolean=de.isObject=de.isDefined=void 0;var hc=e=>e!=null;de.isDefined=hc;var gc=e=>typeof e=="object"&&e!==null;de.isObject=gc;var yc=e=>e!==!1&&e!==void 0&&e!==null;de.toBoolean=yc});var Le=w(it=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0});it.isToddleFormula=void 0;var bc=e=>Object.hasOwn(e,"formula");it.isToddleFormula=bc});var V=w(qe=>{"use strict";Object.defineProperty(qe,"__esModule",{value:!0});qe.isFormula=sa;qe.isFormulaApplyOperation=Fc;qe.applyFormula=q;var lt=j(),vc=Le();function sa(e){return e&&typeof e=="object"&&typeof e.type=="string"}function Fc(e){return e.type==="apply"}function q(e,t){if(!sa(e))return e;try{switch(e.type){case"value":return e.value;case"path":return e.path.reduce((r,o)=>r&&typeof r=="object"?r[o]:null,t.data);case"switch":{for(let r of e.cases)if((0,lt.toBoolean)(q(r.condition,t)))return q(r.formula,t);return q(e.default,t)}case"or":{for(let r of e.arguments)if((0,lt.toBoolean)(q(r.formula,t)))return!0;return!1}case"and":{for(let r of e.arguments)if(!(0,lt.toBoolean)(q(r.formula,t)))return!1;return!0}case"function":{let r=e.package??t.package,o=(t.toddle??globalThis.toddle)?.getCustomFormula(e.name,r),n=(t.toddle??globalThis.toddle).getFormula(e.name);if((0,lt.isDefined)(o)){let a=e.arguments.reduce((s,i,l)=>({...s,[i.name??`${l}`]:i.isFunction?u=>q(i.formula,{...t,data:{...t.data,Args:t.data.Args?{...u,"@toddle.parent":t.data.Args}:u}}):q(i.formula,t)}),{});try{return(0,vc.isToddleFormula)(o)?q(o.formula,{...t,data:{...t.data,Args:a}}):o.handler(a,{root:t.root??document,env:t.env})}catch(s){return t.toddle.errors.push(s),t.env?.logErrors,null}}else if(typeof n=="function"){let a=e.arguments.map(s=>s.isFunction?i=>q(s.formula,{...t,data:{...t.data,Args:t.data.Args?{...i,"@toddle.parent":t.data.Args}:i}}):q(s.formula,t));try{return n(a,t)}catch(s){return t.toddle.errors.push(s),t.env?.logErrors,null}}return t.env?.logErrors,null}case"object":return Object.fromEntries(e.arguments?.map(r=>[r.name,q(r.formula,t)])??[]);case"record":return Object.fromEntries(e.entries.map(r=>[r.name,q(r.formula,t)]));case"array":return e.arguments.map(r=>q(r.formula,t));case"apply":{let r=t.component.formulas?.[e.name];if(!r)return t.env?.logErrors,null;let o=Object.fromEntries(e.arguments.map(s=>s.isFunction?[s.name,i=>q(s.formula,{...t,data:{...t.data,Args:t.data.Args?{...i,"@toddle.parent":t.data.Args}:i}})]:[s.name,q(s.formula,t)])),n={...t.data,Args:t.data.Args?{...o,"@toddle.parent":t.data.Args}:o},a=t.formulaCache?.[e.name]?.get(n);if(a?.hit)return a.data;{let s=q(r.formula,{...t,data:n});return t.formulaCache?.[e.name]?.set(n,s),s}}default:t.env?.logErrors}}catch{return t.env?.logErrors,null}}});var Y=w(x=>{"use strict";Object.defineProperty(x,"__esModule",{value:!0});x.deepSortObject=x.easySort=x.sortObjectEntries=x.set=x.filterObject=x.groupBy=x.omitPaths=x.omitKeys=x.omit=x.mapValues=x.mapObject=x.isObject=void 0;x.get=ia;var Ac=j(),wc=e=>typeof e=="object"&&e!==null;x.isObject=wc;var Ec=(e,t)=>Object.fromEntries(Object.entries(e).map(t));x.mapObject=Ec;var Oc=(e,t)=>(0,x.mapObject)(e,([r,o])=>[r,t(o)]);x.mapValues=Oc;var jc=(e,t)=>{let[r,...o]=t,n=Array.isArray(e)?[...e]:(0,x.isObject)(e)?{...e}:{};return o.length===0?delete n[r]:n[r]=(0,x.omit)(n[r],o),n};x.omit=jc;var xc=(e,t)=>Object.fromEntries(Object.entries(e).filter(([r])=>!t.includes(r)));x.omitKeys=xc;var Cc=(e,t)=>t.reduce((r,o)=>(0,x.omit)(r,o),{...e});x.omitPaths=Cc;var Sc=(e,t)=>e.reduce((r,o)=>{let n=t(o);return r[n]=r[n]??[],r[n].push(o),r},{});x.groupBy=Sc;var _c=(e,t)=>Object.fromEntries(Object.entries(e).filter(t));x.filterObject=_c;function ia(e,[t,...r]){return r.length===0?e?.[t]:ia(e?.[t],r)}var kc=(e,t,r)=>{let[o,...n]=t,a=Array.isArray(e)?[...e]:(0,x.isObject)(e)?{...e}:{};return a[o]=n.length===0?r:(0,x.set)(a[o],n,r),a};x.set=kc;var Rc=(e,t,r=!0)=>(0,x.easySort)(Object.entries(e),t,r);x.sortObjectEntries=Rc;var Tc=(e,t,r=!0)=>[...e].sort((o,n)=>{let a=t(o),s=t(n);return a===s?0:(a>s?1:-1)*(r?1:-1)});x.easySort=Tc;var Pc=e=>(0,Ac.isDefined)(e)?Array.isArray(e)?e.map(t=>(0,x.deepSortObject)(t)):typeof e=="object"&&Object.keys(e).length>0?[...Object.keys(e)].sort().reduce((t,r)=>(t[r]=(0,x.deepSortObject)(e[r]),t),{}):e:e;x.deepSortObject=Pc});var la=w(ut=>{"use strict";Object.defineProperty(ut,"__esModule",{value:!0});ut.hash=void 0;var Hc=(e,t=0)=>{let r=3735928559^t,o=1103547991^t;for(let n=0,a;n<e.length;n++)a=e.charCodeAt(n),r=Math.imul(r^a,2654435761),o=Math.imul(o^a,1597334677);return r=Math.imul(r^r>>>16,2246822507),r^=Math.imul(o^o>>>13,3266489909),o=Math.imul(o^o>>>16,2246822507),o^=Math.imul(r^r>>>13,3266489909),4294967296*(2097151&o)+(r>>>0)};ut.hash=Hc});var ca=w(ct=>{"use strict";Object.defineProperty(ct,"__esModule",{value:!0});ct.ApiMethod=void 0;var ua;(function(e){e.GET="GET",e.POST="POST",e.DELETE="DELETE",e.PUT="PUT",e.PATCH="PATCH",e.HEAD="HEAD",e.OPTIONS="OPTIONS"})(ua||(ct.ApiMethod=ua={}))});var ft=w(ee=>{"use strict";Object.defineProperty(ee,"__esModule",{value:!0});ee.functionFormula=ee.pathFormula=ee.valueFormula=void 0;ee.getFormulasInFormula=B;ee.getFormulasInAction=ge;var dt=j(),da=V(),Dc=Le(),Ic=e=>({type:"value",value:e});ee.valueFormula=Ic;var $c=e=>({type:"path",path:e});ee.pathFormula=$c;var Nc=(e,t)=>({type:"function",name:e,package:t?.package,arguments:t?.arguments??[],variableArguments:t?.variableArguments});ee.functionFormula=Nc;function*B({formula:e,globalFormulas:t,path:r=[],visitedFormulas:o=new Set}){if((0,dt.isDefined)(e))switch(yield[r,e],e.type){case"path":case"value":break;case"record":for(let[n,a]of e.entries.entries())yield*B({formula:a.formula,globalFormulas:t,path:[...r,"entries",n,"formula"],visitedFormulas:o});break;case"function":{let n=[e.package,e.name].filter(dt.isDefined).join("/"),a=!o.has(n);o.add(n);let s=e.package?t.packages?.[e.package]?.formulas?.[e.name]:t.formulas?.[e.name];for(let[i,l]of(e.arguments??[]).entries())yield*B({formula:l.formula,globalFormulas:t,path:[...r,"arguments",i,"formula"],visitedFormulas:o});s&&(0,Dc.isToddleFormula)(s)&&a&&(yield*B({formula:s.formula,globalFormulas:t,path:[...r,"formula"],visitedFormulas:o}));break}case"array":case"or":case"and":case"object":for(let[n,a]of(e.arguments??[]).entries())yield*B({formula:a.formula,globalFormulas:t,path:[...r,"arguments",n,"formula"],visitedFormulas:o});break;case"apply":for(let[n,a]of(e.arguments??[]).entries())yield*B({formula:a.formula,globalFormulas:t,path:[...r,"arguments",n,"formula"],visitedFormulas:o});break;case"switch":for(let[n,a]of e.cases.entries())yield*B({formula:a.condition,globalFormulas:t,path:[...r,"cases",n,"condition"],visitedFormulas:o}),yield*B({formula:a.formula,globalFormulas:t,path:[...r,"cases",n,"formula"],visitedFormulas:o});yield*B({formula:e.default,globalFormulas:t,path:[...r,"default"],visitedFormulas:o});break}}function*ge({action:e,globalFormulas:t,path:r=[],visitedFormulas:o=new Set}){if((0,dt.isDefined)(e))switch(e.type){case"Fetch":for(let[n,a]of Object.entries(e.inputs??{}))yield*B({formula:a.formula,globalFormulas:t,path:[...r,"input",n,"formula"],visitedFormulas:o});for(let[n,a]of Object.entries(e.onSuccess?.actions??{}))yield*ge({action:a,globalFormulas:t,path:[...r,"onSuccess","actions",n],visitedFormulas:o});for(let[n,a]of Object.entries(e.onError?.actions??{}))yield*ge({action:a,globalFormulas:t,path:[...r,"onError","actions",n],visitedFormulas:o});for(let[n,a]of Object.entries(e.onMessage?.actions??{}))yield*ge({action:a,globalFormulas:t,path:[...r,"onMessage","actions",n],visitedFormulas:o});break;case"Custom":case void 0:(0,da.isFormula)(e.data)&&(yield*B({formula:e.data,globalFormulas:t,path:[...r,"data"],visitedFormulas:o}));for(let[n,a]of Object.entries(e.arguments??{}))yield*B({formula:a.formula,globalFormulas:t,path:[...r,"arguments",n,"formula"],visitedFormulas:o});for(let[n,a]of Object.entries(e.events??{}))for(let[s,i]of Object.entries(a.actions??{}))yield*ge({action:i,globalFormulas:t,path:[...r,"events",n,"actions",s],visitedFormulas:o});break;case"SetVariable":case"SetURLParameter":case"TriggerEvent":yield*B({formula:e.data,globalFormulas:t,path:[...r,"data"],visitedFormulas:o});break;case"TriggerWorkflow":for(let[n,a]of Object.entries(e.parameters??{}))yield*B({formula:a.formula,globalFormulas:t,path:[...r,"parameters",n,"formula"],visitedFormulas:o});break;case"Switch":(0,dt.isDefined)(e.data)&&(0,da.isFormula)(e.data)&&(yield*B({formula:e.data,globalFormulas:t,path:[...r,"data"],visitedFormulas:o}));for(let[n,a]of e.cases.entries()){yield*B({formula:a.condition,globalFormulas:t,path:[...r,"cases",n,"condition"],visitedFormulas:o});for(let[s,i]of Object.entries(a.actions))yield*ge({action:i,globalFormulas:t,path:[...r,"cases",n,"actions",s],visitedFormulas:o})}for(let[n,a]of Object.entries(e.default.actions))yield*ge({action:a,globalFormulas:t,path:[...r,"default","actions",n],visitedFormulas:o});break}}});var mr=w(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.LegacyToddleApi=void 0;var fa=V(),ne=ft(),Lc=j(),fr=class{api;key;globalFormulas;_apiReferences;constructor(t,r,o){this.api=t,this.key=r,this.globalFormulas=o}get apiReferences(){if(this._apiReferences)return this._apiReferences;let t=new Set,r=o=>{if((0,Lc.isDefined)(o))switch(o.type){case"path":o.path[0]==="Apis"&&t.add(o.path[1]);break;case"value":break;case"record":o.entries.forEach(n=>r(n.formula));break;case"function":case"array":case"or":case"and":case"apply":case"object":o.arguments?.forEach(n=>r(n.formula));break;case"switch":o.cases.forEach(n=>{r(n.condition),r(n.formula)});break}};return r(this.api.autoFetch),r(this.api.url),Object.values(this.api.path??{}).forEach(o=>r(o.formula)),Object.values(this.api.queryParams??{}).forEach(o=>r(o.formula)),(0,fa.isFormula)(this.api.headers)?r(this.api.headers):Object.values(this.api.headers??{}).forEach(o=>{r(o)}),r(this.api.body),this._apiReferences=t,t}get name(){return this.api.name}get type(){return this.api.type}get autoFetch(){return this.api.autoFetch}get url(){return this.api.url}get path(){return this.api.path}get proxy(){return this.api.proxy}get queryParams(){return this.api.queryParams}get headers(){return this.api.headers}get method(){return this.api.method}get body(){return this.api.body}get auth(){return this.api.auth}get throttle(){return this.api.throttle}get debounce(){return this.api.debounce}get onCompleted(){return this.api.onCompleted}get onFailed(){return this.api.onFailed}*formulasInApi(){let t=this.api,r=this.key;yield*(0,ne.getFormulasInFormula)({formula:t.autoFetch,globalFormulas:this.globalFormulas,path:["apis",r,"autoFetch"]}),yield*(0,ne.getFormulasInFormula)({formula:t.url,globalFormulas:this.globalFormulas,path:["apis",r,"url"]});for(let[o,n]of Object.entries(t.path??{}))yield*(0,ne.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"path",o,"formula"]});for(let[o,n]of Object.entries(t.queryParams??{}))yield*(0,ne.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"queryParams",o,"formula"]});if((0,fa.isFormula)(t.headers))yield*(0,ne.getFormulasInFormula)({formula:t.headers,globalFormulas:this.globalFormulas,path:["apis",r,"headers"]});else for(let[o,n]of Object.entries(t.headers??{}))yield*(0,ne.getFormulasInFormula)({formula:n,globalFormulas:this.globalFormulas,path:["apis",r,"headers",o]});yield*(0,ne.getFormulasInFormula)({formula:t.body,globalFormulas:this.globalFormulas,path:["apis",r,"body"]});for(let[o,n]of Object.entries(t.onCompleted?.actions??{}))yield*(0,ne.getFormulasInAction)({action:n,globalFormulas:this.globalFormulas,path:["apis",r,"onCompleted","actions",o]});for(let[o,n]of Object.entries(t.onFailed?.actions??{}))yield*(0,ne.getFormulasInAction)({action:n,globalFormulas:this.globalFormulas,path:["apis",r,"onFailed","actions",o]})}};mt.LegacyToddleApi=fr});var hr=w(pr=>{"use strict";Object.defineProperty(pr,"__esModule",{value:!0});pr.getActionsInAction=ye;var qc=j();function*ye(e,t=[]){if((0,qc.isDefined)(e))switch(yield[t,e],e.type){case"SetVariable":case"SetURLParameter":case"TriggerEvent":case"TriggerWorkflow":break;case"Fetch":for(let[r,o]of Object.entries(e.onSuccess?.actions??{}))yield*ye(o,[...t,"onSuccess","actions",r]);for(let[r,o]of Object.entries(e.onError?.actions??{}))yield*ye(o,[...t,"onError","actions",r]);for(let[r,o]of Object.entries(e.onMessage?.actions??{}))yield*ye(o,[...t,"onMessage","actions",r]);break;case"Custom":case void 0:for(let[r,o]of Object.entries(e.events??{}))for(let[n,a]of Object.entries(o?.actions??{}))yield*ye(a,[...t,"events",r,"actions",n]);break;case"Switch":for(let[r,o]of e.cases.entries())for(let[n,a]of Object.entries(o?.actions??{}))yield*ye(a,[...t,"cases",r,"actions",n]);for(let[r,o]of Object.entries(e.default.actions))yield*ye(o,[...t,"default","actions",r]);break}}});var br=w(pt=>{"use strict";Object.defineProperty(pt,"__esModule",{value:!0});pt.ToddleApiV2=void 0;var gr=hr(),L=ft(),Mc=j(),yr=class{api;_apiReferences;key;globalFormulas;constructor(t,r,o){this.api=t,this.key=r,this.globalFormulas=o}get apiReferences(){if(this._apiReferences)return this._apiReferences;let t=new Set,r=o=>{if((0,Mc.isDefined)(o))switch(o.type){case"path":o.path[0]==="Apis"&&t.add(o.path[1]);break;case"value":break;case"record":o.entries.forEach(n=>r(n.formula));break;case"function":case"array":case"or":case"and":case"apply":case"object":o.arguments?.forEach(n=>r(n.formula));break;case"switch":o.cases.forEach(n=>{r(n.condition),r(n.formula)});break}};return r(this.api.autoFetch),r(this.api.url),Object.values(this.api.path??{}).forEach(o=>r(o.formula)),Object.values(this.api.headers??{}).forEach(o=>r(o.formula)),r(this.api.body),Object.values(this.api.inputs).forEach(o=>r(o.formula)),Object.values(this.api.queryParams??{}).forEach(o=>{r(o.formula)}),r(this.api.server?.proxy?.enabled?.formula),r(this.api.server?.ssr?.enabled?.formula),r(this.api.client?.debounce?.formula),Object.values(this.api.redirectRules??{}).forEach(o=>{r(o.formula)}),r(this.api.isError?.formula),r(this.api.timeout?.formula),t.delete(this.key),this._apiReferences=t,t}get version(){return this.api.version}get name(){return this.api.name}get type(){return this.api.type}get autoFetch(){return this.api.autoFetch}get url(){return this.api.url}get path(){return this.api.path}get headers(){return this.api.headers}set headers(t){this.api.headers=t}get method(){return this.api.method}get body(){return this.api.body}get inputs(){return this.api.inputs}get queryParams(){return this.api.queryParams}get server(){return this.api.server}get client(){return this.api.client}get redirectRules(){return this.api.redirectRules}get isError(){return this.api.isError}get timeout(){return this.api.timeout}*formulasInApi(){let t=this.api,r=this.key;for(let[o,n]of Object.entries(this.api.inputs))yield*(0,L.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"inputs",o,"formula"]});yield*(0,L.getFormulasInFormula)({formula:t.autoFetch,globalFormulas:this.globalFormulas,path:["apis",r,"autoFetch"]}),yield*(0,L.getFormulasInFormula)({formula:t.url,globalFormulas:this.globalFormulas,path:["apis",r,"url"]});for(let[o,n]of Object.entries(t.path??{}))yield*(0,L.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"path",o,"formula"]});for(let[o,n]of Object.entries(t.queryParams??{}))yield*(0,L.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"queryParams",o,"formula"]}),yield*(0,L.getFormulasInFormula)({formula:n.enabled,globalFormulas:this.globalFormulas,path:["apis",r,"queryParams",o,"enabled"]});for(let[o,n]of Object.entries(t.headers??{}))yield*(0,L.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"headers",o,"formula"]}),yield*(0,L.getFormulasInFormula)({formula:n.enabled,globalFormulas:this.globalFormulas,path:["apis",r,"headers",o,"enabled"]});yield*(0,L.getFormulasInFormula)({formula:t.body,globalFormulas:this.globalFormulas,path:["apis",r,"body"]});for(let[o,n]of Object.entries(t.client?.onCompleted?.actions??{}))yield*(0,L.getFormulasInAction)({action:n,globalFormulas:this.globalFormulas,path:["apis",r,"client","onCompleted","actions",o]});for(let[o,n]of Object.entries(t.client?.onFailed?.actions??{}))yield*(0,L.getFormulasInAction)({action:n,globalFormulas:this.globalFormulas,path:["apis",r,"client","onFailed","actions",o]});yield*(0,L.getFormulasInFormula)({formula:t.client?.debounce?.formula,globalFormulas:this.globalFormulas,path:["apis",r,"client","debounce","formula"]});for(let[o,n]of Object.entries(t.client?.onMessage?.actions??{}))yield*(0,L.getFormulasInAction)({action:n,globalFormulas:this.globalFormulas,path:["apis",r,"client","onMessage","actions",o]});for(let[o,n]of Object.entries(t.redirectRules??{}))yield*(0,L.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"redirectRules",o,"formula"]});yield*(0,L.getFormulasInFormula)({formula:t.isError?.formula,globalFormulas:this.globalFormulas,path:["apis",r,"isError","formula"]}),yield*(0,L.getFormulasInFormula)({formula:t.timeout?.formula,globalFormulas:this.globalFormulas,path:["apis",r,"timeout","formula"]}),yield*(0,L.getFormulasInFormula)({formula:t.server?.proxy?.enabled.formula,globalFormulas:this.globalFormulas,path:["apis",r,"server","proxy","enabled","formula"]}),yield*(0,L.getFormulasInFormula)({formula:t.server?.ssr?.enabled?.formula,globalFormulas:this.globalFormulas,path:["apis",r,"server","ssr","enabled","formula"]})}*actionModelsInApi(){for(let[t,r]of Object.entries(this.api.client?.onCompleted?.actions??{}))yield*(0,gr.getActionsInAction)(r,["apis",this.key,"client","onCompleted","actions",t]);for(let[t,r]of Object.entries(this.api.client?.onFailed?.actions??{}))yield*(0,gr.getActionsInAction)(r,["apis",this.key,"client","onFailed","actions",t]);for(let[t,r]of Object.entries(this.api.client?.onMessage?.actions??{}))yield*(0,gr.getActionsInAction)(r,["apis",this.key,"client","onData","actions",t])}};pt.ToddleApiV2=yr});var Me=w(C=>{"use strict";Object.defineProperty(C,"__esModule",{value:!0});C.sortApiEntries=C.sortApiObjects=C.createApiEvent=C.isApiError=C.requestHash=C.getBaseUrl=C.getRequestHeaders=C.getRequestQueryParams=C.getRequestPath=C.applyAbortSignal=C.getUrl=C.createApiRequest=C.isLegacyApi=C.NON_BODY_RESPONSE_CODES=void 0;var ae=V(),ma=Y(),Uc=la(),fe=j(),be=ca(),pa=mr(),Bc=br();C.NON_BODY_RESPONSE_CODES=[101,204,205,304];var Vc=e=>e instanceof pa.LegacyToddleApi?!0:!("version"in e);C.isLegacyApi=Vc;var Kc=({api:e,formulaContext:t,baseUrl:r,defaultHeaders:o})=>{let n=(0,C.getUrl)(e,t,r),a=Jc({api:e,formulaContext:t,defaultHeaders:o});return{url:n,requestSettings:a}};C.createApiRequest=Kc;var Wc=(e,t,r)=>{let o="",n=new URLSearchParams,a,s=(0,ae.applyFormula)(e.url,t);if(["string","number"].includes(typeof s)){let d=typeof s=="number"?String(s):s;try{a=new URL(d,r),o=a.pathname,n=a.searchParams}catch{}}let i=(0,C.getRequestPath)(e.path,t),l=`${o}${i.length>0&&!o.endsWith("/")?"/":""}${i}`,u=new URLSearchParams([...n,...(0,C.getRequestQueryParams)(e.queryParams,t)]),c=[...u.entries()].length>0?`?${u.toString()}`:"";if(a){let d=new URL(a.origin,r);return d.pathname=l,d.search=u.toString(),d}else return new URL(`${l}${c}`,r)};C.getUrl=Wc;var zc=[be.ApiMethod.POST,be.ApiMethod.DELETE,be.ApiMethod.PUT,be.ApiMethod.PATCH,be.ApiMethod.OPTIONS],Gc=(e,t,r)=>{if(e.timeout){let o=(0,ae.applyFormula)(e.timeout.formula,r);typeof o=="number"&&!Number.isNaN(o)&&o>0&&(t.signal=AbortSignal.timeout(o))}};C.applyAbortSignal=Gc;var Jc=({api:e,formulaContext:t,defaultHeaders:r})=>{let o=Object.values(be.ApiMethod).includes(e.method)?e.method:be.ApiMethod.GET,n=(0,C.getRequestHeaders)({apiHeaders:e.headers,formulaContext:t,defaultHeaders:r}),a=rd({api:e,formulaContext:t,headers:n,method:o});n.get("content-type")==="multipart/form-data"&&n.delete("content-type");let s={method:o,headers:n,body:a};return(0,C.applyAbortSignal)(e,s,t),s},Xc=(e,t)=>(0,ma.sortObjectEntries)(e??{},([r,o])=>o.index).map(([r,o])=>(0,ae.applyFormula)(o.formula,t)).join("/");C.getRequestPath=Xc;var Qc=(e,t)=>{let r=new URLSearchParams;return Object.entries(e??{}).forEach(([o,n])=>{if(!((0,fe.isDefined)(n.enabled)?(0,ae.applyFormula)(n.enabled,t):!0))return;let s=(0,ae.applyFormula)(n.formula,t);if((0,fe.isDefined)(s))if(Array.isArray(s))s.forEach(i=>r.append(o,String(i)));else if((0,fe.isObject)(s)){let i=(l,u)=>{Object.entries(l).forEach(([c,d])=>{if(!Array.isArray(d)&&(0,fe.isObject)(d))return i(d,`${u}[${c}]`);r.set(`${u}[${c}]`,String(d))})};i(s,o)}else r.set(o,String(s))}),r};C.getRequestQueryParams=Qc;var Yc=({apiHeaders:e,formulaContext:t,defaultHeaders:r})=>{let o=new Headers(r);return Object.entries(e??{}).forEach(([n,a])=>{if((0,fe.isDefined)(a.enabled)?(0,ae.applyFormula)(a.enabled,t):!0){let i=(0,ae.applyFormula)(a.formula,t);if((0,fe.isDefined)(i))try{o.set(n.trim(),(typeof i=="string"?i:String(i)).trim())}catch{}}}),o};C.getRequestHeaders=Yc;var Zc=({origin:e,url:t})=>!(0,fe.isDefined)(t)||t===""||t.startsWith("/")?e+t:t;C.getBaseUrl=Zc;var ed=(e,t)=>(0,Uc.hash)(JSON.stringify({url:e.href,method:t.method,headers:(0,ma.omitKeys)(Object.fromEntries(Object.entries(t.headers??{})),["host","cookie"]),body:t.body??null}));C.requestHash=ed;var td=({apiName:e,response:t,formulaContext:r,errorFormula:o,performance:n})=>{let a=o?(0,ae.applyFormula)(o.formula,{component:r.component,package:r.package,toddle:r.toddle,data:{Attributes:{},Args:r.data.Args,Apis:{[e]:{isLoading:!1,data:t.body,error:null,response:{status:t.status,headers:t.headers,performance:n}}}},env:r.env}):null;return a==null?!t.ok:(0,fe.toBoolean)(a)};C.isApiError=td;var rd=({api:e,formulaContext:t,headers:r,method:o})=>{if(!e.body||!zc.includes(o))return;let n=(0,ae.applyFormula)(e.body,t);if(n)switch(r.get("content-type")){case"application/x-www-form-urlencoded":return typeof n=="object"&&n!==null?Object.entries(n).map(([a,s])=>Array.isArray(s)?s.map(i=>`${encodeURIComponent(a)}=${encodeURIComponent(i)}`).join("&"):`${encodeURIComponent(a)}=${encodeURIComponent(String(s))}`).join("&"):"";case"multipart/form-data":{let a=new FormData;return typeof n=="object"&&n!==null&&Object.entries(n).forEach(([s,i])=>{a.set(s,i)}),a}case"text/plain":return String(n);default:return JSON.stringify(n)}},od=(e,t)=>new CustomEvent(e,{detail:t});C.createApiEvent=od;var ha=(e,t)=>{let r=e.apiReferences.has(t.name),o=t.apiReferences.has(e.name);return r===o?0:r?1:-1},nd=e=>{let t=new Map,r=(o,n)=>{let a=t.get(n);return a||(a=o.version===2?new Bc.ToddleApiV2(o,n,{formulas:{},packages:{}}):new pa.LegacyToddleApi(o,n,{formulas:{},packages:{}}),t.set(n,a)),a};return[...e].sort(([o,n],[a,s])=>{let i=r(n,o),l=r(s,a);return ha(i,l)})};C.sortApiObjects=nd;var ad=e=>[...e].sort(([t,r],[o,n])=>ha(r,n));C.sortApiEntries=ad});var te=w(G=>{"use strict";Object.defineProperty(G,"__esModule",{value:!0});G.REWRITE_HEADER=G.PROXY_URL_HEADER=G.validateUrl=G.isLocalhostHostname=G.isLocalhostUrl=void 0;var sd=["http://localhost:54404","http://preview.localhost:54404"],id=e=>sd.some(t=>e.startsWith(t));G.isLocalhostUrl=id;var ld=e=>e==="localhost"||e==="127.0.0.1";G.isLocalhostHostname=ld;var ud=(e,t)=>{if(typeof e!="string")return!1;try{let r=new URL(e,t);return r.searchParams.forEach((o,n)=>{r.searchParams.set(n,o)}),r}catch{return!1}};G.validateUrl=ud;G.PROXY_URL_HEADER="x-toddle-url";G.REWRITE_HEADER="x-toddle-rewrite"});var ba=w(ht=>{"use strict";Object.defineProperty(ht,"__esModule",{value:!0});ht.parse=gd;ht.serialize=yd;var cd=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,dd=/^[\u0021-\u003A\u003C-\u007E]*$/,fd=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,md=/^[\u0020-\u003A\u003D-\u007E]*$/,pd=Object.prototype.toString,hd=(()=>{let e=function(){};return e.prototype=Object.create(null),e})();function gd(e,t){let r=new hd,o=e.length;if(o<2)return r;let n=t?.decode||bd,a=0;do{let s=e.indexOf("=",a);if(s===-1)break;let i=e.indexOf(";",a),l=i===-1?o:i;if(s>l){a=e.lastIndexOf(";",s-1)+1;continue}let u=ga(e,a,s),c=ya(e,s,u),d=e.slice(u,c);if(r[d]===void 0){let h=ga(e,s+1,l),p=ya(e,l,h),y=n(e.slice(h,p));r[d]=y}a=l+1}while(a<o);return r}function ga(e,t,r){do{let o=e.charCodeAt(t);if(o!==32&&o!==9)return t}while(++t<r);return r}function ya(e,t,r){for(;t>r;){let o=e.charCodeAt(--t);if(o!==32&&o!==9)return t+1}return r}function yd(e,t,r){let o=r?.encode||encodeURIComponent;if(!cd.test(e))throw new TypeError(`argument name is invalid: ${e}`);let n=o(t);if(!dd.test(n))throw new TypeError(`argument val is invalid: ${t}`);let a=e+"="+n;if(!r)return a;if(r.maxAge!==void 0){if(!Number.isInteger(r.maxAge))throw new TypeError(`option maxAge is invalid: ${r.maxAge}`);a+="; Max-Age="+r.maxAge}if(r.domain){if(!fd.test(r.domain))throw new TypeError(`option domain is invalid: ${r.domain}`);a+="; Domain="+r.domain}if(r.path){if(!md.test(r.path))throw new TypeError(`option path is invalid: ${r.path}`);a+="; Path="+r.path}if(r.expires){if(!vd(r.expires)||!Number.isFinite(r.expires.valueOf()))throw new TypeError(`option expires is invalid: ${r.expires}`);a+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(a+="; HttpOnly"),r.secure&&(a+="; Secure"),r.partitioned&&(a+="; Partitioned"),r.priority)switch(typeof r.priority=="string"?r.priority.toLowerCase():void 0){case"low":a+="; Priority=Low";break;case"medium":a+="; Priority=Medium";break;case"high":a+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${r.priority}`)}if(r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:case"strict":a+="; SameSite=Strict";break;case"lax":a+="; SameSite=Lax";break;case"none":a+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${r.sameSite}`)}return a}function bd(e){if(e.indexOf("%")===-1)return e;try{return decodeURIComponent(e)}catch{return e}}function vd(e){return pd.call(e)==="[object Date]"}});var vr=w(gt=>{"use strict";Object.defineProperty(gt,"__esModule",{value:!0});gt.getRequestCookies=void 0;var va=j(),Fd=ba(),Ad=e=>Object.fromEntries(Object.entries((0,Fd.parse)(e.headers.get("cookie")??"")).filter(t=>(0,va.isDefined)(t[0])&&(0,va.isDefined)(t[1])));gt.getRequestCookies=Ad});var Fr=w(yt=>{"use strict";Object.defineProperty(yt,"__esModule",{value:!0});yt.STRING_TEMPLATE=void 0;var wd=(e,t)=>`{{ ${Ed[e]}.${t} }}`;yt.STRING_TEMPLATE=wd;var Ed={cookies:"cookies"}});var Fa=w(Ce=>{"use strict";Object.defineProperty(Ce,"__esModule",{value:!0});Ce.skipToddleHeader=Ce.skipCookieHeader=void 0;var Od=te(),jd=e=>{let t=new Headers(e);return t.delete("cookie"),t};Ce.skipCookieHeader=jd;var xd=e=>{let t=new Headers(e);return t.delete(Od.PROXY_URL_HEADER),t};Ce.skipToddleHeader=xd});var wa=w(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.mapTemplateHeaders=re.sanitizeProxyHeaders=re.applyTemplateValues=void 0;var Cd=Fr(),Sd=j(),Aa=Fa(),_d=(e,t)=>{if(!(0,Sd.isDefined)(e))return"";let r=/{{ cookies\.(.+?) }}/gm,o=e,n=new Set,a;for(;(a=r.exec(e))!==null;)a.index===r.lastIndex&&r.lastIndex++,n.add(a[1]);for(let s of n){let i=t[s];i&&(o=o.replaceAll((0,Cd.STRING_TEMPLATE)("cookies",s),i))}return o};re.applyTemplateValues=_d;var kd=({cookies:e,headers:t})=>new Headers((0,re.mapTemplateHeaders)({cookies:e,headers:(0,Aa.skipCookieHeader)((0,Aa.skipToddleHeader)(t))}));re.sanitizeProxyHeaders=kd;var Rd=({cookies:e,headers:t})=>new Headers([...t.entries()].map(([r,o])=>[r,(0,re.applyTemplateValues)(o,e)]));re.mapTemplateHeaders=Rd});var Ar=w(vt=>{"use strict";Object.defineProperty(vt,"__esModule",{value:!0});vt.isPageComponent=void 0;var Td=j(),Pd=e=>(0,Td.isDefined)(e.route);vt.isPageComponent=Pd});var At=w(Ft=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});Ft.ToddleComponent=void 0;var xa=Me(),Hd=mr(),Dd=br(),R=ft(),Ca=j(),Se=hr(),Id=Ar(),wr=class e{component;globalFormulas;getComponent;packageName;constructor({component:t,getComponent:r,packageName:o,globalFormulas:n}){this.component=t,this.getComponent=r,this.packageName=o,this.globalFormulas=n}get uniqueSubComponents(){let t=new Map,r=o=>n=>{if(n.type!=="component"||t.has(n.name))return;let a=this.getComponent(n.name,n.package??o);a&&(t.set(a.name,new e({component:a,getComponent:this.getComponent,packageName:n.package??o,globalFormulas:this.globalFormulas})),Object.values(a.nodes).forEach(r(n.package??o)))};return Object.values(this.nodes).forEach(r()),[...t.values()]}get formulaReferences(){return new Set(Array.from(this.formulasInComponent()).filter(([,t])=>t.type==="function").map(([,t])=>t).map(t=>[t.package,t.name].filter(Ca.isDefined).join("/")))}get actionReferences(){return new Set(Array.from(this.actionModelsInComponent()).map(([,t])=>t.type==="Custom"||t.type===void 0?[t.package,t.name].filter(Ca.isDefined).join("/"):t.type))}*formulasInComponent(){let t=this.globalFormulas;function*r(o,n=[]){switch(o.type){case"text":yield*(0,R.getFormulasInFormula)({formula:o.condition,globalFormulas:t,path:[...n,"condition"]}),yield*(0,R.getFormulasInFormula)({formula:o.repeat,globalFormulas:t,path:[...n,"repeat"]}),yield*(0,R.getFormulasInFormula)({formula:o.repeatKey,globalFormulas:t,path:[...n,"repeatKey"]}),yield*(0,R.getFormulasInFormula)({formula:o.value,globalFormulas:t,path:[...n,"value"]});break;case"slot":yield*(0,R.getFormulasInFormula)({formula:o.condition,globalFormulas:t,path:[...n,"condition"]});break;case"component":yield*(0,R.getFormulasInFormula)({formula:o.condition,globalFormulas:t,path:[...n,"condition"]}),yield*(0,R.getFormulasInFormula)({formula:o.repeat,globalFormulas:t,path:[...n,"repeat"]}),yield*(0,R.getFormulasInFormula)({formula:o.repeatKey,globalFormulas:t,path:[...n,"repeatKey"]});for(let[a,s]of Object.entries(o.attrs??{}))yield*(0,R.getFormulasInFormula)({formula:s,globalFormulas:t,path:[...n,"attrs",a]});for(let[a,s]of Object.entries(o.events??{}))for(let[i,l]of Object.entries(s?.actions??{}))yield*(0,R.getFormulasInAction)({action:l,globalFormulas:t,path:[...n,"events",a,"actions",i]});break;case"element":yield*(0,R.getFormulasInFormula)({formula:o.condition,globalFormulas:t,path:[...n,"condition"]}),yield*(0,R.getFormulasInFormula)({formula:o.repeat,globalFormulas:t,path:[...n,"repeat"]}),yield*(0,R.getFormulasInFormula)({formula:o.repeatKey,globalFormulas:t,path:[...n,"repeatKey"]});for(let[a,s]of Object.entries(o.attrs??{}))yield*(0,R.getFormulasInFormula)({formula:s,globalFormulas:t,path:[...n,"attrs",a]});for(let[a,s]of Object.entries(o.events??{}))for(let[i,l]of Object.entries(s?.actions??{}))yield*(0,R.getFormulasInAction)({action:l,globalFormulas:t,path:[...n,"events",a,"actions",i]});for(let[a,s]of Object.entries(o.classes??{}))yield*(0,R.getFormulasInFormula)({formula:s.formula,globalFormulas:t,path:[...n,"classes",a,"formula"]});for(let[a,s]of Object.entries(o["style-variables"]??{}))yield*(0,R.getFormulasInFormula)({formula:s.formula,globalFormulas:t,path:[...n,"style-variables",a,"formula"]});break}}yield*(0,R.getFormulasInFormula)({formula:this.route?.info?.language?.formula,globalFormulas:t,path:["route","info","language","formula"]}),yield*(0,R.getFormulasInFormula)({formula:this.route?.info?.title?.formula,globalFormulas:t,path:["route","info","title","formula"]}),yield*(0,R.getFormulasInFormula)({formula:this.route?.info?.description?.formula,globalFormulas:t,path:["route","info","description","formula"]}),yield*(0,R.getFormulasInFormula)({formula:this.route?.info?.icon?.formula,globalFormulas:t,path:["route","info","icon","formula"]}),yield*(0,R.getFormulasInFormula)({formula:this.route?.info?.charset?.formula,globalFormulas:t,path:["route","info","charset","formula"]});for(let[o,n]of Object.entries(this.route?.info?.meta??{})){yield*(0,R.getFormulasInFormula)({formula:n.content,globalFormulas:t,path:["route","info","meta",o,"content"]});for(let[a,s]of Object.entries(n.attrs))yield*(0,R.getFormulasInFormula)({formula:s,globalFormulas:t,path:["route","info","meta",o,"attrs",a]})}for(let[o,n]of Object.entries(this.formulas??{}))yield*(0,R.getFormulasInFormula)({formula:n.formula,globalFormulas:t,path:["formulas",o,"formula"]});for(let[o,n]of Object.entries(this.variables??{}))yield*(0,R.getFormulasInFormula)({formula:n.initialValue,globalFormulas:t,path:["variables",o,"initialValue"]});for(let[o,n]of Object.entries(this.workflows??{}))for(let[a,s]of n.actions.entries())yield*(0,R.getFormulasInAction)({action:s,globalFormulas:t,path:["workflows",o,"actions",a]});for(let[,o]of Object.entries(this.apis))yield*o.formulasInApi();for(let[o,n]of Object.entries(this.component.onLoad?.actions??{}))yield*(0,R.getFormulasInAction)({action:n,globalFormulas:t,path:["onLoad","actions",o]});for(let[o,n]of Object.entries(this.component.onAttributeChange?.actions??{}))yield*(0,R.getFormulasInAction)({action:n,globalFormulas:t,path:["onAttributeChange","actions",o]});for(let[o,n]of Object.entries(this.nodes??{}))yield*r(n,["nodes",o])}*actionModelsInComponent(){function*t(r,o=[]){switch(r.type){case"text":case"slot":break;case"component":case"element":for(let[n,a]of Object.entries(r.events??{}))for(let[s,i]of Object.entries(a?.actions??{}))yield*(0,Se.getActionsInAction)(i,[...o,"events",n,"actions",s]);break}}for(let[r,o]of Object.entries(this.workflows??{}))for(let[n,a]of Object.entries(o?.actions??{}))yield*(0,Se.getActionsInAction)(a,["workflows",r,"actions",n]);for(let[r,o]of Object.entries(this.apis??{})){if(!(0,xa.isLegacyApi)(o)){yield*o.actionModelsInApi();continue}for(let[n,a]of Object.entries(o.onCompleted?.actions??{}))yield*(0,Se.getActionsInAction)(a,["apis",r,"onCompleted","actions",n]);for(let[n,a]of Object.entries(o.onFailed?.actions??{}))yield*(0,Se.getActionsInAction)(a,["apis",r,"onFailed","actions",n])}for(let[r,o]of Object.entries(this.component.onLoad?.actions??{}))yield*(0,Se.getActionsInAction)(o,["onLoad","actions",r]);for(let[r,o]of Object.entries(this.component.onAttributeChange?.actions??{}))yield*(0,Se.getActionsInAction)(o,["onAttributeChange","actions",r]);for(let[r,o]of Object.entries(this.nodes??{}))yield*t(o,["nodes",r])}get formulas(){return this.component.formulas}get name(){return this.component.name}get route(){return this.component.route}get attributes(){return this.component.attributes}get variables(){return this.component.variables}get workflows(){return this.component.workflows}get apis(){return Object.fromEntries(Object.entries(this.component.apis??{}).map(([t,r])=>[t,(0,xa.isLegacyApi)(r)?new Hd.LegacyToddleApi(r,t,this.globalFormulas):new Dd.ToddleApiV2(r,t,this.globalFormulas)]))}get nodes(){return this.component.nodes}get events(){return this.component.events}get onLoad(){return this.component.onLoad}get onAttributeChange(){return this.component.onAttributeChange}get isPage(){return(0,Id.isPageComponent)(this.component)}};Ft.ToddleComponent=wr});var Or=w(_e=>{function Ta(){var e={};return e["align-content"]=!1,e["align-items"]=!1,e["align-self"]=!1,e["alignment-adjust"]=!1,e["alignment-baseline"]=!1,e.all=!1,e["anchor-point"]=!1,e.animation=!1,e["animation-delay"]=!1,e["animation-direction"]=!1,e["animation-duration"]=!1,e["animation-fill-mode"]=!1,e["animation-iteration-count"]=!1,e["animation-name"]=!1,e["animation-play-state"]=!1,e["animation-timing-function"]=!1,e.azimuth=!1,e["backface-visibility"]=!1,e.background=!0,e["background-attachment"]=!0,e["background-clip"]=!0,e["background-color"]=!0,e["background-image"]=!0,e["background-origin"]=!0,e["background-position"]=!0,e["background-repeat"]=!0,e["background-size"]=!0,e["baseline-shift"]=!1,e.binding=!1,e.bleed=!1,e["bookmark-label"]=!1,e["bookmark-level"]=!1,e["bookmark-state"]=!1,e.border=!0,e["border-bottom"]=!0,e["border-bottom-color"]=!0,e["border-bottom-left-radius"]=!0,e["border-bottom-right-radius"]=!0,e["border-bottom-style"]=!0,e["border-bottom-width"]=!0,e["border-collapse"]=!0,e["border-color"]=!0,e["border-image"]=!0,e["border-image-outset"]=!0,e["border-image-repeat"]=!0,e["border-image-slice"]=!0,e["border-image-source"]=!0,e["border-image-width"]=!0,e["border-left"]=!0,e["border-left-color"]=!0,e["border-left-style"]=!0,e["border-left-width"]=!0,e["border-radius"]=!0,e["border-right"]=!0,e["border-right-color"]=!0,e["border-right-style"]=!0,e["border-right-width"]=!0,e["border-spacing"]=!0,e["border-style"]=!0,e["border-top"]=!0,e["border-top-color"]=!0,e["border-top-left-radius"]=!0,e["border-top-right-radius"]=!0,e["border-top-style"]=!0,e["border-top-width"]=!0,e["border-width"]=!0,e.bottom=!1,e["box-decoration-break"]=!0,e["box-shadow"]=!0,e["box-sizing"]=!0,e["box-snap"]=!0,e["box-suppress"]=!0,e["break-after"]=!0,e["break-before"]=!0,e["break-inside"]=!0,e["caption-side"]=!1,e.chains=!1,e.clear=!0,e.clip=!1,e["clip-path"]=!1,e["clip-rule"]=!1,e.color=!0,e["color-interpolation-filters"]=!0,e["column-count"]=!1,e["column-fill"]=!1,e["column-gap"]=!1,e["column-rule"]=!1,e["column-rule-color"]=!1,e["column-rule-style"]=!1,e["column-rule-width"]=!1,e["column-span"]=!1,e["column-width"]=!1,e.columns=!1,e.contain=!1,e.content=!1,e["counter-increment"]=!1,e["counter-reset"]=!1,e["counter-set"]=!1,e.crop=!1,e.cue=!1,e["cue-after"]=!1,e["cue-before"]=!1,e.cursor=!1,e.direction=!1,e.display=!0,e["display-inside"]=!0,e["display-list"]=!0,e["display-outside"]=!0,e["dominant-baseline"]=!1,e.elevation=!1,e["empty-cells"]=!1,e.filter=!1,e.flex=!1,e["flex-basis"]=!1,e["flex-direction"]=!1,e["flex-flow"]=!1,e["flex-grow"]=!1,e["flex-shrink"]=!1,e["flex-wrap"]=!1,e.float=!1,e["float-offset"]=!1,e["flood-color"]=!1,e["flood-opacity"]=!1,e["flow-from"]=!1,e["flow-into"]=!1,e.font=!0,e["font-family"]=!0,e["font-feature-settings"]=!0,e["font-kerning"]=!0,e["font-language-override"]=!0,e["font-size"]=!0,e["font-size-adjust"]=!0,e["font-stretch"]=!0,e["font-style"]=!0,e["font-synthesis"]=!0,e["font-variant"]=!0,e["font-variant-alternates"]=!0,e["font-variant-caps"]=!0,e["font-variant-east-asian"]=!0,e["font-variant-ligatures"]=!0,e["font-variant-numeric"]=!0,e["font-variant-position"]=!0,e["font-weight"]=!0,e.grid=!1,e["grid-area"]=!1,e["grid-auto-columns"]=!1,e["grid-auto-flow"]=!1,e["grid-auto-rows"]=!1,e["grid-column"]=!1,e["grid-column-end"]=!1,e["grid-column-start"]=!1,e["grid-row"]=!1,e["grid-row-end"]=!1,e["grid-row-start"]=!1,e["grid-template"]=!1,e["grid-template-areas"]=!1,e["grid-template-columns"]=!1,e["grid-template-rows"]=!1,e["hanging-punctuation"]=!1,e.height=!0,e.hyphens=!1,e.icon=!1,e["image-orientation"]=!1,e["image-resolution"]=!1,e["ime-mode"]=!1,e["initial-letters"]=!1,e["inline-box-align"]=!1,e["justify-content"]=!1,e["justify-items"]=!1,e["justify-self"]=!1,e.left=!1,e["letter-spacing"]=!0,e["lighting-color"]=!0,e["line-box-contain"]=!1,e["line-break"]=!1,e["line-grid"]=!1,e["line-height"]=!1,e["line-snap"]=!1,e["line-stacking"]=!1,e["line-stacking-ruby"]=!1,e["line-stacking-shift"]=!1,e["line-stacking-strategy"]=!1,e["list-style"]=!0,e["list-style-image"]=!0,e["list-style-position"]=!0,e["list-style-type"]=!0,e.margin=!0,e["margin-bottom"]=!0,e["margin-left"]=!0,e["margin-right"]=!0,e["margin-top"]=!0,e["marker-offset"]=!1,e["marker-side"]=!1,e.marks=!1,e.mask=!1,e["mask-box"]=!1,e["mask-box-outset"]=!1,e["mask-box-repeat"]=!1,e["mask-box-slice"]=!1,e["mask-box-source"]=!1,e["mask-box-width"]=!1,e["mask-clip"]=!1,e["mask-image"]=!1,e["mask-origin"]=!1,e["mask-position"]=!1,e["mask-repeat"]=!1,e["mask-size"]=!1,e["mask-source-type"]=!1,e["mask-type"]=!1,e["max-height"]=!0,e["max-lines"]=!1,e["max-width"]=!0,e["min-height"]=!0,e["min-width"]=!0,e["move-to"]=!1,e["nav-down"]=!1,e["nav-index"]=!1,e["nav-left"]=!1,e["nav-right"]=!1,e["nav-up"]=!1,e["object-fit"]=!1,e["object-position"]=!1,e.opacity=!1,e.order=!1,e.orphans=!1,e.outline=!1,e["outline-color"]=!1,e["outline-offset"]=!1,e["outline-style"]=!1,e["outline-width"]=!1,e.overflow=!1,e["overflow-wrap"]=!1,e["overflow-x"]=!1,e["overflow-y"]=!1,e.padding=!0,e["padding-bottom"]=!0,e["padding-left"]=!0,e["padding-right"]=!0,e["padding-top"]=!0,e.page=!1,e["page-break-after"]=!1,e["page-break-before"]=!1,e["page-break-inside"]=!1,e["page-policy"]=!1,e.pause=!1,e["pause-after"]=!1,e["pause-before"]=!1,e.perspective=!1,e["perspective-origin"]=!1,e.pitch=!1,e["pitch-range"]=!1,e["play-during"]=!1,e.position=!1,e["presentation-level"]=!1,e.quotes=!1,e["region-fragment"]=!1,e.resize=!1,e.rest=!1,e["rest-after"]=!1,e["rest-before"]=!1,e.richness=!1,e.right=!1,e.rotation=!1,e["rotation-point"]=!1,e["ruby-align"]=!1,e["ruby-merge"]=!1,e["ruby-position"]=!1,e["shape-image-threshold"]=!1,e["shape-outside"]=!1,e["shape-margin"]=!1,e.size=!1,e.speak=!1,e["speak-as"]=!1,e["speak-header"]=!1,e["speak-numeral"]=!1,e["speak-punctuation"]=!1,e["speech-rate"]=!1,e.stress=!1,e["string-set"]=!1,e["tab-size"]=!1,e["table-layout"]=!1,e["text-align"]=!0,e["text-align-last"]=!0,e["text-combine-upright"]=!0,e["text-decoration"]=!0,e["text-decoration-color"]=!0,e["text-decoration-line"]=!0,e["text-decoration-skip"]=!0,e["text-decoration-style"]=!0,e["text-emphasis"]=!0,e["text-emphasis-color"]=!0,e["text-emphasis-position"]=!0,e["text-emphasis-style"]=!0,e["text-height"]=!0,e["text-indent"]=!0,e["text-justify"]=!0,e["text-orientation"]=!0,e["text-overflow"]=!0,e["text-shadow"]=!0,e["text-space-collapse"]=!0,e["text-transform"]=!0,e["text-underline-position"]=!0,e["text-wrap"]=!0,e.top=!1,e.transform=!1,e["transform-origin"]=!1,e["transform-style"]=!1,e.transition=!1,e["transition-delay"]=!1,e["transition-duration"]=!1,e["transition-property"]=!1,e["transition-timing-function"]=!1,e["unicode-bidi"]=!1,e["vertical-align"]=!1,e.visibility=!1,e["voice-balance"]=!1,e["voice-duration"]=!1,e["voice-family"]=!1,e["voice-pitch"]=!1,e["voice-range"]=!1,e["voice-rate"]=!1,e["voice-stress"]=!1,e["voice-volume"]=!1,e.volume=!1,e["white-space"]=!1,e.widows=!1,e.width=!0,e["will-change"]=!1,e["word-break"]=!0,e["word-spacing"]=!0,e["word-wrap"]=!0,e["wrap-flow"]=!1,e["wrap-through"]=!1,e["writing-mode"]=!1,e["z-index"]=!1,e}function $d(e,t,r){}function Nd(e,t,r){}var Ld=/javascript\s*\:/img;function qd(e,t){return Ld.test(t)?"":t}_e.whiteList=Ta();_e.getDefaultWhiteList=Ta;_e.onAttr=$d;_e.onIgnoreAttr=Nd;_e.safeAttrValue=qd});var jr=w((pb,Pa)=>{Pa.exports={indexOf:function(e,t){var r,o;if(Array.prototype.indexOf)return e.indexOf(t);for(r=0,o=e.length;r<o;r++)if(e[r]===t)return r;return-1},forEach:function(e,t,r){var o,n;if(Array.prototype.forEach)return e.forEach(t,r);for(o=0,n=e.length;o<n;o++)t.call(r,e[o],o,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(e){return String.prototype.trimRight?e.trimRight():e.replace(/(\s*$)/g,"")}}});var Da=w((hb,Ha)=>{var Ke=jr();function Md(e,t){e=Ke.trimRight(e),e[e.length-1]!==";"&&(e+=";");var r=e.length,o=!1,n=0,a=0,s="";function i(){if(!o){var c=Ke.trim(e.slice(n,a)),d=c.indexOf(":");if(d!==-1){var h=Ke.trim(c.slice(0,d)),p=Ke.trim(c.slice(d+1));if(h){var y=t(n,s.length,h,p,c);y&&(s+=y+"; ")}}}n=a+1}for(;a<r;a++){var l=e[a];if(l==="/"&&e[a+1]==="*"){var u=e.indexOf("*/",a+2);if(u===-1)break;a=u+1,n=a+1,o=!1}else l==="("?o=!0:l===")"?o=!1:l===";"?o||i():l===`
`&&i()}return Ke.trim(s)}Ha.exports=Md});var La=w((yb,Na)=>{var wt=Or(),Ud=Da(),gb=jr();function Ia(e){return e==null}function Bd(e){var t={};for(var r in e)t[r]=e[r];return t}function $a(e){e=Bd(e||{}),e.whiteList=e.whiteList||wt.whiteList,e.onAttr=e.onAttr||wt.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||wt.onIgnoreAttr,e.safeAttrValue=e.safeAttrValue||wt.safeAttrValue,this.options=e}$a.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,r=t.options,o=r.whiteList,n=r.onAttr,a=r.onIgnoreAttr,s=r.safeAttrValue,i=Ud(e,function(l,u,c,d,h){var p=o[c],y=!1;if(p===!0?y=p:typeof p=="function"?y=p(d):p instanceof RegExp&&(y=p.test(d)),y!==!0&&(y=!1),d=s(c,d),!!d){var b={position:u,sourcePosition:l,source:h,isWhite:y};if(y){var g=n(c,d,b);return Ia(g)?c+":"+d:g}else{var g=a(c,d,b);if(!Ia(g))return g}}});return i};Na.exports=$a});var Ot=w((Et,Cr)=>{var qa=Or(),Ma=La();function Vd(e,t){var r=new Ma(t);return r.process(e)}Et=Cr.exports=Vd;Et.FilterCSS=Ma;for(xr in qa)Et[xr]=qa[xr];var xr;typeof window<"u"&&(window.filterCSS=Cr.exports)});var jt=w((bb,Ua)=>{Ua.exports={indexOf:function(e,t){var r,o;if(Array.prototype.indexOf)return e.indexOf(t);for(r=0,o=e.length;r<o;r++)if(e[r]===t)return r;return-1},forEach:function(e,t,r){var o,n;if(Array.prototype.forEach)return e.forEach(t,r);for(o=0,n=e.length;o<n;o++)t.call(r,e[o],o,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(e){var t=/\s|\n|\t/,r=t.exec(e);return r?r.index:-1}}});var Sr=w(P=>{var Kd=Ot().FilterCSS,Wd=Ot().getDefaultWhiteList,Ct=jt();function Ka(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height","loading"],ins:["datetime"],kbd:[],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var Wa=new Kd;function zd(e,t,r){}function Gd(e,t,r){}function Jd(e,t,r){}function Xd(e,t,r){}function za(e){return e.replace(Yd,"&lt;").replace(Zd,"&gt;")}function Qd(e,t,r,o){if(r=Za(r),t==="href"||t==="src"){if(r=Ct.trim(r),r==="#")return"#";if(!(r.substr(0,7)==="http://"||r.substr(0,8)==="https://"||r.substr(0,7)==="mailto:"||r.substr(0,4)==="tel:"||r.substr(0,11)==="data:image/"||r.substr(0,6)==="ftp://"||r.substr(0,2)==="./"||r.substr(0,3)==="../"||r[0]==="#"||r[0]==="/"))return""}else if(t==="background"){if(xt.lastIndex=0,xt.test(r))return""}else if(t==="style"){if(Ba.lastIndex=0,Ba.test(r)||(Va.lastIndex=0,Va.test(r)&&(xt.lastIndex=0,xt.test(r))))return"";o!==!1&&(o=o||Wa,r=o.process(r))}return r=es(r),r}var Yd=/</g,Zd=/>/g,ef=/"/g,tf=/&quot;/g,rf=/&#([a-zA-Z0-9]*);?/gim,of=/&colon;?/gim,nf=/&newline;?/gim,xt=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,Ba=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,Va=/u\s*r\s*l\s*\(.*/gi;function Ga(e){return e.replace(ef,"&quot;")}function Ja(e){return e.replace(tf,'"')}function Xa(e){return e.replace(rf,function(r,o){return o[0]==="x"||o[0]==="X"?String.fromCharCode(parseInt(o.substr(1),16)):String.fromCharCode(parseInt(o,10))})}function Qa(e){return e.replace(of,":").replace(nf," ")}function Ya(e){for(var t="",r=0,o=e.length;r<o;r++)t+=e.charCodeAt(r)<32?" ":e.charAt(r);return Ct.trim(t)}function Za(e){return e=Ja(e),e=Xa(e),e=Qa(e),e=Ya(e),e}function es(e){return e=Ga(e),e=za(e),e}function af(){return""}function sf(e,t){typeof t!="function"&&(t=function(){});var r=!Array.isArray(e);function o(s){return r?!0:Ct.indexOf(e,s)!==-1}var n=[],a=!1;return{onIgnoreTag:function(s,i,l){if(o(s))if(l.isClosing){var u="[/removed]",c=l.position+u.length;return n.push([a!==!1?a:l.position,c]),a=!1,u}else return a||(a=l.position),"[removed]";else return t(s,i,l)},remove:function(s){var i="",l=0;return Ct.forEach(n,function(u){i+=s.slice(l,u[0]),l=u[1]}),i+=s.slice(l),i}}}function lf(e){for(var t="",r=0;r<e.length;){var o=e.indexOf("<!--",r);if(o===-1){t+=e.slice(r);break}t+=e.slice(r,o);var n=e.indexOf("-->",o);if(n===-1)break;r=n+3}return t}function uf(e){var t=e.split("");return t=t.filter(function(r){var o=r.charCodeAt(0);return o===127?!1:o<=31?o===10||o===13:!0}),t.join("")}P.whiteList=Ka();P.getDefaultWhiteList=Ka;P.onTag=zd;P.onIgnoreTag=Gd;P.onTagAttr=Jd;P.onIgnoreTagAttr=Xd;P.safeAttrValue=Qd;P.escapeHtml=za;P.escapeQuote=Ga;P.unescapeQuote=Ja;P.escapeHtmlEntities=Xa;P.escapeDangerHtml5Entities=Qa;P.clearNonPrintableCharacter=Ya;P.friendlyAttrValue=Za;P.escapeAttrValue=es;P.onIgnoreTagStripAll=af;P.StripTagBody=sf;P.stripCommentTag=lf;P.stripBlankChar=uf;P.attributeWrapSign='"';P.cssFilter=Wa;P.getDefaultCSSWhiteList=Wd});var kr=w(_r=>{var me=jt();function cf(e){var t=me.spaceIndex(e),r;return t===-1?r=e.slice(1,-1):r=e.slice(1,t+1),r=me.trim(r).toLowerCase(),r.slice(0,1)==="/"&&(r=r.slice(1)),r.slice(-1)==="/"&&(r=r.slice(0,-1)),r}function df(e){return e.slice(0,2)==="</"}function ff(e,t,r){"use strict";var o="",n=0,a=!1,s=!1,i=0,l=e.length,u="",c="";e:for(i=0;i<l;i++){var d=e.charAt(i);if(a===!1){if(d==="<"){a=i;continue}}else if(s===!1){if(d==="<"){o+=r(e.slice(n,i)),a=i,n=i;continue}if(d===">"||i===l-1){o+=r(e.slice(n,a)),c=e.slice(a,i+1),u=cf(c),o+=t(a,o.length,u,c,df(c)),n=i+1,a=!1;continue}if(d==='"'||d==="'")for(var h=1,p=e.charAt(i-h);p.trim()===""||p==="=";){if(p==="="){s=d;continue e}p=e.charAt(i-++h)}}else if(d===s){s=!1;continue}}return n<l&&(o+=r(e.substr(n))),o}var mf=/[^a-zA-Z0-9\\_:.-]/gim;function pf(e,t){"use strict";var r=0,o=0,n=[],a=!1,s=e.length;function i(h,p){if(h=me.trim(h),h=h.replace(mf,"").toLowerCase(),!(h.length<1)){var y=t(h,p||"");y&&n.push(y)}}for(var l=0;l<s;l++){var u=e.charAt(l),c,d;if(a===!1&&u==="="){a=e.slice(r,l),r=l+1,o=e.charAt(r)==='"'||e.charAt(r)==="'"?r:gf(e,l+1);continue}if(a!==!1&&l===o){if(d=e.indexOf(u,l+1),d===-1)break;c=me.trim(e.slice(o+1,d)),i(a,c),a=!1,l=d,r=l+1;continue}if(/\s|\n|\t/.test(u))if(e=e.replace(/\s|\n|\t/g," "),a===!1)if(d=hf(e,l),d===-1){c=me.trim(e.slice(r,l)),i(c),a=!1,r=l+1;continue}else{l=d-1;continue}else if(d=yf(e,l-1),d===-1){c=me.trim(e.slice(r,l)),c=ts(c),i(a,c),a=!1,r=l+1;continue}else continue}return r<e.length&&(a===!1?i(e.slice(r)):i(a,ts(me.trim(e.slice(r))))),me.trim(n.join(" "))}function hf(e,t){for(;t<e.length;t++){var r=e[t];if(r!==" ")return r==="="?t:-1}}function gf(e,t){for(;t<e.length;t++){var r=e[t];if(r!==" ")return r==="'"||r==='"'?t:-1}}function yf(e,t){for(;t>0;t--){var r=e[t];if(r!==" ")return r==="="?t:-1}}function bf(e){return e[0]==='"'&&e[e.length-1]==='"'||e[0]==="'"&&e[e.length-1]==="'"}function ts(e){return bf(e)?e.substr(1,e.length-2):e}_r.parseTag=ff;_r.parseAttr=pf});var as=w((Ab,ns)=>{var vf=Ot().FilterCSS,J=Sr(),rs=kr(),Ff=rs.parseTag,Af=rs.parseAttr,_t=jt();function St(e){return e==null}function wf(e){var t=_t.spaceIndex(e);if(t===-1)return{html:"",closing:e[e.length-2]==="/"};e=_t.trim(e.slice(t+1,-1));var r=e[e.length-1]==="/";return r&&(e=_t.trim(e.slice(0,-1))),{html:e,closing:r}}function Ef(e){var t={};for(var r in e)t[r]=e[r];return t}function Of(e){var t={};for(var r in e)Array.isArray(e[r])?t[r.toLowerCase()]=e[r].map(function(o){return o.toLowerCase()}):t[r.toLowerCase()]=e[r];return t}function os(e){e=Ef(e||{}),e.stripIgnoreTag&&(e.onIgnoreTag,e.onIgnoreTag=J.onIgnoreTagStripAll),e.whiteList||e.allowList?e.whiteList=Of(e.whiteList||e.allowList):e.whiteList=J.whiteList,this.attributeWrapSign=e.singleQuotedAttributeValue===!0?"'":J.attributeWrapSign,e.onTag=e.onTag||J.onTag,e.onTagAttr=e.onTagAttr||J.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||J.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||J.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||J.safeAttrValue,e.escapeHtml=e.escapeHtml||J.escapeHtml,this.options=e,e.css===!1?this.cssFilter=!1:(e.css=e.css||{},this.cssFilter=new vf(e.css))}os.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,r=t.options,o=r.whiteList,n=r.onTag,a=r.onIgnoreTag,s=r.onTagAttr,i=r.onIgnoreTagAttr,l=r.safeAttrValue,u=r.escapeHtml,c=t.attributeWrapSign,d=t.cssFilter;r.stripBlankChar&&(e=J.stripBlankChar(e)),r.allowCommentTag||(e=J.stripCommentTag(e));var h=!1;r.stripIgnoreTagBody&&(h=J.StripTagBody(r.stripIgnoreTagBody,a),a=h.onIgnoreTag);var p=Ff(e,function(y,b,g,A,O){var E={sourcePosition:y,position:b,isClosing:O,isWhite:Object.prototype.hasOwnProperty.call(o,g)},F=n(g,A,E);if(!St(F))return F;if(E.isWhite){if(E.isClosing)return"</"+g+">";var S=wf(A),D=o[g],_=Af(S.html,function(T,k){var oe=_t.indexOf(D,T)!==-1,$=s(g,T,k,oe);return St($)?oe?(k=l(g,T,k,d),k?T+"="+c+k+c:T):($=i(g,T,k,oe),St($)?void 0:$):$});return A="<"+g,_&&(A+=" "+_),S.closing&&(A+=" /"),A+=">",A}else return F=a(g,A,E),St(F)?u(A):F},u);return h&&(p=h.remove(p)),p};ns.exports=os});var Rt=w((ke,kt)=>{var ss=Sr(),is=kr(),ls=as();function us(e,t){var r=new ls(t);return r.process(e)}ke=kt.exports=us;ke.filterXSS=us;ke.FilterXSS=ls;(function(){for(var e in ss)ke[e]=ss[e];for(var t in is)ke[t]=is[t]})();typeof window<"u"&&(window.filterXSS=kt.exports);function jf(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}jf()&&(self.filterXSS=kt.exports)});var fs=w(Pt=>{"use strict";Object.defineProperty(Pt,"__esModule",{value:!0});Pt.safeCustomElementName=void 0;var Cf=e=>{let t=e.toLocaleLowerCase().replaceAll(" ","");return t.includes("-")?t:`toddle-${t}`};Pt.safeCustomElementName=Cf});var Pr=w(Tr=>{"use strict";Object.defineProperty(Tr,"__esModule",{value:!0});Tr.takeIncludedComponents=Sf;var ms=j();function Sf({root:e,projectComponents:t,packages:r={},includeRoot:o=!0}){let n={...t,...Object.fromEntries(Object.values(r).flatMap(s=>Object.values(s.components).map(i=>[`${s.manifest.name}/${i.name}`,i])))},a=[];return o&&a.push(e),a.push(..._f(e,n)),a}function _f(e,t){let r=new Map,o=(n,a)=>{if(n.type!=="component")return;let s=[n.package??a,n.name].filter(ms.isDefined).join("/");if(r.has(s))return;let i=t[s];(0,ms.isDefined)(i)&&(Object.hasOwn(t,s)&&r.set(s,{...i,name:s}),Object.values(i.nodes).forEach(l=>o(l,(l.type==="component"?l.package:void 0)??a)))};return Object.values(e.nodes).forEach(n=>o(n,n.type==="component"?n.package:void 0)),Array.from(r.values())}});var ps=w(Hr=>{"use strict";Object.defineProperty(Hr,"__esModule",{value:!0});Hr.removeTestData=kf;var We=Y();function kf(e){return{...e,attributes:(0,We.mapObject)(e.attributes,([t,r])=>[t,(0,We.omit)(r,["testValue"])]),...e.route?{route:{...e.route,path:e.route.path.map(t=>(0,We.omit)(t,["testValue"])),query:(0,We.mapObject)(e.route.query,([t,r])=>[t,(0,We.omit)(r,["testValue"])])}}:{}}}});var hs=w(Ht=>{"use strict";Object.defineProperty(Ht,"__esModule",{value:!0});Ht.replaceTagInNodes=void 0;var Rf=(e,t)=>r=>({...r,nodes:Object.entries(r.nodes).reduce((o,[n,a])=>a.type!=="element"?{...o,[n]:a}:{...o,[n]:{...a,tag:a.tag===e?t:a.tag}},{})});Ht.replaceTagInNodes=Rf});var It=w(Re=>{"use strict";Object.defineProperty(Re,"__esModule",{value:!0});Re.theme=Re.RESET_STYLES=void 0;Re.RESET_STYLES=`
@layer reset {
  html {
    height:100%;
  }

  #App {
    height:100%;
    display:flex;
    flex-direction:column;
  }

  body {
    height:100%;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    margin:0;
  }

  [data-node-id]:not([data-unset-toddle-styles],[data-node-type="text"],noscript,br,script,style,link,template,meta,title,base), [data-node-id]:not([data-unset-toddle-styles],noscript)::before, [data-node-id]:not([data-unset-toddle-styles],noscript)::after {
    display: flex;
    flex-direction: column;
    flex-grow: 0;
    flex-shrink: 0;

    position: relative;
    box-sizing: border-box;
    padding: 0;
    margin: 0;

    font-size: var(--text-base);
    font-family: var(--font-sans);
    font-weight: var(--font-weight-normal);

    background: transparent;
    color: inherit;
    border: none;
    box-shadow: none;
  }

  [data-node-id]:not([data-unset-toddle-styles]):is(p, h1, h2, h3, h4, h5, h6, label, span, strong, b, i, address, caption, code, cite, dt, dd, em, figcaption, legend, blockquote, abbr, pre, bdo, bdi) {
    display: inline-block;
    overflow-wrap: break-word;
    color: inherit;
  }

  [data-node-id]:not([data-unset-toddle-styles]):is(input, button, textarea, select) {
    outline: none;
  }

  [data-node-id]:not([data-unset-toddle-styles]):is(a) {
    color: inherit;
    text-decoration: none;
  }

  [data-node-id]:not([data-unset-toddle-styles]):is(ul, ol, li) {
    list-style: none;
  }

  [data-node-id]:not([data-unset-toddle-styles]):is(span[data-node-type="text"]) {
    font: inherit;
    display: inline;
    flex-direction: column;
    flex-grow: 0;
    flex-shrink: 0;
    box-sizing: border-box;
  }

  [popover]:not(:popover-open):not(dialog[open]) {
    display: revert;
  }
}`;Re.theme={colors:{grey:{order:0,variants:{50:{order:0,value:"#FAFAFA"},100:{order:1,value:"#F5F5F5"},200:{order:2,value:"#E5E5E5"},300:{order:3,value:"#D4D4D4"},400:{order:4,value:"#A3A3A3"},500:{order:5,value:"#737373"},600:{order:6,value:"#525252"},700:{order:7,value:"#404040"},800:{order:8,value:"#262626"},900:{order:9,value:"#171717"}}},red:{order:1,variants:{50:{order:0,value:"#FEF2F2"},100:{order:1,value:"#FEE2E2"},200:{order:2,value:"#FECACA"},300:{order:3,value:"#FCA5A5"},400:{order:4,value:"#F87171"},500:{order:5,value:"#EF4444"},600:{order:6,value:"#DC2626"},700:{order:7,value:"#B91C1C"},800:{order:8,value:"#991B1B"},900:{order:9,value:"#7F1D1D"}}},rose:{order:3,variants:{50:{order:0,value:"#FFF1F2"},100:{order:1,value:"#FFE4E6"},200:{order:2,value:"#FECDD3"},300:{order:3,value:"#FDA4AF"},400:{order:4,value:"#FB7185"},500:{order:5,value:"#F43F5E"},600:{order:6,value:"#E11D48"},700:{order:7,value:"#BE123C"},800:{order:8,value:"#9F1239"},900:{order:9,value:"#881337"}}},pink:{order:4,variants:{50:{order:0,value:"#FDF2F8"},100:{order:1,value:"#FCE7F3"},200:{order:2,value:"#FBCFE8"},300:{order:3,value:"#F9A8D4"},400:{order:4,value:"#F472B6"},500:{order:5,value:"#EC4899"},600:{order:6,value:"#DB2777"},700:{order:7,value:"#BE185D"},800:{order:8,value:"#9D174D"},900:{order:9,value:"#831843"}}},amber:{order:5,variants:{50:{order:0,value:"#FFFBEB"},100:{order:1,value:"#FEF3C7"},200:{order:2,value:"#FDE68A"},300:{order:3,value:"#FCD34D"},400:{order:4,value:"#FBBF24"},500:{order:5,value:"#F59E0B"},600:{order:6,value:"#D97706"},700:{order:7,value:"#B45309"},800:{order:8,value:"#92400E"},900:{order:9,value:"#78350F"}}},orange:{order:6,variants:{50:{order:0,value:"#FFF7ED"},100:{order:1,value:"#FFEDD5"},200:{order:2,value:"#FED7AA"},300:{order:3,value:"#FDBA74"},400:{order:4,value:"#FB923C"},500:{order:5,value:"#F97316"},600:{order:6,value:"#EA580C"},700:{order:7,value:"#C2410C"},800:{order:8,value:"#9A3412"},900:{order:9,value:"#7C2D12"}}},yellow:{order:7,variants:{50:{order:0,value:"#FFFBEB"},100:{order:1,value:"#FEF3C7"},200:{order:2,value:"#FDE68A"},300:{order:3,value:"#FCD34D"},400:{order:4,value:"#FBBF24"},500:{order:5,value:"#F59E0B"},600:{order:6,value:"#D97706"},700:{order:7,value:"#B45309"},800:{order:8,value:"#92400E"},900:{order:9,value:"#78350F"}}},lime:{order:8,variants:{50:{order:0,value:"#F7FEE7"},100:{order:1,value:"#ECFCCB"},200:{order:2,value:"#D9F99D"},300:{order:3,value:"#BEF264"},400:{order:4,value:"#A3E635"},500:{order:5,value:"#84CC16"},600:{order:6,value:"#65A30D"},700:{order:7,value:"#4D7C0F"},800:{order:8,value:"#3F6212"},900:{order:9,value:"#365314"}}},green:{order:9,variants:{50:{order:0,value:"#ECFDF5"},100:{order:1,value:"#D1FAE5"},200:{order:2,value:"#A7F3D0"},300:{order:3,value:"#6EE7B7"},400:{order:4,value:"#34D399"},500:{order:5,value:"#10B981"},600:{order:6,value:"#059669"},700:{order:7,value:"#047857"},800:{order:8,value:"#065F46"},900:{order:9,value:"#064E3B"}}},emerald:{order:10,variants:{50:{order:0,value:"#ECFDF5"},100:{order:1,value:"#D1FAE5"},200:{order:2,value:"#A7F3D0"},300:{order:3,value:"#6EE7B7"},400:{order:4,value:"#34D399"},500:{order:5,value:"#10B981"},600:{order:6,value:"#059669"},700:{order:7,value:"#047857"},800:{order:8,value:"#065F46"},900:{order:9,value:"#064E3B"}}},teal:{order:11,variants:{50:{order:0,value:"#F0FDFA"},100:{order:1,value:"#CCFBF1"},200:{order:2,value:"#99F6E4"},300:{order:3,value:"#5EEAD4"},400:{order:4,value:"#2DD4BF"},500:{order:5,value:"#14B8A6"},600:{order:6,value:"#0D9488"},700:{order:7,value:"#0F766E"},800:{order:8,value:"#115E59"},900:{order:9,value:"#134E4A"}}},cyan:{order:12,variants:{50:{order:0,value:"#ECFEFF"},100:{order:1,value:"#CFFAFE"},200:{order:2,value:"#A5F3FC"},300:{order:3,value:"#67E8F9"},400:{order:4,value:"#22D3EE"},500:{order:5,value:"#06B6D4"},600:{order:6,value:"#0891B2"},700:{order:7,value:"#0E7490"},800:{order:8,value:"#155E75"},900:{order:9,value:"#164E63"}}},sky:{order:13,variants:{50:{order:0,value:"#F0F9FF"},100:{order:1,value:"#E0F2FE"},200:{order:2,value:"#BAE6FD"},300:{order:3,value:"#7DD3FC"},400:{order:4,value:"#38BDF8"},500:{order:5,value:"#0EA5E9"},600:{order:6,value:"#0284C7"},700:{order:7,value:"#0369A1"},800:{order:8,value:"#075985"},900:{order:9,value:"#0C4A6E"}}},blue:{order:14,variants:{50:{order:0,value:"#EFF6FF"},100:{order:1,value:"#DBEAFE"},200:{order:2,value:"#BFDBFE"},300:{order:3,value:"#93C5FD"},400:{order:4,value:"#60A5FA"},500:{order:5,value:"#3B82F6"},600:{order:6,value:"#2563EB"},700:{order:7,value:"#1D4ED8"},800:{order:8,value:"#1E40AF"},900:{order:9,value:"#1E3A8A"}}},indigo:{order:15,variants:{50:{order:0,value:"#EEF2FF"},100:{order:1,value:"#E0E7FF"},200:{order:2,value:"#C7D2FE"},300:{order:3,value:"#A5B4FC"},400:{order:4,value:"#818CF8"},500:{order:5,value:"#6366F1"},600:{order:6,value:"#4F46E5"},700:{order:7,value:"#4338CA"},800:{order:8,value:"#3730A3"},900:{order:9,value:"#312E81"}}},purple:{order:16,variants:{50:{order:0,value:"#F5F3FF"},100:{order:1,value:"#EDE9FE"},200:{order:2,value:"#DDD6FE"},300:{order:3,value:"#C4B5FD"},400:{order:4,value:"#A78BFA"},500:{order:5,value:"#8B5CF6"},600:{order:6,value:"#7C3AED"},700:{order:7,value:"#6D28D9"},800:{order:8,value:"#5B21B6"},900:{order:9,value:"#4C1D95"}}},fuchsia:{order:17,variants:{50:{order:0,value:"#FDF4FF"},100:{order:1,value:"#FAE8FF"},200:{order:2,value:"#F5D0FE"},300:{order:3,value:"#F0ABFC"},400:{order:4,value:"#E879F9"},500:{order:5,value:"#D946EF"},600:{order:6,value:"#C026D3"},700:{order:7,value:"#A21CAF"},800:{order:8,value:"#86198F"},900:{order:9,value:"#701A75"}}}},shadow:{sm:{order:0,value:"0 1px 2px 0 rgba(0, 0, 0, 0.25)"},base:{order:1,value:"0 1px 3px 0 rgba(0, 0, 0, 0.25), 0 1px 2px 0 rgba(0, 0, 0, 0.25)"},md:{order:2,value:"0 4px 6px -1px rgba(0, 0, 0, 0.25), 0 2px 4px -1px rgba(0, 0, 0, 0.25)"},lg:{order:3,value:"0 10px 15px -3px rgba(0, 0, 0, 0.25), 0 4px 6px -2px rgba(0, 0, 0, 0.25)"},xl:{order:4,value:"0 20px 25px -5px rgba(0, 0, 0, 0.25), 0 10px 10px -5px rgba(0, 0, 0, 0.25)"},"2xl":{order:5,value:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"}},spacing:.25,fontSize:{lg:{order:0,value:"1.125rem"},sm:{order:1,value:"0.875rem"},xl:{order:2,value:"1.25rem"},xs:{order:3,value:"0.75rem"},"2xl":{order:4,value:"1.5rem"},"3xl":{order:5,value:"1.875rem"},"4xl":{order:6,value:"2.25rem"},"5xl":{order:7,value:"3rem"},xxs:{order:8,value:"0.625rem"},base:{order:9,value:"1rem",default:!0}},fontFamily:{mono:{order:0,value:["Fira Code","monospace"]},sans:{order:1,value:["Inter","sans-serif"],default:!0}},fontWeight:{bold:{order:0,value:"700"},bolder:{order:1,value:"800"},normal:{order:2,value:"500",default:!0},regular:{order:3,value:"400"},"semi-bold":{order:4,value:"600"}},breakpoints:{large:{order:2,value:1440},small:{order:0,value:576},medium:{order:1,value:960}}}});var Lr=w(Te=>{"use strict";Object.defineProperty(Te,"__esModule",{value:!0});Te.toValidClassName=Te.getClassName=void 0;var Hf=5381,Df=(e,t)=>{let r=t.length;for(;r;)e=e*33^t.charCodeAt(--r);return e},If=e=>Df(Hf,e),$f=/(a)(d)/gi,$t=52,Gs=e=>String.fromCharCode(e+(e>25?39:97));function Nf(e){let t="",r;for(r=Math.abs(e);r>$t;r=r/$t|0)t=Gs(r%$t)+t;return(Gs(r%$t)+t).replace($f,"$1-$2")}var Lf=e=>Nf(If(JSON.stringify(e)));Te.getClassName=Lf;var qf=(e,t=!1)=>{let r=e.trim().replace(/\s+/g,"-");return t&&(r=r.replace(/[^a-zA-Z0-9-_]/g,o=>`\\${o}`)),/^[^a-zA-Z]/.test(r)&&(r=`_${r}`),r};Te.toValidClassName=qf});var Xs=w(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});Fe.getOldThemeCss=Fe.getThemeCss=void 0;var Js=It(),Mf=(e,t)=>"breakpoints"in e?(0,Fe.getOldThemeCss)(e):`
${t.includeResetStyle?Js.RESET_STYLES:""}

@layer base {
  ${t.createFontFaces?e.fonts.map(r=>`
    ${r.variants.map(o=>`
    @font-face {
      font-family: "${r.family}";
      font-style: ${o.italic?"italic":"normal"};
      font-weight: ${o.weight};
      font-display: auto;
      src: local("${o.url.substring(o.url.lastIndexOf("/")+1)}"), url("${o.url.replace("https://fonts.gstatic.com","/.toddle/fonts/font")}") format("woff2");
    }
    `).join(`
`)}
    `).join(`
`):""}

  body, :host {
    /* Color */
      ${e.color.flatMap(r=>r.tokens.map(o=>`--${o.name}: ${o.value};`)).join(`
`)}
  /* Fonts */
    ${e.fonts.map(r=>`--font-${r.name}: '${r.family}',${r.type};`).join(`
`)}

    /* Font size */
    ${e["font-size"].flatMap(r=>r.tokens.map(o=>`--${o.name}: ${o.type==="variable"?`var(--${o.value})`:o.value};`)).join(`
`)}

    /* Font weight */
    ${e["font-weight"].flatMap(r=>r.tokens.map(o=>`--${o.name}: ${o.type==="variable"?`var(--${o.value})`:o.value};`)).join(`
`)}

    /* Shadows */
    ${e.shadow.flatMap(r=>r.tokens.map(o=>`--${o.name}: ${o.type==="variable"?`var(--${o.value})`:o.value};`)).join(`
`)}

    /* Border radius */
    ${e["border-radius"].flatMap(r=>r.tokens.map(o=>`--${o.name}: ${o.type==="variable"?`var(--${o.value})`:o.value};`)).join(`
`)}

    /* Spacing */
    ${e.spacing.map(r=>r.tokens.map(o=>`--${o.name}: ${o.type==="variable"?`var(--${o.value})`:o.value};`).join(`
`)).join(`
`)}

    /* Z-index */
    ${e["z-index"].map(r=>r.tokens.map(o=>`--${o.name}: ${o.type==="variable"?`var(--${o.value})`:o.value};`).join(`
`)).join(`
`)}
  }

  @keyframes animation-spin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }

  @keyframes animation-fade-in {
    from {
      opacity:0;
    }
    to {
      opacity:1;
    }
  }


  @keyframes animation-fade-out {
    from {
      opacity:1;
    }
    to {
      opacity:0;
    }
  }
}
`;Fe.getThemeCss=Mf;var Uf=e=>{let t=Object.entries(e.colors).flatMap(([r,{variants:o}])=>Object.entries(o).map(([n,{value:a}])=>`--${r}-${n}:${a}`));return`




body, :host {
  ${Object.entries(e.fontFamily).map(([r,{value:[o,...n]}])=>`--font-${r}: '${o}',${n.join(",")};`).join(`
`)}

  ${Object.entries(e.fontWeight).map(([r,{value:o}])=>`--font-weight-${r}: ${o};`).join(`
`)}

  ${Object.entries(e.fontSize).map(([r,{value:o}])=>`--font-size-${r}: ${o};`).join(`
`)}

  --spacing:${e.spacing}rem;
    ${t.join(`;
`)};


  --text-xxs:0.625rem;
  --line-height-xxs:0.9rem;

  --text-xs:0.75rem;
  --line-height-xs:1rem;

  --text-sm:0.875rem;
  --line-height-sm:1.25rem;

  --text-base:1rem;
  --line-height-base:1.5rem;

  --text-lg:1.125rem;
  --line-height-lg:1.75rem;

  --text-xl:1.25rem;
  --line-height-xl:1.75rem;

  --text-2xl:1.5rem;
  --line-height-2xl:2rem;

  --text-3xl:1.875rem;
  --line-height-3xl:2.25rem;

  --text-4xl:2.25rem;
  --line-height-4xl:2.5rem;

  --text-5xl:3rem;
  --line-height-5xl:3rem;

  ${Object.entries(e.shadow).map(([r,{value:o}])=>`--shadow-${r}:${o};`).join(`
`)}
}

${Js.RESET_STYLES}

@keyframes animation-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@keyframes animation-fade-in {
  from {
    opacity:0;
  }
  to {
    opacity:1;
  }
}


@keyframes animation-fade-out {
  from {
    opacity:1;
  }
  to {
    opacity:0;
  }
}`};Fe.getOldThemeCss=Uf});var Qs=w(Nt=>{"use strict";Object.defineProperty(Nt,"__esModule",{value:!0});Nt.variantSelector=void 0;var Bf=e=>[(e.className??e.class)&&`.${e.className}`,(e.evenChild??e["even-child"])&&":nth-child(even)",(e.firstChild??e["first-child"])&&":first-child",(e.focusWithin??e["focus-within"])&&":focus-within",(e.lastChild??e["last-child"])&&":last-child",e.active&&":active",e.autofill&&":is(:-webkit-autofill, :autofill)",e.checked&&":checked",e.disabled&&":disabled",e.empty&&":empty",e.focus&&":focus",e.hover&&":hover",e.invalid&&":invalid",e.link&&":link",e.visited&&":visited",e["first-of-type"]&&":first-of-type",e["focus-visible"]&&":focus-visible",e["last-of-type"]&&":last-of-type",e["popover-open"]&&":popover-open",e.pseudoElement&&`::${e.pseudoElement}`].filter(Boolean).join("");Nt.variantSelector=Bf});var ti=w(pe=>{"use strict";Object.defineProperty(pe,"__esModule",{value:!0});pe.getAllFonts=pe.createStylesheet=void 0;pe.kebabCase=ei;var Vf=Y(),Zs=j(),Ys=Lr(),Kf=Xs(),Wf=Qs(),zf={large:1440,small:576,medium:960};function ei(e){return e.split("").map(t=>"ABCDEFGHIJKLMNOPQRSTYVWXYZ".includes(t)?"-"+t.toLocaleLowerCase():t).join("")}var Gf=new Set(["width","min-width","max-width","height","min-height","max-height","margin","margin-top","margin-left","margin-bottom","margin-right","padding","padding-top","padding-left","padding-bottom","padding-right","gap","gap-x","gap-y","border-radius","border-bottom-left-radius","border-bottom-right-radius","border-top-left-radius","border-top-right-radius","border-width","border-top-width","border-left-width","border-bottom-width","border-right-width","font-size","top","right","bottom","left","outline-width"]),Jf=(e,t,r,o)=>{let n=new Set,a=(0,pe.getAllFonts)(t),s=(0,Kf.getThemeCss)("breakpoints"in r?{...r,fontFamily:Object.fromEntries(Object.entries(r.fontFamily).filter(([d,h])=>h.default??a.has("--font-"+d)))}:{...r,fonts:r.fonts},o),i=d=>Object.entries(d).map(([h,p])=>{if(!(0,Zs.isDefined)(p))return;let y=ei(h),b=String(Number(p))===String(p)&&Gf.has(y)?`${Number(p)*4}px`:p;return`${y}:${b};`}).filter(Boolean).join(`
  `),l=(d,h)=>{try{let p=(0,Vf.omitKeys)(d.style??{},["variants","breakpoints","shadows"]),y=d.variants??d.style?.variants,b=(g,A,O)=>{let E=Object.entries(A).filter(([S])=>S=="scrollbar-width"),F=i(A);return O?.startingStyle&&(F=`@starting-style {
            ${F}
          }`),`
  ${F.length>0?`${g} {
    ${F}
  }`:""}
      ${E.length>0?`
${g}::-webkit-scrollbar {
  ${E.map(([S,D])=>{switch(D){case"none":return"width: 0;";case"thinn":case"thin":return"width: 4px;";default:return""}}).join(`
`)}
}
`:""}
`};return`
      ${b("."+h,p)}
      ${(y??[]).map(g=>{let A=b(`.${h}${(0,Wf.variantSelector)(g)}`,g.style,{startingStyle:g.startingStyle});return g.mediaQuery?`
          @media (${Object.entries(g.mediaQuery).map(([O,E])=>`${O}: ${E}`).filter(Boolean).join(") and (")}) {
            ${A}
          }
          `:g.breakpoint?`
          @media (min-width: ${zf[g.breakpoint]}px) {
            ${A}
          }
          `:A}).join(`
`)}
      `}catch{return""}},u=new Set;function c(d,h){u.has(d.name)||(u.add(d.name),d.nodes&&Object.entries(d.nodes).forEach(([p,y])=>{if(y.type==="component"){let g=t.find(A=>A.name===[y.package??h,y.name].filter(O=>O).join("/"));if(g){c(g,y.package??h),s+=`
`+l(y,(0,Ys.toValidClassName)(`${d.name}:${p}`,!0));return}}if(y.type!=="element")return;let b=(0,Ys.getClassName)([y.style,y.variants]);if(n.has(b))return"";n.add(b),s+=`
`+l(y,b)}))}return c(e),s};pe.createStylesheet=Jf;var Xf=e=>new Set(e.flatMap(t=>Object.values(t.nodes).flatMap(r=>r.type==="element"?[r.style.fontFamily,r.style["font-family"],...r.variants?.map(o=>o.style.fontFamily??o.style["font-family"])??[]].filter(Zs.isDefined):[])).map(t=>t.replace("var(","").replace(")","").replace(/'/g,"")));pe.getAllFonts=Xf});var qr=w(Lt=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});Lt.VOID_HTML_ELEMENTS=void 0;Lt.VOID_HTML_ELEMENTS=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"]});var Ur=w(se=>{"use strict";Object.defineProperty(se,"__esModule",{value:!0});se.toEncodedText=se.escapeAttrValue=void 0;se.getNodeAttrs=am;var Mr=V(),ri=j(),Qf=/"/g,Yf=/</g,Zf=/>/g,em=["string","number","boolean"],tm=e=>!(0,ri.isDefined)(e)||!em.includes(typeof e)?"":om(rm(String(e)));se.escapeAttrValue=tm;var rm=e=>e.replace(Qf,"&quot;"),om=e=>e.replace(Yf,"&lt;").replace(Zf,"&gt;"),nm=e=>e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;").replaceAll(`
`,"<br />");se.toEncodedText=nm;function am({node:e,data:t,component:r,packageName:o,env:n,toddle:a}){let{style:s,...i}=e.attrs,l=Object.entries(i).reduce((d,[h,p])=>{let y=(0,Mr.applyFormula)(p,{data:t,component:r,package:o,env:n,toddle:a});return(0,ri.toBoolean)(y)&&d.push(`${h}="${(0,se.escapeAttrValue)(y)}"`),d},[]),u=Object.values(e["style-variables"]??{}).map(({name:d,formula:h,unit:p})=>`--${d}: ${String((0,Mr.applyFormula)(h,{data:t,component:r,package:o,env:n,toddle:a}))+(p??"")}`),c=[...s?[(0,Mr.applyFormula)(s,{data:t,component:r,package:o,env:n,toddle:a})]:[],...u].filter(Boolean).map(String).join("; ");return c.length>0?[...l,`style="${(0,se.escapeAttrValue)(c)};"`].join(" "):l.join(" ")}});var si=w(Bt=>{"use strict";Object.defineProperty(Bt,"__esModule",{value:!0});Bt.renderPageBody=void 0;var sm=At(),W=V(),oi=Lr(),Ut=Y(),qt=j(),Mt=Rt(),im=qr(),ni=Ur(),ai=async({apiCache:e,children:t,component:r,data:o,env:n,evaluateComponentApis:a,files:s,toddle:i,includedComponents:l,instance:u,packageName:c,projectId:d,req:h,updateApiCache:p})=>{let y=async({id:b,node:g,data:A,packageName:O,isComponentRootNode:E=!1})=>{if(!g)return"";let F={data:A,component:r,package:O,env:n,toddle:i};if(g.repeat){let S=(0,W.applyFormula)(g.repeat,F);return Array.isArray(S)?(await Promise.all(S.map((_,T)=>y({id:b,node:{...g,repeat:void 0},data:{...A,ListItem:A.ListItem?{Index:T,Item:_,Parent:A.ListItem}:{Index:T,Item:_}},packageName:O})))).join(""):""}if(g.condition&&!(0,qt.toBoolean)((0,W.applyFormula)(g.condition,F)))return"";switch(g.type){case"text":return`<span data-node-type="text" data-node-id="${b}">${(0,ni.toEncodedText)(String((0,W.applyFormula)(g.value,F)))}</span>`;case"slot":{let S=t?.[g.name??"default"];return S||(await Promise.all(g.children.map(_=>y({id:_,node:r.nodes[_],data:A,packageName:O})))).join("")}case"element":{if(g.tag.toLocaleLowerCase()==="script")return"";let S=(0,ni.getNodeAttrs)({node:g,data:A,component:r,packageName:O,env:n,toddle:i}),D=(0,oi.getClassName)([g.style,g.variants]),_=Object.entries(g.classes).filter(([$,{formula:ue}])=>(0,qt.toBoolean)((0,W.applyFormula)(ue,F))).map(([$])=>$).join(" ");u&&b==="root"&&Object.entries(u).forEach(([$,ue])=>{_+=" "+(0,oi.toValidClassName)(`${$}:${ue}`)});let T="";if(["script","style"].includes(g.tag.toLocaleLowerCase())===!1&&(T=(await Promise.all(g.children.map(ue=>y({id:ue,node:r.nodes[ue],data:A,packageName:O})))).join("")),g.tag.toLocaleLowerCase()==="style"){let $=g.children[0]?r.nodes[g.children[0]]:void 0;$?.type==="text"&&(T=String((0,W.applyFormula)($.value,F)))}let k=r.version===2&&E?`${O??d}-${g.tag}`:g.tag,oe=`${D} ${_}`.trim();return im.VOID_HTML_ELEMENTS.includes(k)?`<${k} ${S} data-node-id="${(0,Mt.escapeAttrValue)(b)}" class="${(0,Mt.escapeAttrValue)(oe)}" />`:`<${k} ${S} data-node-id="${(0,Mt.escapeAttrValue)(b)}" class="${(0,Mt.escapeAttrValue)(oe)}">${T}</${k}>`}case"component":{let S=(0,Ut.mapValues)(g.attrs,N=>(0,W.applyFormula)(N,F)),D={...A.Contexts,[r.name]:Object.fromEntries(Object.entries(r.formulas??{}).filter(([,N])=>N.exposeInContext).map(([N,X])=>[N,(0,W.applyFormula)(X.formula,F)]))},_,T=g.package??O;if(T?_=s.packages?.[T]?.components[g.name]??s.components[g.name]:_=s.components[g.name],!(0,qt.isDefined)(_))return"";let k=_,oe=l.some(N=>N.name===k.name),$=await a({component:new sm.ToddleComponent({component:k,getComponent:(N,X)=>{let Ie=[X,N].filter(qt.isDefined).join("/"),ce=X?s.packages?.[X]?.components[N]:s.components[N];if(ce)return ce},packageName:O,globalFormulas:{formulas:s.formulas,packages:s.packages}}),formulaContext:{data:{Location:F.data.Location,Attributes:S,Contexts:D,Variables:(0,Ut.mapValues)(k.variables,({initialValue:N})=>(0,W.applyFormula)(N,F)),Apis:{}},component:k,package:g.package??(oe?void 0:O),env:n,toddle:i},req:h,apiCache:e,updateApiCache:p}),ue=await Promise.all(g.children.map(N=>y({id:N,node:r.nodes[N],data:{...A,Contexts:{...D,[k.name]:Object.fromEntries(Object.entries(k.formulas??{}).filter(([,X])=>X.exposeInContext).map(([X,Ie])=>[X,(0,W.applyFormula)(Ie.formula,{component:k,package:T,data:{Contexts:{...A.Contexts,...Object.fromEntries(Object.entries(k.formulas??{}).filter(([,ce])=>ce.exposeInContext).map(([ce,Vu])=>[ce,(0,W.applyFormula)(Vu.formula,{data:{Attributes:S,Apis:{...A.Apis,...$}},component:r,package:T,env:n,toddle:i})]))},Apis:$,Attributes:S,Variables:(0,Ut.mapValues)(k.variables,({initialValue:ce})=>(0,W.applyFormula)(ce,{data:{Attributes:S},component:r,package:T,env:n,toddle:i}))},env:n,toddle:i})]))}},packageName:g.package??O}))),Yt={};return ue.forEach((N,X)=>{let Ie=r.nodes[g.children[X]]?.slot??"default";Yt[Ie]=`${Yt[Ie]??""} ${N}`}),lm({attrs:S,component:k,contexts:D,children:Yt,packageName:g.package??(oe?void 0:O),instance:b==="root"?{...u,[r.name]:"root"}:{[r.name]:b},apis:$,env:n,includedComponents:l,formulaContext:F,files:s,apiCache:e,updateApiCache:p,projectId:d,evaluateComponentApis:a,req:h})}}};return y({id:"root",node:r.nodes.root,data:o,packageName:c,isComponentRootNode:!0})},lm=async({apiCache:e,apis:t,attrs:r,children:o,component:n,contexts:a,env:s,evaluateComponentApis:i,files:l,formulaContext:u,includedComponents:c,instance:d,packageName:h,projectId:p,req:y,updateApiCache:b})=>{let g={Location:u.data.Location,Attributes:r,Contexts:a,Variables:(0,Ut.mapValues)(n.variables,({initialValue:A})=>(0,W.applyFormula)(A,{...u,data:{...u.data,Contexts:a}})),Apis:t};return g.Contexts={...g.Contexts,...Object.fromEntries(Object.entries(n.formulas??{}).filter(([,A])=>A.exposeInContext).map(([A,O])=>[A,(0,W.applyFormula)(O.formula,{...u,data:g})]))},ai({apiCache:e,children:o,component:n,data:g,env:s,evaluateComponentApis:i,files:l,includedComponents:c,instance:d,packageName:h,projectId:p,req:y,toddle:u.toddle,updateApiCache:b})},um=async({component:e,env:t,evaluateComponentApis:r,files:o,formulaContext:n,includedComponents:a,req:s,projectId:i})=>{let l={},u=(h,p)=>l[h]=p,c=await r({component:e,formulaContext:n,req:s,apiCache:l,updateApiCache:u});return n.data.Apis=c,{html:await ai({apiCache:l,component:e,data:n.data,env:t,evaluateComponentApis:r,files:o,includedComponents:a,instance:{},packageName:void 0,projectId:i,req:s,toddle:n.toddle,updateApiCache:u}),apiCache:l}};Bt.renderPageBody=um});var Br={};m(Br,{default:()=>dm});var ii,cm,dm,li=f(()=>{ii=v(j()),cm=([e])=>(0,ii.toBoolean)(e),dm=cm});var Vr={};m(Vr,{default:()=>mm});var fm,mm,ui=f(()=>{fm=([e])=>typeof e!="string"?null:e.length===0?e:e[0].toLocaleUpperCase()+e.substring(1).toLocaleLowerCase(),mm=fm});var Kr={};m(Kr,{default:()=>hm});var pm,hm,ci=f(()=>{pm=([e,t])=>typeof t!="number"||isNaN(t)?null:Array.isArray(e)?e.slice(t):typeof e=="string"?e.substring(t):null,hm=pm});var Wr={};m(Wr,{default:()=>ym});var gm,ym,di=f(()=>{gm=([e,t])=>{if(typeof e!="number"||typeof t!="number")return null;let r=Math.max(1,Math.pow(10,t));return Math.round(e*r)/r},ym=gm});var zr={};m(zr,{default:()=>vm});var bm,vm,fi=f(()=>{bm=([e])=>typeof e!="string"?null:e.trim(),vm=bm});var Gr={};m(Gr,{default:()=>Am});var Fm,Am,mi=f(()=>{Fm=([e],{root:t})=>typeof e!="string"?null:t.getElementById(e),Am=Fm});var Jr={};m(Jr,{default:()=>Em});var wm,Em,pi=f(()=>{wm=([e])=>typeof e=="number"?new Date(e):null,Em=wm});var Xr={};m(Xr,{default:()=>jm});var hi,Om,jm,gi=f(()=>{hi=v(Fr()),Om=([e])=>!e||typeof e!="string"?null:(0,hi.STRING_TEMPLATE)("cookies",e),jm=Om});var Qr={};m(Qr,{default:()=>Cm});var yi,xm,Cm,bi=f(()=>{yi=v(j()),xm=([e])=>Array.isArray(e)?e.length:(0,yi.isObject)(e)?Object.keys(e).length:typeof e=="string"?e.length:null,Cm=xm});var Yr={};m(Yr,{default:()=>_m});var Sm,_m,vi=f(()=>{Sm=([e])=>typeof e!="string"?null:e.toLocaleUpperCase(),_m=Sm});var Zr={};m(Zr,{default:()=>Rm});var km,Rm,Fi=f(()=>{km=()=>Math.random(),Rm=km});var eo={};m(eo,{default:()=>Pm});var Tm,Pm,Ai=f(()=>{Tm=([e,t])=>typeof e=="string"?e.indexOf(t):Array.isArray(e)?e.findIndex(r=>globalThis.toddle.isEqual(r,t)):null,Pm=Tm});var to={};m(to,{default:()=>Dm});var Hm,Dm,wi=f(()=>{Hm=([e,t])=>typeof e=="string"?e.lastIndexOf(t):Array.isArray(e)?e.findLastIndex(r=>globalThis.toddle.isEqual(r,t)):null,Dm=Hm});var ro={};m(ro,{default:()=>$m});var Im,$m,Ei=f(()=>{Im=([e,t])=>Array.isArray(e)?e.join(String(t)):null,$m=Im});var oo={};m(oo,{default:()=>Lm});var Nm,Lm,Oi=f(()=>{Nm=([e])=>typeof e!="string"?null:encodeURIComponent(e),Lm=Nm});var no={};m(no,{default:()=>Mm});var qm,Mm,ji=f(()=>{qm=([e])=>typeof e!="string"?null:btoa(e),Mm=qm});var ao={};m(ao,{default:()=>Bm});var Um,Bm,xi=f(()=>{Um=([e])=>typeof e!="number"?null:Math.sqrt(e),Bm=Um});var so={};m(so,{default:()=>Km});var Vm,Km,Ci=f(()=>{Vm=()=>new Date,Km=Vm});var io={};m(io,{default:()=>Wm,getArgumentInputData:()=>zm,handler:()=>Si});var Si,Wm,zm,_i=f(()=>{Si=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.findIndex((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.entries(e).findIndex(([r,o])=>t({key:r,value:o})):null,Wm=Si,zm=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{key:o[0],value:o[1]}}}return r}});var lo={};m(lo,{default:()=>Jm});var Gm,Jm,ki=f(()=>{Gm=([e])=>Array.isArray(e)?[...e].reverse():null,Jm=Gm});var uo={};m(uo,{default:()=>Qm});var Xm,Qm,Ri=f(()=>{Xm=([e,t])=>e>=t,Qm=Xm});var co={};m(co,{default:()=>Zm});var Ym,Zm,Ti=f(()=>{Ym=([e])=>Number(e),Zm=Ym});var fo={};m(fo,{default:()=>tp,getArgumentInputData:()=>rp});var ep,tp,rp,Pi=f(()=>{ep=([e,t,r])=>{if(!Array.isArray(e)||typeof t!="function"||typeof r!="boolean")return null;let o=r?1:-1;return[...e].sort((n,a)=>{let s=t({item:n}),i=t({item:a});if(Array.isArray(s)&&Array.isArray(i)){for(let l in s)if(s[l]!==i[l])return(s[l]>i[l]?1:-1)*o;return 0}return s===i?0:(s>i?1:-1)*o})},tp=ep,rp=([e],t,r)=>t===1&&Array.isArray(e)?{...r,Args:{item:e[0]}}:r});var mo={};m(mo,{default:()=>np});var Hi,op,np,Di=f(()=>{Hi=v(j()),op=e=>{if(e.every(Array.isArray)){let t=[];for(let r of e)t.push(...r);return t}return e.every(Hi.isObject)?Object.assign({},...e):e.join("")},np=op});var po={};m(po,{default:()=>sp,getArgumentInputData:()=>ip});var ap,sp,ip,Ii=f(()=>{ap=([e,t,r])=>typeof t!="function"?null:Array.isArray(e)?e.reduce((o,n,a)=>t({result:o,item:n,index:a}),r):e&&typeof e=="object"?Object.entries(e).reduce((o,[n,a])=>t({result:o,key:n,value:a}),r):null,sp=ap,ip=([e,t,r],o,n)=>{if(o!==1)return n;if(Array.isArray(e))return{...n,Args:{item:e[0],index:0,result:r}};if(e&&typeof e=="object"){let[a]=Object.entries(e);if(a)return{...n,Args:{key:a[0],value:a[1],result:r}}}return n}});var ho={};m(ho,{default:()=>lp,getArgumentInputData:()=>up,handler:()=>$i});var $i,lp,up,Ni=f(()=>{$i=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.find((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.entries(e).find(([r,o])=>t({key:r,value:o}))?.[1]:null,lp=$i,up=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{key:o[0],value:o[1]}}}return r}});var go={};m(go,{default:()=>dp});var cp,dp,Li=f(()=>{cp=([e,t])=>typeof t!="number"?null:Array.isArray(e)?e.slice(e.length-t):typeof e=="string"?e.substring(e.length-t):null,dp=cp});var yo={};m(yo,{default:()=>mp});var fp,mp,qi=f(()=>{fp=([e])=>{switch(typeof e){case"number":return isNaN(e)?null:"Number";case"string":return"String";case"boolean":return"Boolean";case"object":return Array.isArray(e)?"Array":e===null?"Null":"Object";case"undefined":return"Null";default:return null}},mp=fp});var bo={};m(bo,{default:()=>hp});var pp,hp,Mi=f(()=>{pp=([e,t])=>globalThis.toddle.isEqual(e,t),hp=pp});var vo={};m(vo,{default:()=>yp});var gp,yp,Ui=f(()=>{gp=([e,t,r])=>{if(typeof e!="number"||Number.isNaN(e))return null;let o=typeof t=="string"&&t.length>0||Array.isArray(t)&&t.every(F=>typeof F=="string")?t:void 0;if(!r||typeof r!="object")return Intl.NumberFormat(o).format(e);let n=(F,S)=>typeof F=="string"&&(S?.includes(F)??!0)?F:void 0,a=r,s=n(a.style,["decimal","currency","percent","unit"]),i=typeof a.currency=="string"&&a.currency.length===3?a.currency:void 0;if(s==="currency"&&typeof i!="string")return null;let l=n(a.currencyDisplay,["code","symbol","narrowSymbol","name"]),u=typeof a.unit=="string"?a.unit:void 0;if(s==="unit"&&typeof u!="string")return null;let c=n(a.unitDisplay,["short","narrow","long"]),d=typeof a.minimumIntegerDigits=="number"&&a.minimumIntegerDigits>=1&&a.minimumIntegerDigits<=21?a.minimumIntegerDigits:void 0,h=typeof a.minimumFractionDigits=="number"&&a.minimumFractionDigits>=0&&a.minimumFractionDigits<=100?a.minimumFractionDigits:void 0,p=typeof a.maximumFractionDigits=="number"&&a.maximumFractionDigits>=0&&a.maximumFractionDigits<=100?a.maximumFractionDigits:void 0,y=typeof a.minimumSignificantDigits=="number"&&a.minimumSignificantDigits>=1&&a.minimumSignificantDigits<=21?a.minimumSignificantDigits:void 0,b=typeof a.maximumSignificantDigits=="number"&&a.maximumSignificantDigits>=1&&a.maximumSignificantDigits<=21?a.maximumSignificantDigits:void 0,g=n(a.notation,["standard","scientific","engineering","compact"]),A=n(a.compactDisplay,["short","long"]),O=["always","auto","min2"],E=typeof a.useGrouping=="boolean"?a.useGrouping:n(a.useGrouping,O);return new Intl.NumberFormat(o,{style:s,currency:i,currencyDisplay:l,unit:u,unitDisplay:c,minimumIntegerDigits:d,minimumFractionDigits:h,maximumFractionDigits:p,minimumSignificantDigits:y,maximumSignificantDigits:b,notation:g,compactDisplay:A,useGrouping:E}).format(e)},yp=gp});var Fo={};m(Fo,{default:()=>bp,getArgumentInputData:()=>vp,handler:()=>Bi});var Bi,bp,vp,Vi=f(()=>{Bi=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.some((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.entries(e).some(([r,o])=>t({key:r,value:o})):null,bp=Bi,vp=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{key:o[0],value:o[1]}}}return r}});var Ao={};m(Ao,{default:()=>Ap});var Fp,Ap,Ki=f(()=>{Fp=([e,t])=>e<t,Ap=Fp});var wo={};m(wo,{default:()=>wp,getArgumentInputData:()=>Ep,handler:()=>Wi});var Wi,wp,Ep,zi=f(()=>{Wi=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.every((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.entries(e).every(([r,o])=>t({key:r,value:o})):null,wp=Wi,Ep=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{key:o[0],value:o[1]}}}return r}});var Eo={};m(Eo,{default:()=>jp});var Op,jp,Gi=f(()=>{Op=(e,t)=>t.env.branchName,jp=Op});var Oo={};m(Oo,{default:()=>Cp});var Vt,xp,Cp,Ji=f(()=>{Vt=v(j()),xp=([e,t,r,o,n])=>{if(typeof e!="string"||typeof t!="string")return[];let a=[(0,Vt.toBoolean)(r)?"g":"",(0,Vt.toBoolean)(o)?"i":"",(0,Vt.toBoolean)(n)?"m":""].join(""),s=new RegExp(t,a);return e.match(s)??[]},Cp=xp});var jo={};m(jo,{default:()=>_p});var Sp,_p,Xi=f(()=>{Sp=([e])=>typeof e=="string"||Array.isArray(e)?e[e.length-1]:null,_p=Sp});var Qi=w(xo=>{"use strict";Object.defineProperty(xo,"__esModule",{value:!0});xo.parseJSONWithDate=Rp;var kp=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:.\d{1,3})?Z$/;function Rp(e){return JSON.parse(e,(t,r)=>typeof r=="string"&&r.length===24&&kp.test(r)?new Date(r):r)}});var Co={};m(Co,{default:()=>Pp});var Yi,Tp,Pp,Zi=f(()=>{Yi=v(Qi()),Tp=([e])=>{if(typeof e!="string")return null;try{return(0,Yi.parseJSONWithDate)(e)}catch{return null}},Pp=Tp});var So={};m(So,{default:()=>Hp,getArgumentInputData:()=>Dp,handler:()=>el});var el,Hp,Dp,tl=f(()=>{el=([e,t])=>{if(typeof t!="function"||!e||typeof e!="object"||!Array.isArray(e))return null;let r={};for(let o in e){let n=e[o],a=String(t({item:n,index:o}));r[a]=r[a]??[],r[a].push(n)}return r},Hp=el,Dp=([e],t,r)=>t===1&&Array.isArray(e)?{...r,Args:{item:e[0],index:0}}:r});var _o={};m(_o,{default:()=>Ip,getArgumentInputData:()=>$p,handler:()=>rl});var rl,Ip,$p,ol=f(()=>{rl=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.filter((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.fromEntries(Object.entries(e).filter(([r,o])=>t({key:r,value:o}))):Array.isArray(e)?e.filter((r,o)=>t({item:r,index:o})):null,Ip=rl,$p=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{value:o[1],key:o[0]}}}return r}});var ko={};m(ko,{default:()=>Lp});var Np,Lp,nl=f(()=>{Np=([e,t])=>e<=t,Lp=Np});var Ro={};m(Ro,{default:()=>Mp});var qp,Mp,al=f(()=>{qp=([e,t])=>!globalThis.toddle.isEqual(e,t),Mp=qp});var To={};m(To,{default:()=>Bp});var Up,Bp,sl=f(()=>{Up=([e])=>typeof e!="number"?null:Math.abs(e),Bp=Up});var Po={};m(Po,{default:()=>Kp});var Vp,Kp,il=f(()=>{Vp=([e,t])=>e>t,Kp=Vp});var Ho={};m(Ho,{default:()=>zp});var ll,Wp,zp,ul=f(()=>{ll=v(j()),Wp=([e])=>!(0,ll.toBoolean)(e),zp=Wp});var Do={};m(Do,{default:()=>Jp});var Gp,Jp,cl=f(()=>{Gp=([e,t])=>typeof e=="string"&&typeof t=="string"?e.includes(t):Array.isArray(e)?e.some(r=>globalThis.toddle.isEqual(r,t)):null,Jp=Gp});var Io={};m(Io,{default:()=>Qp});var Xp,Qp,dl=f(()=>{Xp=([e,t])=>{if(typeof e!="number"||typeof t!="number")return null;let r=Math.max(1,Math.pow(10,t));return Math.ceil(e*r)/r},Qp=Xp});var $o={};m($o,{default:()=>Zp});var Yp,Zp,fl=f(()=>{Yp=(e,t)=>t.env.isServer,Zp=Yp});var No={};m(No,{default:()=>th});var eh,th,ml=f(()=>{eh=e=>!Array.isArray(e)||e.some(t=>t===null||typeof t!="number")?null:e.reduce((t,r)=>t+Number(r),0),th=eh});var Lo={};m(Lo,{default:()=>oh});var rh,oh,pl=f(()=>{rh=e=>e.some(t=>isNaN(Number(t)))?null:e.reduce((t,r)=>t*r,1),oh=rh});var qo={};m(qo,{default:()=>ah});var hl,nh,ah,gl=f(()=>{hl=v(j()),nh=e=>{for(let t of e)if((0,hl.toBoolean)(t))return t;return null},ah=nh});var Mo={};m(Mo,{default:()=>ih});var sh,ih,yl=f(()=>{sh=([e,t])=>typeof e!="string"||typeof t!="string"?null:e.startsWith(t),ih=sh});var Uo={};m(Uo,{default:()=>uh});var lh,uh,bl=f(()=>{lh=([e])=>Array.isArray(e)?e.flat():null,uh=lh});var Bo={};m(Bo,{default:()=>dh});var ch,dh,vl=f(()=>{ch=([e,t])=>{let r=isNaN(Number(t))?0:Number(t);return JSON.stringify(e,null,r)},dh=ch});var Vo={};m(Vo,{default:()=>mh});var fh,mh,Fl=f(()=>{fh=([e,t])=>typeof t!="number"||isNaN(t)?null:Array.isArray(e)?e.slice(0,e.length-t):typeof e=="string"?e.substring(0,e.length-t):null,mh=fh});var Ko={};m(Ko,{default:()=>hh});var ph,hh,Al=f(()=>{ph=([e])=>typeof e=="string"?new Date(e):null,hh=ph});var Wo={};m(Wo,{default:()=>yh});var gh,yh,wl=f(()=>{gh=([e])=>typeof e=="object"&&e!==null?Object.entries(e).map(([t,r])=>({key:t,value:r})):null,yh=gh});var zo={};m(zo,{default:()=>vh});var bh,vh,El=f(()=>{bh=([e])=>{if(!Array.isArray(e))return null;let t=new Set;return e.filter(r=>{let o=typeof r=="object"?JSON.stringify(r):r;return t.has(o)?!1:(t.add(o),!0)})},vh=bh});var Go={};m(Go,{default:()=>Ah});var Fh,Ah,Ol=f(()=>{Fh=([e,t,r])=>typeof e!="string"||typeof t!="string"?null:e.replaceAll(t,String(r)),Ah=Fh});var Jo={};m(Jo,{default:()=>Eh});var wh,Eh,jl=f(()=>{wh=([e,t,r])=>typeof e!="number"||typeof t!="number"||typeof r!="number"?null:Math.min(Math.max(e,t),r),Eh=wh});var Xo={};m(Xo,{default:()=>jh});var Oh,jh,xl=f(()=>{Oh=([e])=>typeof e!="string"?null:e.toLocaleLowerCase(),jh=Oh});var Qo={};m(Qo,{default:()=>Ch});function Cl(e){let t=[...e];for(let r=t.length-1;r>0;r--){let o=Math.floor(Math.random()*(r+1));[t[r],t[o]]=[t[o],t[r]]}return t}var xh,Ch,Sl=f(()=>{xh=([e])=>Array.isArray(e)?Cl(e):typeof e=="string"?Cl(e.split("")).join(""):null;Ch=xh});var Yo={};m(Yo,{default:()=>_h});var Sh,_h,_l=f(()=>{Sh=([e])=>!e||!(e instanceof Date)?null:e.getTime(),_h=Sh});var Zo={};m(Zo,{default:()=>Rh});var kl,kh,Rh,Rl=f(()=>{kl=v(j()),kh=([e,t])=>{if(typeof e!="object"||e===null||!Array.isArray(t)&&typeof t!="string"&&typeof t!="number")return null;let r=(n,[a,...s])=>{if(Array.isArray(n)){let i=Number(a);return Number.isNaN(i)?n:s.length===0?n.filter((l,u)=>u!==Number(a)):n.map((l,u)=>u===i?r(n[i],s):l)}return(0,kl.isObject)(n)?s.length===0?Object.fromEntries(Object.entries(n).filter(([i])=>i!==a)):{...n,[a]:r(n[a],s)}:null},o=Array.isArray(t)?t:[t];return r(e,o)},Rh=kh});var tn={};m(tn,{default:()=>Ph});var en,Th,Ph,Tl=f(()=>{en=v(j()),Th=([e,t,r])=>{if(!(0,en.isDefined)(navigator.canShare))return!1;let o=a=>(0,en.isDefined)(a)&&typeof a=="string";if(!o(e)&&!o(t)&&!o(r))return!1;let n={};return o(t)&&(n.title=t),o(r)&&(n.text=r),o(e)&&(n.url=e),navigator.canShare(n)},Ph=Th});var rn={};m(rn,{default:()=>Dh});var Hh,Dh,Pl=f(()=>{Hh=([e,t])=>typeof e!="number"||typeof t!="number"?null:e>t?[]:Array.from({length:t-e+1},(r,o)=>o+e),Dh=Hh});var on={};m(on,{default:()=>$h});var Ih,$h,Hl=f(()=>{Ih=e=>Math.min(...e.map(Number)),$h=Ih});var nn={};m(nn,{default:()=>Lh});var Nh,Lh,Dl=f(()=>{Nh=([e,t])=>{if(typeof e!="number"||typeof t!="number")return null;let r=Math.max(1,Math.pow(10,t));return Math.floor(e*r)/r},Lh=Nh});var an={};m(an,{default:()=>qh,getArgumentInputData:()=>Mh,handler:()=>Il});var Il,qh,Mh,$l=f(()=>{Il=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.findLast((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.entries(e).findLast(([r,o])=>t({key:r,value:o}))?.[1]:null,qh=Il,Mh=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{key:o[0],value:o[1]}}}return r}});var sn={};m(sn,{default:()=>Bh});var Uh,Bh,Nl=f(()=>{Uh=([e])=>typeof e!="string"?null:decodeURIComponent(e),Bh=Uh});var ln={};m(ln,{default:()=>Kh});var Vh,Kh,Ll=f(()=>{Vh=(e,{env:t})=>t.isServer?t.request?.headers["user-agent"]??null:window.navigator.userAgent,Kh=Vh});var un={};m(un,{default:()=>zh});var Wh,zh,ql=f(()=>{Wh=([e])=>{if(Array.isArray(e)){let t=0;for(let r of e){if(isNaN(r)||typeof r!="number")return null;t+=r}return t}return null},zh=Wh});var cn={};m(cn,{default:()=>Jh});var Gh,Jh,Ml=f(()=>{Gh=e=>Math.max(...e.map(Number)),Jh=Gh});var dn={};m(dn,{default:()=>Qh});var Xh,Qh,Ul=f(()=>{Xh=([e,t])=>{let r=Number(e),o=Number(t);return isNaN(r)||isNaN(o)?null:r-o},Qh=Xh});var fn={};m(fn,{default:()=>Zh});var Yh,Zh,Bl=f(()=>{Yh=([e,t,r])=>{if(!e||!(e instanceof Date))return null;let o=typeof t=="string"&&t.length>0||Array.isArray(t)&&t.every(F=>typeof F=="string")?t:void 0;if(!r||typeof r!="object")return Intl.DateTimeFormat(o).format(e);let n=(F,S)=>typeof F=="string"&&(S?.includes(F)??!0)?F:void 0,a=r,s=n(a.dateStyle,["full","long","medium","short"]),i=n(a.timeStyle,["full","long","medium","short"]),l=n(a.calendar),u=n(a.weekday,["long","short","narrow"]),c=n(a.era,["long","short","narrow"]),d=n(a.year,["numeric","2-digit"]),h=n(a.month,["long","short","narrow","numeric","2-digit"]),p=n(a.day,["numeric","2-digit"]),y=n(a.hour,["numeric","2-digit"]),b=n(a.minute,["numeric","2-digit"]),g=n(a.second,["numeric","2-digit"]),A=n(a.timeZoneName,["long","short","shortOffset","longOffset","shortGeneric","longGeneric"]),O=n(a.timeZone),E=a.hour12===!0?!0:a.hour12===!1?!1:void 0;return Intl.DateTimeFormat(o,{dateStyle:s,timeStyle:i,calendar:l,weekday:u,era:c,year:d,month:h,day:p,hour:y,minute:b,second:g,timeZoneName:A,timeZone:O,hour12:E}).format(e)},Zh=Yh});var mn={};m(mn,{default:()=>rg,getArgumentInputData:()=>tg});var eg,tg,rg,Vl=f(()=>{eg=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.map((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.fromEntries(Object.entries(e).map(([r,o])=>{let n=t({key:r,value:o});return"key"in n&&"value"in n?[n.key,n.value]:null})):null,tg=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{key:o[0],value:o[1]}}}return r},rg=eg});var pn={};m(pn,{default:()=>ng});var og,ng,Kl=f(()=>{og=([e])=>{if(Array.isArray(e)){let t={};for(let{key:r,value:o}of e)t[r]=o;return t}return null},ng=og});var hn={};m(hn,{default:()=>sg});var ag,sg,Wl=f(()=>{ag=([e,t])=>typeof e!="string"||typeof t!="string"?null:e.split(t),sg=ag});var gn={};m(gn,{default:()=>lg});var ig,lg,zl=f(()=>{ig=([e,t])=>{if(typeof e=="string")return e[Number(t)];let r=(o,n)=>{if(n.length===0)return o;let[a,...s]=n;return r(o?.[String(a)],s)};return r(e,Array.isArray(t)?t:[t])},lg=ig});var yn={};m(yn,{default:()=>cg});var ug,cg,Gl=f(()=>{ug=([e,t])=>{if(typeof e!="string")return null;try{let{hostname:r,searchParams:o,pathname:n,hash:a,href:s,protocol:i,port:l,origin:u}=new URL(e,typeof t=="string"?t:void 0);return{hostname:r,searchParams:Object.fromEntries(o),path:n.split("/").filter((c,d)=>d!==0||c!==""),hash:a.replace("#",""),href:s,protocol:i,port:l,origin:u}}catch{return null}},cg=ug});var bn={};m(bn,{default:()=>fg});var dg,fg,Jl=f(()=>{dg=([e,t])=>isNaN(Number(e))||isNaN(Number(t))?null:Number(e)/Number(t),fg=dg});var vn={};m(vn,{default:()=>pg});var mg,pg,Xl=f(()=>{mg=([e,t])=>isNaN(Number(e))||isNaN(Number(t))?null:Number(e)%Number(t),pg=mg});var Fn={};m(Fn,{default:()=>hg});var Ql,Yl,hg,Zl=f(()=>{Ql=v(j()),Yl=([e,t,r],o)=>{if(typeof t!="string"&&typeof t!="number"&&!Array.isArray(t))return null;let[n,...a]=Array.isArray(t)?t:[t];if((0,Ql.isObject)(e)){let s=Array.isArray(e)?[...e]:{...e};return s[n]=a.length===0?r:Yl([s[n],a,r],o),s}return null},hg=Yl});var An={};m(An,{default:()=>yg});var gg,yg,eu=f(()=>{gg=([e])=>{if(typeof e!="string"||e.length===0||typeof window>"u")return null;let t=window.localStorage.getItem(e);if(t===null)return t;try{return JSON.parse(t)}catch{return t}},yg=gg});var wn={};m(wn,{default:()=>vg});var bg,vg,tu=f(()=>{bg=([e])=>typeof e=="string"||Array.isArray(e)?e[0]:null,vg=bg});var En={};m(En,{default:()=>Ag});var Fg,Ag,ru=f(()=>{Fg=(e,{env:t})=>t.isServer?t.request.url:window?.location.href??null,Ag=Fg});var On={};m(On,{default:()=>wg,getArgumentInputData:()=>Eg,handler:()=>ou});var ou,wg,Eg,nu=f(()=>{ou=([e,t])=>{if(typeof t!="function"||!e||typeof e!="object")return null;let r=Array.isArray(e)?e:Object.entries(e),o={};for(let n=0;n<r.length;n++){let a=r[n],s=String(t({item:a,i:n}));o[s]=a}return o},wg=ou,Eg=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{value:o[1],key:o[0]}}}return r}});var jn={};m(jn,{default:()=>jg});var Og,jg,au=f(()=>{Og=([e,t])=>Array.isArray(e)?[t,...e]:null,jg=Og});var xn={};m(xn,{default:()=>Cg});var xg,Cg,su=f(()=>{xg=([e])=>{if(typeof e!="string"||e.length===0||typeof window>"u")return null;let t=window.sessionStorage.getItem(e);if(t===null)return t;try{return JSON.parse(t)}catch{return t}},Cg=xg});var Cn={};m(Cn,{default:()=>_g});var Sg,_g,iu=f(()=>{Sg=([e,t])=>Array.isArray(e)?[...e,t]:null,_g=Sg});var Sn={};m(Sn,{default:()=>Rg});var kg,Rg,lu=f(()=>{kg=([e])=>typeof e!="string"?null:atob(e),Rg=kg});var _n={};m(_n,{default:()=>Pg});var Tg,Pg,uu=f(()=>{Tg=(e,{env:t})=>t.isServer?t.request?.headers["accept-language"]?.split(",").map(r=>r.split(";")[0])??[]:window.navigator.languages,Pg=Tg});var kn={};m(kn,{default:()=>Dg});var Hg,Dg,cu=f(()=>{Hg=([e],{env:t,root:r})=>!e||typeof e!="string"?null:t.isServer?t.request.cookies[e]??null:r instanceof ShadowRoot?null:r.cookie.split("; ")?.find(o=>o.startsWith(`${e}=`))?.split("=")[1]??null,Dg=Hg});var Rn={};m(Rn,{default:()=>$g});var Ig,$g,du=f(()=>{Ig=([e,t])=>typeof t!="number"?null:JSON.stringify(e,null,t),$g=Ig});var Tn={};m(Tn,{default:()=>Lg});var Ng,Lg,fu=f(()=>{Ng=([e])=>String(e),Lg=Ng});var Pn={};m(Pn,{default:()=>Mg});var qg,Mg,mu=f(()=>{qg=([e,t])=>typeof t!="number"?null:Array.isArray(e)?e.slice(0,t):typeof e=="string"?e.substring(0,t):null,Mg=qg});var Hn={};m(Hn,{default:()=>Bg});var Ug,Bg,pu=f(()=>{Ug=([e,t])=>isNaN(Number(e))||isNaN(Number(t))?null:Number(e)**Number(t),Bg=Ug});var hu={};m(hu,{absolute:()=>To,add:()=>No,append:()=>Cn,boolean:()=>Br,branchName:()=>Eo,canShare:()=>tn,capitalize:()=>Vr,clamp:()=>Jo,concatenate:()=>mo,currentURL:()=>En,dateFromString:()=>Ko,dateFromTimestamp:()=>Jr,decodeBase64:()=>Sn,decodeURIComponent:()=>sn,defaultTo:()=>qo,deleteKey:()=>Zo,divide:()=>bn,drop:()=>Kr,dropLast:()=>Vo,encodeBase64:()=>no,encodeJSON:()=>Rn,encodeURIComponent:()=>oo,entries:()=>Wo,equals:()=>bo,every:()=>wo,filter:()=>_o,find:()=>ho,findIndex:()=>io,findLast:()=>an,first:()=>wn,flatten:()=>Uo,formatDate:()=>fn,formatNumber:()=>vo,fromEntries:()=>pn,get:()=>gn,getCookie:()=>kn,getElementById:()=>Gr,getFromLocalStorage:()=>An,getFromSessionStorage:()=>xn,getHttpOnlyCookie:()=>Xr,greaterOrEqueal:()=>uo,greaterThan:()=>Po,groupBy:()=>So,includes:()=>Do,indexOf:()=>eo,isServer:()=>$o,join:()=>ro,json:()=>Bo,keyBy:()=>On,languages:()=>_n,last:()=>jo,lastIndexOf:()=>to,lessOrEqual:()=>ko,lessThan:()=>Ao,lowercase:()=>Xo,map:()=>mn,matches:()=>Oo,max:()=>cn,min:()=>on,minus:()=>dn,modulo:()=>vn,multiply:()=>Lo,not:()=>Ho,notEqual:()=>Ro,now:()=>so,number:()=>co,parseJSON:()=>Co,parseURL:()=>yn,power:()=>Hn,prepend:()=>jn,randomNumber:()=>Zr,range:()=>rn,reduce:()=>po,replaceAll:()=>Go,reverse:()=>lo,round:()=>Wr,roundDown:()=>nn,roundUp:()=>Io,set:()=>Fn,shuffle:()=>Qo,size:()=>Qr,some:()=>Fo,sort_by:()=>fo,split:()=>hn,squareRoot:()=>ao,startsWith:()=>Mo,string:()=>Tn,sum:()=>un,take:()=>Pn,takeLast:()=>go,timestamp:()=>Yo,trim:()=>zr,typeOf:()=>yo,unique:()=>zo,uppercase:()=>Yr,userAgent:()=>ln});var gu=f(()=>{li();ui();ci();di();fi();mi();pi();gi();bi();vi();Fi();Ai();wi();Ei();Oi();ji();xi();Ci();_i();ki();Ri();Ti();Pi();Di();Ii();Ni();Li();qi();Mi();Ui();Vi();Ki();zi();Gi();Ji();Xi();Zi();tl();ol();nl();al();sl();il();ul();cl();dl();fl();ml();pl();gl();yl();bl();vl();Fl();Al();wl();El();Ol();jl();xl();Sl();_l();Rl();Tl();Pl();Hl();Dl();$l();Nl();Ll();ql();Ml();Ul();Bl();Vl();Kl();Wl();zl();Gl();Jl();Xl();Zl();eu();tu();ru();nu();au();su();iu();lu();uu();cu();du();fu();mu();pu()});var Kt=w(M=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0});M.getPathSegments=M.get404Page=M.getRouteDestination=M.matchRoutes=M.matchRouteForUrl=M.matchPageForUrl=void 0;var Vg=Me(),Kg=j(),yu=Dn(),Wg=({url:e,components:t})=>(0,M.matchRoutes)({url:e,entries:bu(t),getRoute:r=>r.route});M.matchPageForUrl=Wg;var zg=({url:e,routes:t})=>(0,M.matchRoutes)({url:e,entries:Object.values(t??{}),getRoute:r=>r.source});M.matchRouteForUrl=zg;var Gg=({url:e,entries:t,getRoute:r})=>{let o=(0,M.getPathSegments)(e);return Object.values(t).filter(a=>{let s=r(a);return o.length<=s.path.length&&s.path.every((i,l)=>i.type==="param"||i.optional===!0||i.name===o[l])}).sort((a,s)=>{let i=r(a),l=r(s),u=i.path.length-l.path.length;if(u!==0)return u;for(let c=0;c<o.length;c++){let d=i.path[c].type==="static"?1:0,h=l.path[c].type==="static"?1:0;if(d!==h)return h-d}return 0})[0]};M.matchRoutes=Gg;var Jg=({files:e,req:t,route:r})=>{try{let o=new URL(t.url),{searchParamsWithDefaults:n,pathParams:a}=(0,yu.getParameters)({route:r.source,req:t}),s=(0,Vg.getUrl)(r.destination,{data:{"Route parameters":{path:a,query:n}},toddle:(0,yu.getServerToddleObject)(e)},r.type==="redirect"?o.origin:void 0);return r.type==="redirect"&&o.origin===s.origin&&o.pathname===s.pathname||r.type==="rewrite"&&o.origin===s.origin?void 0:s}catch{}};M.getRouteDestination=Jg;var Xg=e=>bu(e).find(t=>t.name==="404");M.get404Page=Xg;var bu=e=>Object.values(e).filter(t=>(0,Kg.isDefined)(t.route)),Qg=e=>e.pathname.substring(1).split("/").filter(t=>t!=="").map(t=>decodeURIComponent(t));M.getPathSegments=Qg});var vu=w(ie=>{"use strict";var Yg=ie&&ie.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ie,"__esModule",{value:!0});ie.escapeSearchParameters=ie.escapeSearchParameter=void 0;var Zg=j(),ey=Yg(Rt()),ty=e=>typeof e=="string"?(0,ey.default)(e):null;ie.escapeSearchParameter=ty;var ry=e=>new URLSearchParams([...e.entries()].reduce((t,[r,o])=>{let n=(0,ie.escapeSearchParameter)(o);return(0,Zg.isDefined)(n)&&(t[r]=n),t},{}));ie.escapeSearchParameters=ry});var Dn=w(H=>{"use strict";var oy=H&&H.__createBinding||(Object.create?function(e,t,r,o){o===void 0&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){o===void 0&&(o=r),e[o]=t[r]}),ny=H&&H.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ay=H&&H.__importStar||function(){var e=function(t){return e=Object.getOwnPropertyNames||function(r){var o=[];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(o[o.length]=n);return o},e(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(t!=null)for(var o=e(t),n=0;n<o.length;n++)o[n]!=="default"&&oy(r,t,o[n]);return ny(r,t),r}}();Object.defineProperty(H,"__esModule",{value:!0});H.serverEnv=H.getParameters=H.getDataUrlParameters=H.getServerToddleObject=H.getPageFormulaContext=void 0;var sy=V(),iy=Le(),ly=Y(),Fu=j(),uy=ay((gu(),Xu(hu))),cy=Kt(),dy=vr(),fy=vu(),my=({branchName:e,component:t,req:r,logErrors:o,files:n})=>{let a=(0,H.serverEnv)({req:r,branchName:e,logErrors:o}),{searchParamsWithDefaults:s,hash:i,combinedParams:l,url:u}=(0,H.getParameters)({route:t.route,req:r}),c={data:{Location:{page:t.page??"",path:u.pathname,params:l,query:s,hash:i},Attributes:l,"URL parameters":(0,H.getDataUrlParameters)({route:t.route,req:r}),Apis:{}},component:t,root:null,package:void 0,env:a,toddle:(0,H.getServerToddleObject)(n)};return c.data.Variables=(0,ly.mapValues)(t.variables,({initialValue:d})=>(0,sy.applyFormula)(d,c)),c};H.getPageFormulaContext=my;var py=e=>{let t=Object.fromEntries(Object.entries(uy).map(([r,o])=>["@toddle/"+r,o.default]));return{getFormula:r=>t[r],getCustomFormula:(r,o)=>{let n;if((0,Fu.isDefined)(o)?n=e.packages?.[o]?.formulas?.[r]:n=e.formulas?.[r],n&&(0,iy.isToddleFormula)(n))return n},errors:[]}};H.getServerToddleObject=py;var hy=({route:e,req:t})=>{let{searchParamsWithDefaults:r,combinedParams:o}=(0,H.getParameters)({route:e,req:t});return{...r,...o}};H.getDataUrlParameters=hy;var gy=({route:e,req:t})=>{let r=new URL(t.url),o=[...(0,fy.escapeSearchParameters)(r.searchParams).entries()].reduce((i,[l,u])=>({...i,[l]:u??null}),{}),n=(0,cy.getPathSegments)(r),a=e?.path.reduce((i,l,u)=>l.type==="param"?(0,Fu.isDefined)(n[u])&&typeof n[u]=="string"?{...i,[l.name]:n[u]}:{...i,[l.name]:null}:i,{}),s=Object.keys(e?.query??{}).reduce((i,l)=>({...i,[l]:null}),{});return{pathParams:a,searchParamsWithDefaults:{...s,...o},combinedParams:{...o,...a},hash:r.hash.slice(1),url:r}};H.getParameters=gy;var yy=({branchName:e,req:t,logErrors:r})=>({branchName:e,isServer:!0,request:{headers:Object.fromEntries(t.headers.entries()),cookies:(0,dy.getRequestCookies)(t),url:t.url},logErrors:r});H.serverEnv=yy});var wu=w(Wt=>{"use strict";Object.defineProperty(Wt,"__esModule",{value:!0});Wt.HeadTagTypes=void 0;var Au;(function(e){e.Meta="meta",e.Link="link",e.Script="script",e.NoScript="noscript",e.Style="style"})(Au||(Wt.HeadTagTypes=Au={}))});var Eu=w(Pe=>{"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.transformRelativePaths=Pe.isCloudflareImagePath=void 0;var by=e=>typeof e=="string"&&e.startsWith("/cdn-cgi/imagedelivery/");Pe.isCloudflareImagePath=by;var vy=e=>t=>({...t,nodes:Object.entries(t.nodes).reduce((r,[o,n])=>({...r,[o]:{...n,...n.type==="element"?{attrs:Object.entries(n.attrs).reduce((a,[s,i])=>["src"].includes(s)&&i?.type==="value"&&typeof i.value=="string"?{...a,[s]:{...i,value:new URL(i.value,e).href}}:{...a,[s]:i},{})}:{}}}),{})});Pe.transformRelativePaths=vy});var Ou=w(zt=>{"use strict";Object.defineProperty(zt,"__esModule",{value:!0});zt.nanoid=void 0;var Fy="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Ay=(e=21)=>{let t="",r=e|0;for(;r--;)t+=Fy[Math.random()*64|0];return t};zt.nanoid=Ay});var ju=w(Gt=>{"use strict";Object.defineProperty(Gt,"__esModule",{value:!0});Gt.getFontCssUrl=void 0;var wy=Y(),Ey=({fonts:e,baseForAbsoluteUrls:t,basePath:r="/.toddle/fonts/stylesheet/css2"})=>{if(e.length===0)return;let o=new URLSearchParams;o.set("display","swap");for(let a of e){let s=(0,wy.easySort)(a.variants.filter(p=>!Number.isNaN(Number(p.weight))),p=>Number(p.weight));if(s.length===0)continue;let i=s.filter(p=>p.italic),l=s.filter(p=>!p.italic),u=(p,y)=>p.map(b=>`${typeof y=="number"?`${y},`:""}${b.weight}`).join(";"),c=i.length>0,d=[l,i].map((p,y)=>u(p,c?y:void 0)).filter(Boolean).join(";"),h=a.family;c?h+=`:ital,wght@${d}`:h+=`:wght@${d}`,o.append("family",h)}let n=`${r}?${o.toString()}`;try{return{swap:typeof t=="string"?new URL(n,t).toString():n}}catch{}};Gt.getFontCssUrl=Ey});var In=w(He=>{"use strict";Object.defineProperty(He,"__esModule",{value:!0});He.getCharset=He.getHtmlLanguage=void 0;var xu=V(),Oy=({pageInfo:e,formulaContext:t,defaultLanguage:r="en"})=>{let o=e?.language?(0,xu.applyFormula)(e.language.formula,t):r;return typeof o=="string"?o:r};He.getHtmlLanguage=Oy;var jy=({pageInfo:e,formulaContext:t,defaultCharset:r="utf-8"})=>{let o=e?.charset?(0,xu.applyFormula)(e.charset.formula,t):r;return typeof o=="string"?o:r};He.getCharset=jy});var Cu=w(Jt=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});Jt.defaultSpeculationRules=void 0;Jt.defaultSpeculationRules={prerender:[{source:"document",where:{selector_matches:'[data-prerender="eager"]'},eagerness:"eager"},{source:"document",where:{selector_matches:'[data-prerender="moderate"]'},eagerness:"moderate"}]}});var ku=w(le=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});le.defaultHeadOrdering=le.renderHeadItems=le.getHeadItems=void 0;var xy=wu(),Ae=V(),Cy=Y(),Sy=te(),Ge=j(),_y=qr(),U=Ur(),Su=Eu(),ky=Ou(),Ry=ju(),Ty=In(),Py=Cu(),Hy=({cacheBuster:e,context:t,cssBasePath:r="/.toddle/fonts/stylesheet/css2",files:o,page:n,project:a,theme:s,url:i})=>{let l=n.route?.info,u=Iy({component:n,context:t,defaultTitle:a.name}),c=$y({component:n,context:t,defaultDescription:a.description}),d=[];if(!("breakpoints"in s)&&s.fonts.length>0){let E=(0,Ry.getFontCssUrl)({fonts:s.fonts,basePath:r});E&&d.push(["link:font:swap",`<link href="${(0,U.escapeAttrValue)(E.swap.toString())}" rel="stylesheet" />`])}let h=_u("/_static/reset.css",e),p=(0,Ty.getCharset)({pageInfo:l,formulaContext:t}),y=[];typeof c=="string"&&(y.push(["meta:description",`<meta name="description" content="${(0,U.escapeAttrValue)(c)}" />`]),y.push(["meta:og:description",`<meta property="og:description" content="${(0,U.escapeAttrValue)(c)}" />`]));let b=new Map([["link:reset",`<link rel="stylesheet" fetchpriority="high" href="${(0,U.escapeAttrValue)(h)}" />`],...d,["meta:charset",`<meta charset="${(0,U.escapeAttrValue)(p)}" />`],["meta:viewport",'<meta name="viewport" content="width=device-width, initial-scale=1" />'],["title",`<title>${u}</title>`],["meta:og:title",`<meta property="og:title" content="${(0,U.escapeAttrValue)(u)}" />`],["meta:apple-mobile-web-app-title",`<meta name="apple-mobile-web-app-title" content="${(0,U.escapeAttrValue)(u)}">`],...y,["meta:og:type",'<meta property="og:type" content="website" />'],["meta:og:url",`<meta property="og:url" content="${(0,U.escapeAttrValue)(i.href)}" />`],["meta:application-name",`<meta name="application-name" content="${a.short_id==="toddle"?"toddle":(0,U.escapeAttrValue)(a.name)}">`],["script:speculationrules",`<script type="speculationrules">${JSON.stringify(Py.defaultSpeculationRules)}</script>`]]);if(a.type==="package"&&a.thumbnail){let E=(0,Su.isCloudflareImagePath)(a.thumbnail.path)?`${i.origin}${a.thumbnail.path}/256`:a.thumbnail.path;b.set("meta:og:image",`<meta property="og:image" content="${(0,U.escapeAttrValue)(`${E}`)}" />`)}if((0,Sy.validateUrl)((0,Ae.applyFormula)(o.config?.meta?.manifest?.formula,t))){let E=_u("/manifest.json",e);b.set("link:manifest",`<link rel="manifest" href="${(0,U.escapeAttrValue)(E)}">`)}else b.set("meta:theme-color",'<meta name="theme-color" content="#171717">'),b.set("meta:msapplication-tilecolor",'<meta name="msapplication-TileColor" content="#171717">');let A=E=>Object.values(l?.meta??{}).some(F=>Object.entries(F.attrs??{}).some(([S,D])=>["name","property"].includes(S.toLowerCase())&&D.type==="value"&&typeof D.value=="string"&&D.value.toLowerCase()===E.toLowerCase())),O=o.config?.meta?.icon;if((0,Ge.isDefined)(O)){let E=(0,Ae.applyFormula)(O.formula,t);if((0,Ge.isDefined)(E)&&typeof E=="string")if((0,Su.isCloudflareImagePath)(E)){let F=E.split("/").slice(0,-1).join("/");b.set("link:icon:16",`<link rel="icon" sizes="16x16" href="${(0,U.escapeAttrValue)(`${F}/16`)}" />`),b.set("link:icon:32",`<link rel="icon" sizes="32x32" href="${(0,U.escapeAttrValue)(`${F}/32`)}" />`),b.set("link:icon",`<link rel="shortcut icon" href="${(0,U.escapeAttrValue)(`${F}/48`)}" />`)}else b.set("link:icon",`<link rel="icon" href="${(0,U.escapeAttrValue)(E)}" />`)}else["link:icon","link:mask-icon","link:apple-touch-icon","link:icon:16","link:icon:32"].every(E=>!A(E))||(a.emoji&&b.set("link:icon",`<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>${(0,U.escapeAttrValue)(a.emoji)}</text></svg>">`),b.set("link:mask-icon",'<link rel="mask-icon" href="https://raw.githubusercontent.com/toddledev/resources/main/icons/safari-pinned-tab.svg" color="#171717">'),b.set("link:apple-touch-icon",'<link rel="apple-touch-icon" sizes="180x180" href="https://raw.githubusercontent.com/toddledev/resources/main/icons/apple-touch-icon.png">'),b.set("link:icon:16",'<link rel="icon" type="image/png" sizes="16x16" href="https://raw.githubusercontent.com/toddledev/resources/main/icons/favicon-16x16.png">'),b.set("link:icon:32",'<link rel="icon" type="image/png" sizes="32x32" href="https://raw.githubusercontent.com/toddledev/resources/main/icons/favicon-32x32.png">'));return l?.meta&&Object.entries(l.meta).forEach(([E,F])=>{if(Object.values(xy.HeadTagTypes).includes(F.tag)){let S=Object.entries(F.attrs??{}).find(([_])=>_==="name"||_==="property"),D=`${F.tag}:${(0,Ge.isDefined)(S)?(0,Ae.applyFormula)(S[1],t):E??(0,ky.nanoid)()}`;b.set(D,`<${F.tag} data-toddle-id="${E}" ${Object.entries(F.attrs??{}).map(([_,T])=>{let k=(0,Ae.applyFormula)(T,t);return k===!0?_:`${_}="${(0,U.escapeAttrValue)(k)}"`}).join(" ")} ${_y.VOID_HTML_ELEMENTS.includes(F.tag)?"/>":`>${F.content?(0,Ae.applyFormula)(F.content,t):""}</${F.tag}>`}`)}}),b};le.getHeadItems=Hy;var Dy=({headItems:e,ordering:t=le.defaultHeadOrdering})=>(0,Cy.easySort)([...e.entries()],([r])=>{let o=t.indexOf(r);return o===-1?t.length:o}).map(([r,o])=>o).join(`
    `);le.renderHeadItems=Dy;le.defaultHeadOrdering=["meta:charset","meta:viewport","title","meta:description","link:icon:16","link:icon:32","link:icon","meta:og:title","meta:application-name","meta:og:url","meta:og:description","meta:og:type","link:manifest","link:mask-icon","link:apple-touch-icon","meta:theme-color","meta:apple-mobile-web-app-title","meta:msapplication-tilecolor","meta:og:locale","link:reset"];var Iy=({component:e,context:t,defaultTitle:r})=>{let o=e.route?.info,n=r??e.name;if(!(0,Ge.isDefined)(o?.title))return n;let a=(0,Ae.applyFormula)(o.title.formula,t);return typeof a=="string"?a:n},$y=({component:e,context:t,defaultDescription:r})=>{let o=e.route?.info;if(!(0,Ge.isDefined)(o?.description))return r;let n=(0,Ae.applyFormula)(o.description.formula,t);return typeof n=="string"?n:r},_u=(e,t)=>typeof t=="string"?`${e}?${new URLSearchParams([["v",t]]).toString()}`:e});var Bu=v(Un());var Bn=async(e,t=Object.create(null))=>{let{all:r=!1,dot:o=!1}=t,a=(e instanceof Xe?e.raw.headers:e.headers).get("Content-Type");return a?.startsWith("multipart/form-data")||a?.startsWith("application/x-www-form-urlencoded")?ec(e,{all:r,dot:o}):{}};async function ec(e,t){let r=await e.formData();return r?tc(r,t):{}}function tc(e,t){let r=Object.create(null);return e.forEach((o,n)=>{t.all||n.endsWith("[]")?rc(r,n,o):r[n]=o}),t.dot&&Object.entries(r).forEach(([o,n])=>{o.includes(".")&&(oc(r,o,n),delete r[o])}),r}var rc=(e,t,r)=>{e[t]!==void 0?Array.isArray(e[t])?e[t].push(r):e[t]=[e[t],r]:e[t]=r},oc=(e,t,r)=>{let o=e,n=t.split(".");n.forEach((a,s)=>{s===n.length-1?o[a]=r:((!o[a]||typeof o[a]!="object"||Array.isArray(o[a])||o[a]instanceof File)&&(o[a]=Object.create(null)),o=o[a])})};var er=e=>{let t=e.split("/");return t[0]===""&&t.shift(),t},Vn=e=>{let{groups:t,path:r}=nc(e),o=er(r);return ac(o,t)},nc=e=>{let t=[];return e=e.replace(/\{[^}]+\}/g,(r,o)=>{let n=`@${o}`;return t.push([n,r]),n}),{groups:t,path:e}},ac=(e,t)=>{for(let r=t.length-1;r>=0;r--){let[o]=t[r];for(let n=e.length-1;n>=0;n--)if(e[n].includes(o)){e[n]=e[n].replace(o,t[r][1]);break}}return e},Qe={},tr=e=>{if(e==="*")return"*";let t=e.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);return t?(Qe[e]||(t[2]?Qe[e]=[e,t[1],new RegExp("^"+t[2]+"$")]:Qe[e]=[e,t[1],!0]),Qe[e]):null},rr=(e,t)=>{try{return t(e)}catch{return e.replace(/(?:%[0-9A-Fa-f]{2})+/g,r=>{try{return t(r)}catch{return r}})}},sc=e=>rr(e,decodeURI),or=e=>{let t=e.url,r=t.indexOf("/",8),o=r;for(;o<t.length;o++){let n=t.charCodeAt(o);if(n===37){let a=t.indexOf("?",o),s=t.slice(r,a===-1?void 0:a);return sc(s.includes("%25")?s.replace(/%25/g,"%2525"):s)}else if(n===63)break}return t.slice(r,o)};var Kn=e=>{let t=or(e);return t.length>1&&t[t.length-1]==="/"?t.slice(0,-1):t},Oe=(...e)=>{let t="",r=!1;for(let o of e)t[t.length-1]==="/"&&(t=t.slice(0,-1),r=!0),o[0]!=="/"&&(o=`/${o}`),o==="/"&&r?t=`${t}/`:o!=="/"&&(t=`${t}${o}`),o==="/"&&t===""&&(t="/");return t},Ye=e=>{if(!e.match(/\:.+\?$/))return null;let t=e.split("/"),r=[],o="";return t.forEach(n=>{if(n!==""&&!/\:/.test(n))o+="/"+n;else if(/\:/.test(n))if(/\?/.test(n)){r.length===0&&o===""?r.push("/"):r.push(o);let a=n.replace("?","");o+="/"+a,r.push(o)}else o+="/"+n}),r.filter((n,a,s)=>s.indexOf(n)===a)},Zt=e=>/[%+]/.test(e)?(e.indexOf("+")!==-1&&(e=e.replace(/\+/g," ")),e.indexOf("%")!==-1?nr(e):e):e,Wn=(e,t,r)=>{let o;if(!r&&t&&!/[%+]/.test(t)){let s=e.indexOf(`?${t}`,8);for(s===-1&&(s=e.indexOf(`&${t}`,8));s!==-1;){let i=e.charCodeAt(s+t.length+1);if(i===61){let l=s+t.length+2,u=e.indexOf("&",l);return Zt(e.slice(l,u===-1?void 0:u))}else if(i==38||isNaN(i))return"";s=e.indexOf(`&${t}`,s+1)}if(o=/[%+]/.test(e),!o)return}let n={};o??=/[%+]/.test(e);let a=e.indexOf("?",8);for(;a!==-1;){let s=e.indexOf("&",a+1),i=e.indexOf("=",a);i>s&&s!==-1&&(i=-1);let l=e.slice(a+1,i===-1?s===-1?void 0:s:i);if(o&&(l=Zt(l)),a=s,l==="")continue;let u;i===-1?u="":(u=e.slice(i+1,s===-1?void 0:s),o&&(u=Zt(u))),r?(n[l]&&Array.isArray(n[l])||(n[l]=[]),n[l].push(u)):n[l]??=u}return t?n[t]:n},zn=Wn,Gn=(e,t)=>Wn(e,t,!0),nr=decodeURIComponent;var Jn=e=>rr(e,nr),Xe=class{raw;#t;#e;routeIndex=0;path;bodyCache={};constructor(e,t="/",r=[[]]){this.raw=e,this.path=t,this.#e=r,this.#t={}}param(e){return e?this.#o(e):this.#s()}#o(e){let t=this.#e[0][this.routeIndex][1][e],r=this.#n(t);return r?/\%/.test(r)?Jn(r):r:void 0}#s(){let e={},t=Object.keys(this.#e[0][this.routeIndex][1]);for(let r of t){let o=this.#n(this.#e[0][this.routeIndex][1][r]);o&&typeof o=="string"&&(e[r]=/\%/.test(o)?Jn(o):o)}return e}#n(e){return this.#e[1]?this.#e[1][e]:e}query(e){return zn(this.url,e)}queries(e){return Gn(this.url,e)}header(e){if(e)return this.raw.headers.get(e.toLowerCase())??void 0;let t={};return this.raw.headers.forEach((r,o)=>{t[o]=r}),t}async parseBody(e){return this.bodyCache.parsedBody??=await Bn(this,e)}#r=e=>{let{bodyCache:t,raw:r}=this,o=t[e];if(o)return o;let n=Object.keys(t)[0];return n?t[n].then(a=>(n==="json"&&(a=JSON.stringify(a)),new Response(a)[e]())):t[e]=r[e]()};json(){return this.#r("json")}text(){return this.#r("text")}arrayBuffer(){return this.#r("arrayBuffer")}blob(){return this.#r("blob")}formData(){return this.#r("formData")}addValidatedData(e,t){this.#t[e]=t}valid(e){return this.#t[e]}get url(){return this.raw.url}get method(){return this.raw.method}get matchedRoutes(){return this.#e[0].map(([[,e]])=>e)}get routePath(){return this.#e[0].map(([[,e]])=>e)[this.routeIndex].path}};var Ze={Stringify:1,BeforeStream:2,Stream:3},Q=(e,t)=>{let r=new String(e);return r.isEscaped=!0,r.callbacks=t,r},ic=/[&<>'"]/,Xn=async(e,t)=>{let r="";t||=[];let o=await Promise.all(e);for(let n=o.length-1;r+=o[n],n--,!(n<0);n--){let a=o[n];typeof a=="object"&&t.push(...a.callbacks||[]);let s=a.isEscaped;if(a=await(typeof a=="object"?a.toString():a),typeof a=="object"&&t.push(...a.callbacks||[]),a.isEscaped??s)r+=a;else{let i=[r];et(a,i),r=i[0]}}return Q(r,t)},et=(e,t)=>{let r=e.search(ic);if(r===-1){t[0]+=e;return}let o,n,a=0;for(n=r;n<e.length;n++){switch(e.charCodeAt(n)){case 34:o="&quot;";break;case 39:o="&#39;";break;case 38:o="&amp;";break;case 60:o="&lt;";break;case 62:o="&gt;";break;default:continue}t[0]+=e.substring(a,n)+o,a=n+1}t[0]+=e.substring(a,n)},Qn=e=>{let t=e.callbacks;if(!t?.length)return e;let r=[e],o={};return t.forEach(n=>n({phase:Ze.Stringify,buffer:r,context:o})),r[0]},tt=async(e,t,r,o,n)=>{typeof e=="object"&&!(e instanceof String)&&(e instanceof Promise||(e=e.toString()),e instanceof Promise&&(e=await e));let a=e.callbacks;if(!a?.length)return Promise.resolve(e);n?n[0]+=e:n=[e];let s=Promise.all(a.map(i=>i({phase:t,buffer:n,context:o}))).then(i=>Promise.all(i.filter(Boolean).map(l=>tt(l,t,!1,o,n))).then(()=>n[0]));return r?Q(await s,a):s};var Yn="text/plain; charset=UTF-8",ar=(e,t={})=>{for(let r of Object.keys(t))e.set(r,t[r]);return e},rt=class{#t;#e;env={};#o;finalized=!1;error;#s=200;#n;#r;#a;#l;#u=!0;#f;#c;#d;#m;#p;constructor(e,t){this.#t=e,t&&(this.#n=t.executionCtx,this.env=t.env,this.#d=t.notFoundHandler,this.#p=t.path,this.#m=t.matchResult)}get req(){return this.#e??=new Xe(this.#t,this.#p,this.#m),this.#e}get event(){if(this.#n&&"respondWith"in this.#n)return this.#n;throw Error("This context has no FetchEvent")}get executionCtx(){if(this.#n)return this.#n;throw Error("This context has no ExecutionContext")}get res(){return this.#u=!1,this.#l||=new Response("404 Not Found",{status:404})}set res(e){if(this.#u=!1,this.#l&&e)try{for(let[t,r]of this.#l.headers.entries())if(t!=="content-type")if(t==="set-cookie"){let o=this.#l.headers.getSetCookie();e.headers.delete("set-cookie");for(let n of o)e.headers.append("set-cookie",n)}else e.headers.set(t,r)}catch(t){if(t instanceof TypeError&&t.message.includes("immutable")){this.res=new Response(e.body,{headers:e.headers,status:e.status});return}else throw t}this.#l=e,this.finalized=!0}render=(...e)=>(this.#c??=t=>this.html(t),this.#c(...e));setLayout=e=>this.#f=e;getLayout=()=>this.#f;setRenderer=e=>{this.#c=e};header=(e,t,r)=>{if(t===void 0){this.#r?this.#r.delete(e):this.#a&&delete this.#a[e.toLocaleLowerCase()],this.finalized&&this.res.headers.delete(e);return}r?.append?(this.#r||(this.#u=!1,this.#r=new Headers(this.#a),this.#a={}),this.#r.append(e,t)):this.#r?this.#r.set(e,t):(this.#a??={},this.#a[e.toLowerCase()]=t),this.finalized&&(r?.append?this.res.headers.append(e,t):this.res.headers.set(e,t))};status=e=>{this.#u=!1,this.#s=e};set=(e,t)=>{this.#o??=new Map,this.#o.set(e,t)};get=e=>this.#o?this.#o.get(e):void 0;get var(){return this.#o?Object.fromEntries(this.#o):{}}#i(e,t,r){if(this.#u&&!r&&!t&&this.#s===200)return new Response(e,{headers:this.#a});if(t&&typeof t!="number"){let n=new Headers(t.headers);this.#r&&this.#r.forEach((s,i)=>{i==="set-cookie"?n.append(i,s):n.set(i,s)});let a=ar(n,this.#a);return new Response(e,{headers:a,status:t.status??this.#s})}let o=typeof t=="number"?t:this.#s;this.#a??={},this.#r??=new Headers,ar(this.#r,this.#a),this.#l&&(this.#l.headers.forEach((n,a)=>{a==="set-cookie"?this.#r?.append(a,n):this.#r?.set(a,n)}),ar(this.#r,this.#a)),r??={};for(let[n,a]of Object.entries(r))if(typeof a=="string")this.#r.set(n,a);else{this.#r.delete(n);for(let s of a)this.#r.append(n,s)}return new Response(e,{status:o,headers:this.#r})}newResponse=(...e)=>this.#i(...e);body=(e,t,r)=>typeof t=="number"?this.#i(e,t,r):this.#i(e,t);text=(e,t,r)=>{if(!this.#a){if(this.#u&&!r&&!t)return new Response(e);this.#a={}}return this.#a["content-type"]=Yn,typeof t=="number"?this.#i(e,t,r):this.#i(e,t)};json=(e,t,r)=>{let o=JSON.stringify(e);return this.#a??={},this.#a["content-type"]="application/json; charset=UTF-8",typeof t=="number"?this.#i(o,t,r):this.#i(o,t)};html=(e,t,r)=>(this.#a??={},this.#a["content-type"]="text/html; charset=UTF-8",typeof e=="object"?tt(e,Ze.Stringify,!1,{}).then(o=>typeof t=="number"?this.#i(o,t,r):this.#i(o,t)):typeof t=="number"?this.#i(e,t,r):this.#i(e,t));redirect=(e,t)=>(this.#r??=new Headers,this.#r.set("Location",String(e)),this.newResponse(null,t??302));notFound=()=>(this.#d??=()=>new Response,this.#d(this))};var sr=(e,t,r)=>(o,n)=>{let a=-1,s=o instanceof rt;return i(0);async function i(l){if(l<=a)throw new Error("next() called multiple times");a=l;let u,c=!1,d;if(e[l]?(d=e[l][0][0],s&&(o.req.routeIndex=l)):d=l===e.length&&n||void 0,!d)s&&o.finalized===!1&&r&&(u=await r(o));else try{u=await d(o,()=>i(l+1))}catch(h){if(h instanceof Error&&s&&t)o.error=h,u=await t(h,o),c=!0;else throw h}return u&&(o.finalized===!1||c)&&(o.res=u),o}};var I="ALL",Zn="all",ea=["get","post","put","delete","options","patch"],ot="Can not add a route since the matcher is already built.",nt=class extends Error{};var lc=Symbol("composedHandler"),uc=e=>e.text("404 Not Found",404),ta=(e,t)=>"getResponse"in e?e.getResponse():t.text("Internal Server Error",500),ir=class{get;post;put;delete;options;patch;all;on;use;router;getPath;_basePath="/";#t="/";routes=[];constructor(e={}){[...ea,Zn].forEach(o=>{this[o]=(n,...a)=>(typeof n=="string"?this.#t=n:this.#n(o,this.#t,n),a.forEach(s=>{this.#n(o,this.#t,s)}),this)}),this.on=(o,n,...a)=>{for(let s of[n].flat()){this.#t=s;for(let i of[o].flat())a.map(l=>{this.#n(i.toUpperCase(),this.#t,l)})}return this},this.use=(o,...n)=>(typeof o=="string"?this.#t=o:(this.#t="*",n.unshift(o)),n.forEach(a=>{this.#n(I,this.#t,a)}),this);let r=e.strict??!0;delete e.strict,Object.assign(this,e),this.getPath=r?e.getPath??or:Kn}#e(){let e=new ir({router:this.router,getPath:this.getPath});return e.routes=this.routes,e}#o=uc;#s=ta;route(e,t){let r=this.basePath(e);return t.routes.map(o=>{let n;t.#s===ta?n=o.handler:(n=async(a,s)=>(await sr([],t.#s)(a,()=>o.handler(a,s))).res,n[lc]=o.handler),r.#n(o.method,o.path,n)}),this}basePath(e){let t=this.#e();return t._basePath=Oe(this._basePath,e),t}onError=e=>(this.#s=e,this);notFound=e=>(this.#o=e,this);mount(e,t,r){let o,n;r&&(typeof r=="function"?n=r:(n=r.optionHandler,o=r.replaceRequest));let a=n?i=>{let l=n(i);return Array.isArray(l)?l:[l]}:i=>{let l;try{l=i.executionCtx}catch{}return[i.env,l]};o||=(()=>{let i=Oe(this._basePath,e),l=i==="/"?0:i.length;return u=>{let c=new URL(u.url);return c.pathname=c.pathname.slice(l)||"/",new Request(c,u)}})();let s=async(i,l)=>{let u=await t(o(i.req.raw),...a(i));if(u)return u;await l()};return this.#n(I,Oe(e,"*"),s),this}#n(e,t,r){e=e.toUpperCase(),t=Oe(this._basePath,t);let o={path:t,method:e,handler:r};this.router.add(e,t,[r,o]),this.routes.push(o)}#r(e,t){if(e instanceof Error)return this.#s(e,t);throw e}#a(e,t,r,o){if(o==="HEAD")return(async()=>new Response(null,await this.#a(e,t,r,"GET")))();let n=this.getPath(e,{env:r}),a=this.router.match(o,n),s=new rt(e,{path:n,matchResult:a,env:r,executionCtx:t,notFoundHandler:this.#o});if(a[0].length===1){let l;try{l=a[0][0][0][0](s,async()=>{s.res=await this.#o(s)})}catch(u){return this.#r(u,s)}return l instanceof Promise?l.then(u=>u||(s.finalized?s.res:this.#o(s))).catch(u=>this.#r(u,s)):l??this.#o(s)}let i=sr(a[0],this.#s,this.#o);return(async()=>{try{let l=await i(s);if(!l.finalized)throw new Error("Context is not finalized. Did you forget to return a Response object or `await next()`?");return l.res}catch(l){return this.#r(l,s)}})()}fetch=(e,...t)=>this.#a(e,t[1],t[0],e.method);request=(e,t,r,o)=>e instanceof Request?this.fetch(t?new Request(e,t):e,r,o):(e=e.toString(),this.fetch(new Request(/^https?:\/\//.test(e)?e:`http://localhost${Oe("/",e)}`,t),r,o));fire=()=>{addEventListener("fetch",e=>{e.respondWith(this.#a(e.request,e,void 0,e.request.method))})}};var at="[^/]+",$e=".*",Ne="(?:|/.*)",je=Symbol(),cc=new Set(".\\+*[^]$()");function dc(e,t){return e.length===1?t.length===1?e<t?-1:1:-1:t.length===1||e===$e||e===Ne?1:t===$e||t===Ne?-1:e===at?1:t===at?-1:e.length===t.length?e<t?-1:1:t.length-e.length}var st=class{#t;#e;#o=Object.create(null);insert(e,t,r,o,n){if(e.length===0){if(this.#t!==void 0)throw je;if(n)return;this.#t=t;return}let[a,...s]=e,i=a==="*"?s.length===0?["","",$e]:["","",at]:a==="/*"?["","",Ne]:a.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/),l;if(i){let u=i[1],c=i[2]||at;if(u&&i[2]&&(c=c.replace(/^\((?!\?:)(?=[^)]+\)$)/,"(?:"),/\((?!\?:)/.test(c)))throw je;if(l=this.#o[c],!l){if(Object.keys(this.#o).some(d=>d!==$e&&d!==Ne))throw je;if(n)return;l=this.#o[c]=new st,u!==""&&(l.#e=o.varIndex++)}!n&&u!==""&&r.push([u,l.#e])}else if(l=this.#o[a],!l){if(Object.keys(this.#o).some(u=>u.length>1&&u!==$e&&u!==Ne))throw je;if(n)return;l=this.#o[a]=new st}l.insert(s,t,r,o,n)}buildRegExpStr(){let t=Object.keys(this.#o).sort(dc).map(r=>{let o=this.#o[r];return(typeof o.#e=="number"?`(${r})@${o.#e}`:cc.has(r)?`\\${r}`:r)+o.buildRegExpStr()});return typeof this.#t=="number"&&t.unshift(`#${this.#t}`),t.length===0?"":t.length===1?t[0]:"(?:"+t.join("|")+")"}};var ra=class{#t={varIndex:0};#e=new st;insert(e,t,r){let o=[],n=[];for(let s=0;;){let i=!1;if(e=e.replace(/\{[^}]+\}/g,l=>{let u=`@\\${s}`;return n[s]=[u,l],s++,i=!0,u}),!i)break}let a=e.match(/(?::[^\/]+)|(?:\/\*$)|./g)||[];for(let s=n.length-1;s>=0;s--){let[i]=n[s];for(let l=a.length-1;l>=0;l--)if(a[l].indexOf(i)!==-1){a[l]=a[l].replace(i,n[s][1]);break}}return this.#e.insert(a,t,o,this.#t,r),o}buildRegExp(){let e=this.#e.buildRegExpStr();if(e==="")return[/^$/,[],[]];let t=0,r=[],o=[];return e=e.replace(/#(\d+)|@(\d+)|\.\*\$/g,(n,a,s)=>a!==void 0?(r[++t]=Number(a),"$()"):(s!==void 0&&(o[Number(s)]=++t),"")),[new RegExp(`^${e}`),r,o]}};var oa=[],fc=[/^$/,[],Object.create(null)],na=Object.create(null);function aa(e){return na[e]??=new RegExp(e==="*"?"":`^${e.replace(/\/\*$|([.\\+*[^\]$()])/g,(t,r)=>r?`\\${r}`:"(?:|/.*)")}$`)}function mc(){na=Object.create(null)}function pc(e){let t=new ra,r=[];if(e.length===0)return fc;let o=e.map(u=>[!/\*|\/:/.test(u[0]),...u]).sort(([u,c],[d,h])=>u?1:d?-1:c.length-h.length),n=Object.create(null);for(let u=0,c=-1,d=o.length;u<d;u++){let[h,p,y]=o[u];h?n[p]=[y.map(([g])=>[g,Object.create(null)]),oa]:c++;let b;try{b=t.insert(p,c,h)}catch(g){throw g===je?new nt(p):g}h||(r[c]=y.map(([g,A])=>{let O=Object.create(null);for(A-=1;A>=0;A--){let[E,F]=b[A];O[E]=F}return[g,O]}))}let[a,s,i]=t.buildRegExp();for(let u=0,c=r.length;u<c;u++)for(let d=0,h=r[u].length;d<h;d++){let p=r[u][d]?.[1];if(!p)continue;let y=Object.keys(p);for(let b=0,g=y.length;b<g;b++)p[y[b]]=i[p[y[b]]]}let l=[];for(let u in s)l[u]=r[s[u]];return[a,l,n]}function xe(e,t){if(e){for(let r of Object.keys(e).sort((o,n)=>n.length-o.length))if(aa(r).test(t))return[...e[r]]}}var lr=class{name="RegExpRouter";#t;#e;constructor(){this.#t={[I]:Object.create(null)},this.#e={[I]:Object.create(null)}}add(e,t,r){let o=this.#t,n=this.#e;if(!o||!n)throw new Error(ot);o[e]||[o,n].forEach(i=>{i[e]=Object.create(null),Object.keys(i[I]).forEach(l=>{i[e][l]=[...i[I][l]]})}),t==="/*"&&(t="*");let a=(t.match(/\/:/g)||[]).length;if(/\*$/.test(t)){let i=aa(t);e===I?Object.keys(o).forEach(l=>{o[l][t]||=xe(o[l],t)||xe(o[I],t)||[]}):o[e][t]||=xe(o[e],t)||xe(o[I],t)||[],Object.keys(o).forEach(l=>{(e===I||e===l)&&Object.keys(o[l]).forEach(u=>{i.test(u)&&o[l][u].push([r,a])})}),Object.keys(n).forEach(l=>{(e===I||e===l)&&Object.keys(n[l]).forEach(u=>i.test(u)&&n[l][u].push([r,a]))});return}let s=Ye(t)||[t];for(let i=0,l=s.length;i<l;i++){let u=s[i];Object.keys(n).forEach(c=>{(e===I||e===c)&&(n[c][u]||=[...xe(o[c],u)||xe(o[I],u)||[]],n[c][u].push([r,a-l+i+1]))})}}match(e,t){mc();let r=this.#o();return this.match=(o,n)=>{let a=r[o]||r[I],s=a[2][n];if(s)return s;let i=n.match(a[0]);if(!i)return[[],oa];let l=i.indexOf("",1);return[a[1][l],i]},this.match(e,t)}#o(){let e=Object.create(null);return Object.keys(this.#e).concat(Object.keys(this.#t)).forEach(t=>{e[t]||=this.#s(t)}),this.#t=this.#e=void 0,e}#s(e){let t=[],r=e===I;return[this.#t,this.#e].forEach(o=>{let n=o[e]?Object.keys(o[e]).map(a=>[a,o[e][a]]):[];n.length!==0?(r||=!0,t.push(...n)):e!==I&&t.push(...Object.keys(o[I]).map(a=>[a,o[I][a]]))}),r?pc(t):null}};var ur=class{name="SmartRouter";#t=[];#e=[];constructor(e){this.#t=e.routers}add(e,t,r){if(!this.#e)throw new Error(ot);this.#e.push([e,t,r])}match(e,t){if(!this.#e)throw new Error("Fatal error");let r=this.#t,o=this.#e,n=r.length,a=0,s;for(;a<n;a++){let i=r[a];try{for(let l=0,u=o.length;l<u;l++)i.add(...o[l]);s=i.match(e,t)}catch(l){if(l instanceof nt)continue;throw l}this.match=i.match.bind(i),this.#t=[i],this.#e=void 0;break}if(a===n)throw new Error("Fatal error");return this.name=`SmartRouter + ${this.activeRouter.name}`,s}get activeRouter(){if(this.#e||this.#t.length!==1)throw new Error("No active router has been determined yet.");return this.#t[0]}};var cr=class{#t;#e;#o;#s=0;#n=Object.create(null);constructor(e,t,r){if(this.#e=r||Object.create(null),this.#t=[],e&&t){let o=Object.create(null);o[e]={handler:t,possibleKeys:[],score:0},this.#t=[o]}this.#o=[]}insert(e,t,r){this.#s=++this.#s;let o=this,n=Vn(t),a=[];for(let l=0,u=n.length;l<u;l++){let c=n[l];if(Object.keys(o.#e).includes(c)){o=o.#e[c];let h=tr(c);h&&a.push(h[1]);continue}o.#e[c]=new cr;let d=tr(c);d&&(o.#o.push(d),a.push(d[1])),o=o.#e[c]}let s=Object.create(null),i={handler:r,possibleKeys:a.filter((l,u,c)=>c.indexOf(l)===u),score:this.#s};return s[e]=i,o.#t.push(s),o}#r(e,t,r,o){let n=[];for(let a=0,s=e.#t.length;a<s;a++){let i=e.#t[a],l=i[t]||i[I],u={};if(l!==void 0){l.params=Object.create(null);for(let c=0,d=l.possibleKeys.length;c<d;c++){let h=l.possibleKeys[c],p=u[l.score];l.params[h]=o[h]&&!p?o[h]:r[h]??o[h],u[l.score]=!0}n.push(l)}}return n}search(e,t){let r=[];this.#n=Object.create(null);let n=[this],a=er(t);for(let i=0,l=a.length;i<l;i++){let u=a[i],c=i===l-1,d=[];for(let h=0,p=n.length;h<p;h++){let y=n[h],b=y.#e[u];b&&(b.#n=y.#n,c?(b.#e["*"]&&r.push(...this.#r(b.#e["*"],e,y.#n,Object.create(null))),r.push(...this.#r(b,e,y.#n,Object.create(null)))):d.push(b));for(let g=0,A=y.#o.length;g<A;g++){let O=y.#o[g],E={...y.#n};if(O==="*"){let k=y.#e["*"];k&&(r.push(...this.#r(k,e,y.#n,Object.create(null))),d.push(k));continue}if(u==="")continue;let[F,S,D]=O,_=y.#e[F],T=a.slice(i).join("/");if(D instanceof RegExp&&D.test(T)){E[S]=T,r.push(...this.#r(_,e,y.#n,E));continue}(D===!0||D.test(u))&&(E[S]=u,c?(r.push(...this.#r(_,e,E,y.#n)),_.#e["*"]&&r.push(...this.#r(_.#e["*"],e,E,y.#n))):(_.#n=E,d.push(_)))}}n=d}return[r.sort((i,l)=>i.score-l.score).map(({handler:i,params:l})=>[i,l])]}};var dr=class{name="TrieRouter";#t;constructor(){this.#t=new cr}add(e,t,r){let o=Ye(t);if(o){for(let n=0,a=o.length;n<a;n++)this.#t.insert(e,o[n],r);return}this.#t.insert(e,t,r)}match(e,t){return this.#t.search(e,t)}};var he=class extends ir{constructor(e={}){super(e),this.router=e.router??new ur({routers:[new lr,new dr]})}};import{staticProject as Ny}from"../src/__project.ts";var Ea=v(Me()),Ue=v(te()),Oa=v(vr()),bt=v(wa()),ja=async e=>{let t=e.req.raw,r=(0,Oa.getRequestCookies)(t),o=(0,Ue.validateUrl)((0,bt.applyTemplateValues)(t.headers.get(Ue.PROXY_URL_HEADER),r));if(!o)return e.json({error:`The provided URL is invalid: ${t.headers.get(Ue.PROXY_URL_HEADER)}`},{status:400});let n;try{n=(0,bt.sanitizeProxyHeaders)({cookies:r,headers:t.headers})}catch{return e.json({error:"Proxy validation failed: one or more headers had an invalid name/value"},{status:400})}try{let a=new Request(o.href,{method:e.req.method,headers:n,body:t.body,signal:AbortSignal.timeout(5e3)}),s;try{s=await fetch(a)}catch(u){let c=u instanceof Error&&u.name==="TimeoutError"?504:500;s=Response.json(u.message,{status:c})}let i=Ea.NON_BODY_RESPONSE_CODES.includes(s.status)?void 0:s.body??new ReadableStream;return new Response(i,{status:s.status,headers:Object.fromEntries(s.headers)})}catch(a){let s=a instanceof Error?a.message:"Unable to build a valid request from the API definition";return e.json({error:s},{status:500})}};var Rr=v(j());var _a=v(At()),Be=v(Le()),Z=v(Y()),Ve=v(j());function Er({component:e,files:t}){if(!(0,Ve.isDefined)(e))return{__PROJECT__:{actions:{...t.actions??{}},formulas:{...t.formulas??{}}},...(0,Z.mapObject)(t.packages??{},([a,{actions:s,formulas:i}])=>[a,{actions:s??{},formulas:i??{}}])};let r=new Set,o=new Set,n=new _a.ToddleComponent({component:e,getComponent:(a,s)=>{let i=[s,a].filter(Ve.isDefined).join("/"),l=s?t.packages?.[s]?.components[a]:t.components[a];if(l)return l},packageName:void 0,globalFormulas:{formulas:t.formulas,packages:t.packages}});return n.actionReferences.forEach(a=>r.add(a)),n.formulaReferences.forEach(a=>o.add(a)),n.uniqueSubComponents.forEach(a=>{a.actionReferences.forEach(s=>r.add([a.packageName,s].filter(Ve.isDefined).join("/"))),a.formulaReferences.forEach(s=>o.add([a.packageName,s].filter(Ve.isDefined).join("/")))}),{...(0,Z.mapObject)((0,Z.filterObject)(t.packages??{},([a,{actions:s,formulas:i}])=>Object.values(s??{}).some(l=>r.has(`${a}/${l.name}`))||Object.values(i??{}).some(l=>o.has(`${a}/${l.name}`))),([a,{actions:s,formulas:i}])=>[a,{actions:(0,Z.filterObject)(s??{},([l,u])=>typeof u.name=="string"&&r.has(`${a}/${u.name}`)),formulas:(0,Z.filterObject)(i??{},([l,u])=>typeof u.name=="string"&&o.has(`${a}/${u.name}`))}]),__PROJECT__:{actions:{...Object.fromEntries(Object.entries(t.actions??{}).filter(([a])=>r.has(a)))},formulas:{...Object.fromEntries(Object.entries(t.formulas??{}).filter(([a])=>o.has(a)))}}}}var ka=(e,t)=>{let r=Er({component:e,files:t});return Object.values(r).some(o=>Object.keys(o.actions).length>0||Object.keys(o.formulas).length>0)},Ra=({code:e,componentName:t,projectId:r})=>{let o=(0,Z.mapObject)((0,Z.filterObject)(e,([a,s])=>Object.values(s.actions).some(i=>i.version===2)),([a,s])=>[a==="__PROJECT__"?r:a,s]),n=(0,Z.mapObject)((0,Z.filterObject)(e,([a,s])=>Object.values(s.formulas).some(i=>(0,Be.isToddleFormula)(i)||i.version===2)),([a,s])=>[a==="__PROJECT__"?r:a,s]);return`/*
 * This file is autogenerated by toddle and should not be edited manually.
 *
 * ${typeof t=="string"?`Entry file: ${t}`:"No entry file specified"}
 */

export const project = "${r}";

export const loadCustomCode = () => {
  ${Object.values(e.__PROJECT__.actions).filter(a=>typeof a.name=="string"&&a.version===void 0).map(a=>a.handler).join(`
`)}
  ${Object.values(e.__PROJECT__.formulas).filter(a=>!(0,Be.isToddleFormula)(a)&&typeof a.name=="string"&&a.version===void 0).map(a=>a.handler).join(`
`)}
}

export const actions = {
  ${Object.entries(o).map(([a,{actions:s}])=>`"${a}": {
    ${Object.values(s).filter(i=>i.version===2).map(i=>`"${i.name}": {
      arguments: ${JSON.stringify(i.arguments)},
      handler: (args, ctx) => {
        ${i.handler}
        return ${Sa(i.name)}(args, ctx)
      }
    }`).join(`,
`)}
  }`).join(`,
`)}
}

export const formulas = {
  ${Object.entries(n).map(([a,{formulas:s}])=>`"${a}": {
    ${Object.values(s).filter(i=>(0,Be.isToddleFormula)(i)||i.version===2).map(i=>(0,Be.isToddleFormula)(i)?`"${i.name}": {
      arguments: ${JSON.stringify(i.arguments)},
      formula: ${JSON.stringify(i.formula)}
    }`:`"${i.name}": {
      arguments: ${JSON.stringify(i.arguments)},
      handler: (args, ctx) => {
        ${i.handler}
        return ${Sa(i.name)}(args, ctx)
      }
    }`).join(`,
`)}
  }`).join(`,
`)}
}`},Sa=e=>e.replaceAll(/[^a-zA-Z0-9_]/g,"").replace(/^[0-9]+/,"");var xf=v(j()),cs=v(Rt()),Tt=e=>typeof e=="string"?(0,cs.default)(e):null;var ds=async e=>{let t=new URL(e.req.url),r=Tt(t.searchParams.get("entry")),o;if((0,Rr.isDefined)(r)&&(o=e.var.project.files.components[r],!(0,Rr.isDefined)(o)))return e.text(`Component "${r}" not found in project`,{status:404});let n=Er({component:o,files:e.var.project.files}),a=Ra({code:n,componentName:o?.name??r??void 0,projectId:e.var.project.project.short_id}),s={"content-type":"text/javascript","Access-Control-Allow-Origin":"*"};return new Response(a,{headers:s})};var Dr=v(fs()),vs=v(j()),Fs=v(Pr()),As=v(ps()),ws=v(hs());var gs=v(Y()),ys=({fonts:e,baseForAbsoluteUrls:t,basePath:r="/.toddle/fonts/stylesheet/css2"})=>{if(e.length===0)return;let o=new URLSearchParams;o.set("display","swap");for(let a of e){let s=(0,gs.easySort)(a.variants.filter(p=>!Number.isNaN(Number(p.weight))),p=>Number(p.weight));if(s.length===0)continue;let i=s.filter(p=>p.italic),l=s.filter(p=>!p.italic),u=(p,y)=>p.map(b=>`${typeof y=="number"?`${y},`:""}${b.weight}`).join(";"),c=i.length>0,d=[l,i].map((p,y)=>u(p,c?y:void 0)).filter(Boolean).join(";"),h=a.family;c?h+=`:ital,wght@${d}`:h+=`:wght@${d}`,o.append("family",h)}let n=`${r}?${o.toString()}`;try{return{swap:typeof t=="string"?new URL(n,t).toString():n}}catch{}};var bs=e=>t=>({...t,nodes:Object.entries(t.nodes).reduce((r,[o,n])=>({...r,[o]:{...n,...n.type==="element"?{attrs:Object.entries(n.attrs).reduce((a,[s,i])=>["src"].includes(s)&&i?.type==="value"&&typeof i.value=="string"?{...a,[s]:{...i,value:new URL(i.value,e).href}}:{...a,[s]:i},{})}:{}}}),{})});var Es=async e=>{let t=new URL(e.req.url),r=e.req.param("filename")?.replace(".js",""),o=(s,i)=>e.json({error:s,info:"Please see https://toddle.dev/docs/export-component for more information on web component export"},{headers:{"Access-Control-Allow-Origin":"*"},status:i}),{files:n,project:a}=e.var.project;try{let s=Object.values(n.components).find(p=>p.name===r);if(!s)return o(`Unable to find component ${Tt(r)}`,404);if(s.route)return o("Pages are not supported as custom elements, only components",403);let i=n.themes??{},l=Object.values(i).flatMap(p=>p.fonts),u=(0,Fs.takeIncludedComponents)({root:s,projectComponents:n.components,packages:n.packages}),c=new URLSearchParams([["entry",s.name]]),d=ys({fonts:l,baseForAbsoluteUrls:t.origin}),h=`/*
 * This file is autogenerated by toddle and should not be edited manually.
 *
 * <${(0,Dr.safeCustomElementName)(s.name)} />
 *
 * Attributes:
 *
 * ${Object.entries(s.attributes??{}).map(([,p])=>`- ${p.name}`).join(`
 * `)}
 *
 * Events:
 *
 * ${Object.entries(s.events??{}).map(([,p])=>`- ${p.name}`).join(`
 * `)}
 */

import { defineComponents, loadCorePlugins } from '/_static/esm-custom-element.main.js';
import { loadCustomCode, formulas, actions } from '/.toddle/custom-code.js?${c.toString()}';

${(0,vs.isDefined)(d)?`
    // Font loading in shadow-dom is not supported widely, so we inject in <head>
    // Ideally, we would inject the stylesheet directly in the ToddleComponent,
    // but it appears it doesn't fetch the fonts - only the stylesheet
    // See https://developer.mozilla.org/en-US/docs/Web/API/Web_components/Using_custom_elements#referencing_external_styles
    const linkElem = document.createElement("link");
    linkElem.setAttribute("rel", "stylesheet");
    linkElem.setAttribute("href", "${d.swap}");
    document.head.appendChild(linkElem);`:""}

// Global toddle object
const toddle = (() => {
  const legacyActions = {}
  const legacyFormulas = {}
  const argumentInputDataList = {}
  return {
    formulas,
    actions,
    errors:[],
    project:"${a.name}",
    branch:"main",
    commit:"unknown",
    registerAction: (name, handler) => {
      if (legacyActions[name]) {
        console.error('There already exists an action with the name ', name)
        return
      }
      legacyActions[name] = handler
    },
    getAction: (name) => legacyActions[name],
    registerFormula: (name,handler,getArgumentInputData) => {
      if (legacyFormulas[name]) {
        console.error('There already exists a formula with the name ', name)
        return
      }
      legacyFormulas[name] = handler
      if (getArgumentInputData) {
        argumentInputDataList[name] = getArgumentInputData
      }
    },
    getFormula: (name) => legacyFormulas[name],
    getCustomAction: (name, packageName) => {
      return actions[packageName ?? "${a.name}"]?.[name] ?? actions["${a.name}"]?.[name]
    },
    getCustomFormula: (name, packageName) => {
      return formulas[packageName ?? "${a.name}"]?.[name] ?? formulas["${a.name}"]?.[name]
    },
    getArgumentInputData: (formulaName,args,argIndex,data
    ) => argumentInputDataList[formulaName]?.(args, argIndex, data) || data,
    data: {},
    locationSignal: null,
    eventLog: [],
    pageState: {},
    env: {
      isServer: false,
      branchName: "main",
      request: undefined,
    }
  }
})();

// Load core plugin (actions and formulas)
loadCorePlugins(toddle);

// Load project's custom actions and formulas
loadCustomCode();

// toddle.isEqual is required for some formulas to work. TODO: Remove this once they can consume from somewhere else.
if(!globalThis.toddle || !globalThis.toddle.isEqual) {
  globalThis.toddle = {
    isEqual: toddle.isEqual,
  }
}

// Define the custom element
defineComponents(${JSON.stringify([s.name])}, ${JSON.stringify({themes:i,components:u.map((0,ws.replaceTagInNodes)((0,Dr.safeCustomElementName)(s.name),"div")).map(As.removeTestData).map(bs(t.origin))})}, toddle);
`;return new Response(h,{headers:{"Cache-Control":"no-cache","Access-Control-Allow-Origin":"*","content-type":"text/javascript"}})}catch{return o("404",404)}};var Os=v(V()),js=v(te()),xs=v(j());var Ir=class{writer;encoder;writable;abortSubscribers=[];responseReadable;aborted=!1;closed=!1;constructor(e,t){this.writable=e,this.writer=e.getWriter(),this.encoder=new TextEncoder;let r=t.getReader();this.abortSubscribers.push(async()=>{await r.cancel()}),this.responseReadable=new ReadableStream({async pull(o){let{done:n,value:a}=await r.read();n?o.close():o.enqueue(a)},cancel:()=>{this.abort()}})}async write(e){try{typeof e=="string"&&(e=this.encoder.encode(e)),await this.writer.write(e)}catch{}return this}async writeln(e){return await this.write(e+`
`),this}sleep(e){return new Promise(t=>setTimeout(t,e))}async close(){try{await this.writer.close()}catch{}this.closed=!0}async pipe(e){this.writer.releaseLock(),await e.pipeTo(this.writable,{preventClose:!0}),this.writer=this.writable.getWriter()}onAbort(e){this.abortSubscribers.push(e)}abort(){this.aborted||(this.aborted=!0,this.abortSubscribers.forEach(e=>e()))}};var Tf=new WeakMap,K=(e,t,r)=>{let{readable:o,writable:n}=new TransformStream,a=new Ir(n,o);return e.req.raw.signal.addEventListener("abort",()=>{a.closed||a.abort()}),Tf.set(a.responseReadable,e),(async()=>{try{await t(a)}catch(s){s instanceof Error&&r&&await r(s,a)}finally{a.close()}})(),e.newResponse(a.responseReadable)};var Cs=async e=>{try{let t=(0,Os.applyFormula)(e.var.project.files.config?.meta?.icon?.formula,void 0),r=(0,js.validateUrl)(t);if(r){let{body:o,ok:n,headers:a}=await fetch(r);if(n&&o){e.header("Cache-Control","public, max-age=3600");let s=a.get("content-type");return(0,xs.isDefined)(s)&&e.header("Content-Type",s),K(e,i=>i.pipe(o))}}}catch{}return new Response(null,{status:404})};var Dt=e=>{let r={...{origin:"*",allowMethods:["GET","HEAD","PUT","POST","DELETE","PATCH"],allowHeaders:[],exposeHeaders:[]},...e},o=(n=>typeof n=="string"?n==="*"?()=>n:a=>n===a?a:null:typeof n=="function"?n:a=>n.includes(a)?a:null)(r.origin);return async function(a,s){function i(u,c){a.res.headers.set(u,c)}let l=o(a.req.header("origin")||"",a);if(l&&i("Access-Control-Allow-Origin",l),r.origin!=="*"){let u=a.req.header("Vary");u?i("Vary",u):i("Vary","Origin")}if(r.credentials&&i("Access-Control-Allow-Credentials","true"),r.exposeHeaders?.length&&i("Access-Control-Expose-Headers",r.exposeHeaders.join(",")),a.req.method==="OPTIONS"){r.maxAge!=null&&i("Access-Control-Max-Age",r.maxAge.toString()),r.allowMethods?.length&&i("Access-Control-Allow-Methods",r.allowMethods.join(","));let u=r.allowHeaders;if(!u?.length){let c=a.req.header("Access-Control-Request-Headers");c&&(u=c.split(/\s*,\s*/))}return u?.length&&(i("Access-Control-Allow-Headers",u.join(",")),a.res.headers.append("Vary","Access-Control-Request-Headers")),a.res.headers.delete("Content-Length"),a.res.headers.delete("Content-Type"),new Response(null,{headers:a.res.headers,status:204,statusText:a.res.statusText})}await s()}};var ze=new he;ze.use(Dt());ze.get("/stylesheet/:stylesheet{.*}",async({req:e,...t})=>{let r=new URL(e.url);try{let o=await fetch(`https://fonts.googleapis.com/${e.param("stylesheet")}${r.search}`,Ss(e.raw)),n=await o.text();if(o.ok)n=n.replaceAll("https://fonts.gstatic.com","/.toddle/fonts/font");else return new Response(void 0,{headers:{"Content-Type":"text/css; charset=utf-8"},status:404});let a=_s(o.headers);return Array.from(a.entries()).forEach(([s,i])=>t.header(s,i)),t.body(n)}catch{}return new Response(void 0,{headers:{"Content-Type":"text/css; charset=utf-8"},status:404})});ze.get("/font/:font{.*}",async e=>{try{let t=Ss(e.req.raw),r=await fetch(`https://fonts.gstatic.com/${e.req.param("font")}`,t),o=_s(r.headers);if(Array.from(o.entries()).forEach(([n,a])=>e.header(n,a)),r.ok&&r.body)return K(e,n=>n.pipe(r.body))}catch{}return new Response(void 0,{status:404})});var Ss=e=>({method:e.method,headers:["Accept","Accept-Encoding","Accept-Language","Referer","User-Agent"].map(t=>[t,e.headers.get(t)]).filter(t=>typeof t[1]=="string")}),_s=e=>new Headers(["Content-Type","Cache-Control","Expires","Accept-Ranges","Date","Last-Modified","ETag"].map(t=>[t,e.get(t)]).filter(t=>typeof t[1]=="string"));var ks=v(V()),Rs=v(te());var Pf="application/manifest+json",Ts=async e=>{try{let t=(0,ks.applyFormula)(e.var.project.files.config?.meta?.manifest?.formula,void 0);if(typeof(0,Rs.validateUrl)(t)=="string"){let{body:o,ok:n}=await fetch(t);if(n&&o)return e.header("Content-Type",Pf),e.header("Cache-Control","public, max-age=3600"),K(e,a=>a.pipe(o))}}catch{}return new Response(null,{status:404})};var Hs=v(V()),Ds=v(te());var Ps="text/plain",Is=async e=>{try{let t=e.var.project.files.config?.meta?.robots,r=(0,Hs.applyFormula)(t?.formula,void 0),o=(0,Ds.validateUrl)(r);if(o){let{body:s,ok:i}=await fetch(o);if(i&&s)return e.header("Content-Type",Ps),e.header("Cache-Control","public, max-age=3600"),K(e,l=>l.pipe(s))}let a=`Sitemap: ${new URL(e.req.url).origin}/sitemap.xml

User-agent: *
Disallow: /_toddle
Disallow: /_toddle/
Disallow: /.toddle
Disallow: /.toddle/
Disallow: /_api
Disallow: /_api/
Allow: /cdn-cgi/imagedelivery/*
Disallow: /cdn-cgi/
`;return new Response(a,{headers:{"Content-Type":Ps,"Cache-Control":"public, max-age=3600"}})}catch{}return new Response("404",{status:404})};var $s=v(V()),Ns=v(te()),Ls=v(j());var qs=async e=>{try{let t=e.var.project.files.config,r=(0,Ls.isDefined)(t?.meta?.serviceWorker)?(0,$s.applyFormula)(t.meta.serviceWorker.formula,void 0):void 0,o=(0,Ns.validateUrl)(r);if(o){let{body:n,ok:a}=await fetch(o);if(a&&n)return e.header("Content-Type","text/javascript"),K(e,s=>s.pipe(n))}return new Response(null,{status:404})}catch{}return new Response(null,{status:404})};var Us=v(Ar()),Bs=v(V()),Vs=v(te()),Ks=v(j());var Ms="application/xml",Ws=async e=>{try{let t=new URL(e.req.url),r=e.var.project,o=r.files.config?.meta?.sitemap?.formula;if((0,Ks.isDefined)(o)){let n=(0,Vs.validateUrl)((0,Bs.applyFormula)(o,void 0));if(n){let{body:a,ok:s}=await fetch(n);if(s&&a)return e.header("Content-Type",Ms),e.header("Cache-Control","public, max-age=3600"),K(e,i=>i.pipe(a))}else return new Response(null,{status:404})}else{let n=`<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
  ${Object.values(r.files.components).filter((a,s)=>!!(a&&(0,Us.isPageComponent)(a)&&a.route?.path.every(i=>i.type==="static")&&s<1e3)).sort((a,s)=>{let i=a.route.path.length,l=s.route.path.length;return i-l}).map(a=>`
<url>
  <loc>${t.origin}/${a.route.path.map(s=>s.name).join("/")}</loc>
</url>`).join("")}
</urlset>`;return new Response(n,{headers:{"Content-Type":Ms,"Cache-Control":"public, max-age=3600"}})}}catch{}return new Response(null,{status:404})};var zs=v(It());import{readFileSync as $r}from"fs";import{resolve as Nr}from"path";var ve=new he;ve.get("/reset.css",e=>(e.header("Content-Type","text/css"),e.header("Cache-Control","public, max-age=3600"),e.body(zs.RESET_STYLES)));ve.get("/esm-page.main.js",e=>{e.header("Content-Type","text/javascript"),e.header("Cache-Control","public, max-age=3600");let t=$r(Nr(__dirname,"../../../../packages/runtime/dist/esm-page.main.js"),"utf8");return e.body(t)});ve.get("/esm-page.main.js.map",e=>{e.header("Content-Type","text/javascript"),e.header("Cache-Control","public, max-age=3600");let t=$r(Nr(__dirname,"../../../../packages/runtime/dist/esm-page.main.js.map"),"utf8");return e.body(t)});ve.use(Dt());ve.get("/esm-custom-element.main.js",e=>{e.header("Content-Type","text/javascript"),e.header("Cache-Control","public, max-age=3600");let t=$r(Nr(__dirname,"../../../../packages/runtime/dist/esm-custom-element.main.js"),"utf8");return e.body(t)});var Du=v(At()),Uv=v(V()),Iu=v(ti()),$u=v(It()),Nu=v(j()),Lu=v(Pr()),qu=v(si()),Mu=v(Dn()),Xt=v(ku()),Qt=v(In()),De=v(Kt());var we=v(Y());function $n(e){return{...e,attributes:(0,we.mapObject)(e.attributes,([t,r])=>[t,(0,we.omit)(r,["testValue"])]),...e.route?{route:{...e.route,path:e.route.path.map(t=>(0,we.omit)(t,["testValue"])),query:(0,we.mapObject)(e.route.query,([t,r])=>[t,(0,we.omit)(r,["testValue"])])}}:{}}}var Ru=(e,...t)=>{let r=[""];for(let o=0,n=e.length-1;o<n;o++){r[0]+=e[o];let a=Array.isArray(t[o])?t[o].flat(1/0):[t[o]];for(let s=0,i=a.length;s<i;s++){let l=a[s];if(typeof l=="string")et(l,r);else if(typeof l=="number")r[0]+=l;else{if(typeof l=="boolean"||l===null||l===void 0)continue;if(typeof l=="object"&&l.isEscaped)if(l.callbacks)r.unshift("",l);else{let u=l.toString();u instanceof Promise?r.unshift("",u):r[0]+=u}else l instanceof Promise?r.unshift("",l):et(l.toString(),r)}}}return r[0]+=e[e.length-1],r.length===1?"callbacks"in r?Q(Qn(Q(r[0],r.callbacks))):Q(r[0]):Xn(r,r.callbacks)};var Tu=v(Me()),Nn=v(te()),Pu=v(Kt()),Hu=async(e,t)=>{let r=(0,Pu.getRouteDestination)({files:e.var.project.files,req:e.req.raw,route:t});if(!r)return e.html("Invalid destination",{status:500});if(t.type==="redirect")return e.redirect(r.href,t.status??302);if(e.req.raw.headers.get(Nn.REWRITE_HEADER)!==null)return e.html("toddle rewrites are not allowed to be recursive",{status:500});try{let o=new Headers;o.set("accept-encoding","gzip"),o.set("accept","*/*"),o.set(Nn.REWRITE_HEADER,"true");let n=await fetch(r,{headers:o,method:"GET"}),a=Tu.NON_BODY_RESPONSE_CODES.includes(n.status)?void 0:n.body??new ReadableStream;return new Response(a,{status:n.status,headers:{...Object.fromEntries(n.headers.entries().filter(([i])=>i!=="content-encoding"))}})}catch{return e.html(`Internal server error when fetching url: ${r.href}`,{status:500})}};var Uu=async e=>{let t=e.var.project,r=new URL(e.req.url),o=(0,De.matchRouteForUrl)({url:r,routes:t.files.routes});if(o)return Hu(e,o);let n=(0,De.matchPageForUrl)({url:r,components:t.files.components});if(!n&&(n=(0,De.get404Page)(t.files.components),!n))return e.html("Page not found",{status:404});let a=(0,Mu.getPageFormulaContext)({component:n,branchName:"main",req:e.req.raw,logErrors:!0,files:t.files}),s=(0,Qt.getHtmlLanguage)({pageInfo:n.route.info,formulaContext:a,defaultLanguage:"en"}),i=(t.files.themes?Object.values(t.files.themes)[0]:t.files.config?.theme)??$u.theme,l=(0,Lu.takeIncludedComponents)({root:n,projectComponents:t.files.components,packages:t.files.packages,includeRoot:!0}),u=(0,Iu.createStylesheet)(n,l,i,{includeResetStyle:!1,createFontFaces:!1}),c=new Du.ToddleComponent({component:n,getComponent:(A,O)=>{let E=[O,A].filter(Nu.isDefined).join("/"),F=O?t.files.packages?.[O]?.components[A]:t.files.components[A];if(F)return F},packageName:void 0,globalFormulas:{formulas:t.files.formulas,packages:t.files.packages}}),d=(0,Xt.renderHeadItems)({headItems:(0,Xt.getHeadItems)({url:r,cssBasePath:"/.toddle/fonts/stylesheet/css2",page:c,files:t.files,project:t.project,context:a,theme:i})}),{html:h}=await(0,qu.renderPageBody)({component:c,formulaContext:a,env:a.env,req:e.req.raw,files:t.files,includedComponents:l,evaluateComponentApis:async A=>({}),projectId:"my_project"}),p=(0,Qt.getCharset)({pageInfo:c.route?.info,formulaContext:a}),y={project:e.var.project.project.short_id,branch:"main",commit:"unknown",pageState:a.data,component:$n(n),components:l.map($n),isPageLoaded:!1,cookies:Object.keys(a.env.request.cookies)},b=ka(c,e.var.project.files),g="";return b?g=`
            <script type="module">
              import { initGlobalObject, createRoot } from '/_static/esm-page.main.js';
              import { loadCustomCode, formulas, actions } from '/.toddle/custom-code.js?${new URLSearchParams([["entry",c.name]]).toString()}';

              window.__toddle = ${JSON.stringify(y).replaceAll("</script>","<\\/script>")};
              window.__toddle.components = [window.__toddle.component, ...window.__toddle.components];
              initGlobalObject({formulas, actions});
              loadCustomCode();
              createRoot(document.getElementById("App"));
            </script>
          `:g=`
        <script type="module">
          import { initGlobalObject, createRoot } from '/_static/esm-page.main.js';

          window.__toddle = ${JSON.stringify(y).replaceAll("</script>","<\\/script>")};
          window.__toddle.components = [window.__toddle.component, ...window.__toddle.components];
          initGlobalObject({formulas: {}, actions: {}});
          createRoot(document.getElementById("App"));
        </script>
    `,e.html(Ru`<!doctype html>
      <html lang="${s}">
        <head>
          ${Q(d)}
          <style>
            ${Q(u)}
          </style>
          ${Q(g)}
        </head>
        <body>
          <div id="App">${Q(h)}</div>
        </body>
      </html>`,{headers:{"Content-Type":`text/html; charset=${p}`}})};(0,Bu.initIsEqual)();var z=new he;z.route("/_static",ve);z.use(async(e,t)=>{let r=Ny;return e.set("project",r),t()});z.get("/sitemap.xml",Ws);z.get("/robots.txt",Is);z.get("/manifest.json",Ts);z.get("/favicon.ico",Cs);z.get("/serviceWorker.js",qs);z.route("/.toddle/fonts",ze);z.get("/.toddle/custom-code.js",ds);z.all("/.toddle/omvej/components/:componentName/apis/:apiName",ja);z.get("/.toddle/custom-element/:filename{.+.js}",Es);z.get("/*",Uu);var iF=z;export{iF as default};
