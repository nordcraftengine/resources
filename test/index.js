var Ku=Object.create;var Ge=Object.defineProperty;var Wu=Object.getOwnPropertyDescriptor;var zu=Object.getOwnPropertyNames;var Gu=Object.getPrototypeOf,Ju=Object.prototype.hasOwnProperty;var m=(e,t)=>()=>(e&&(t=e(e=0)),t);var w=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),p=(e,t)=>{for(var r in t)Ge(e,r,{get:t[r],enumerable:!0})},In=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of zu(t))!Ju.call(e,n)&&n!==r&&Ge(e,n,{get:()=>t[n],enumerable:!(o=Wu(t,n))||o.enumerable});return e};var v=(e,t,r)=>(r=e!=null?Ku(Gu(e)):{},In(t||!e||!e.__esModule?Ge(r,"default",{value:e,enumerable:!0}):r,e)),Xu=e=>In(Ge({},"__esModule",{value:!0}),e);var Nn=w((Ly,$n)=>{"use strict";$n.exports=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var o,n,a;if(Array.isArray(t)){if(o=t.length,o!=r.length)return!1;for(n=o;n--!==0;)if(!e(t[n],r[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(a=Object.keys(t),o=a.length,o!==Object.keys(r).length)return!1;for(n=o;n--!==0;)if(!Object.prototype.hasOwnProperty.call(r,a[n]))return!1;for(n=o;n--!==0;){var s=a[n];if(!e(t[s],r[s]))return!1}return!0}return t!==t&&r!==r}});var Ln=w(Ae=>{"use strict";var Qu=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ae,"__esModule",{value:!0});Ae.initIsEqual=void 0;var Yu=Qu(Nn()),Zu=()=>{let e={isEqual:Yu.default};globalThis.toddle=e};Ae.initIsEqual=Zu});var x=w(ce=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});ce.toBoolean=ce.isObject=ce.isDefined=void 0;var pc=e=>e!=null;ce.isDefined=pc;var hc=e=>typeof e=="object"&&e!==null;ce.isObject=hc;var gc=e=>e!==!1&&e!==void 0&&e!==null;ce.toBoolean=gc});var Ne=w(st=>{"use strict";Object.defineProperty(st,"__esModule",{value:!0});st.isToddleFormula=void 0;var yc=e=>Object.hasOwn(e,"formula");st.isToddleFormula=yc});var V=w(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});Le.isFormula=na;Le.isFormulaApplyOperation=vc;Le.applyFormula=q;var it=x(),bc=Ne();function na(e){return e&&typeof e=="object"&&typeof e.type=="string"}function vc(e){return e.type==="apply"}function q(e,t){if(!na(e))return e;try{switch(e.type){case"value":return e.value;case"path":return e.path.reduce((r,o)=>r&&typeof r=="object"?r[o]:null,t.data);case"switch":{for(let r of e.cases)if((0,it.toBoolean)(q(r.condition,t)))return q(r.formula,t);return q(e.default,t)}case"or":{for(let r of e.arguments)if((0,it.toBoolean)(q(r.formula,t)))return!0;return!1}case"and":{for(let r of e.arguments)if(!(0,it.toBoolean)(q(r.formula,t)))return!1;return!0}case"function":{let r=e.package??t.package,o=(t.toddle??globalThis.toddle)?.getCustomFormula(e.name,r),n=(t.toddle??globalThis.toddle).getFormula(e.name);if((0,it.isDefined)(o)){let a=e.arguments.reduce((s,i,l)=>({...s,[i.name??`${l}`]:i.isFunction?u=>q(i.formula,{...t,data:{...t.data,Args:t.data.Args?{...u,"@toddle.parent":t.data.Args}:u}}):q(i.formula,t)}),{});try{return(0,bc.isToddleFormula)(o)?q(o.formula,{...t,data:{...t.data,Args:a}}):o.handler(a,{root:t.root??document,env:t.env})}catch(s){return t.toddle.errors.push(s),t.env?.logErrors,null}}else if(typeof n=="function"){let a=e.arguments.map(s=>s.isFunction?i=>q(s.formula,{...t,data:{...t.data,Args:t.data.Args?{...i,"@toddle.parent":t.data.Args}:i}}):q(s.formula,t));try{return n(a,t)}catch(s){return t.toddle.errors.push(s),t.env?.logErrors,null}}return t.env?.logErrors,null}case"object":return Object.fromEntries(e.arguments?.map(r=>[r.name,q(r.formula,t)])??[]);case"record":return Object.fromEntries(e.entries.map(r=>[r.name,q(r.formula,t)]));case"array":return e.arguments.map(r=>q(r.formula,t));case"apply":{let r=t.component.formulas?.[e.name];if(!r)return t.env?.logErrors,null;let o=Object.fromEntries(e.arguments.map(s=>s.isFunction?[s.name,i=>q(s.formula,{...t,data:{...t.data,Args:t.data.Args?{...i,"@toddle.parent":t.data.Args}:i}})]:[s.name,q(s.formula,t)])),n={...t.data,Args:t.data.Args?{...o,"@toddle.parent":t.data.Args}:o},a=t.formulaCache?.[e.name]?.get(n);if(a?.hit)return a.data;{let s=q(r.formula,{...t,data:n});return t.formulaCache?.[e.name]?.set(n,s),s}}default:t.env?.logErrors}}catch{return t.env?.logErrors,null}}});var Q=w(j=>{"use strict";Object.defineProperty(j,"__esModule",{value:!0});j.deepSortObject=j.easySort=j.sortObjectEntries=j.set=j.filterObject=j.groupBy=j.omitPaths=j.omitKeys=j.omit=j.mapValues=j.mapObject=j.isObject=void 0;j.get=aa;var Fc=x(),Ac=e=>typeof e=="object"&&e!==null;j.isObject=Ac;var wc=(e,t)=>Object.fromEntries(Object.entries(e).map(t));j.mapObject=wc;var Ec=(e,t)=>(0,j.mapObject)(e,([r,o])=>[r,t(o)]);j.mapValues=Ec;var Oc=(e,t)=>{let[r,...o]=t,n=Array.isArray(e)?[...e]:(0,j.isObject)(e)?{...e}:{};return o.length===0?delete n[r]:n[r]=(0,j.omit)(n[r],o),n};j.omit=Oc;var xc=(e,t)=>Object.fromEntries(Object.entries(e).filter(([r])=>!t.includes(r)));j.omitKeys=xc;var jc=(e,t)=>t.reduce((r,o)=>(0,j.omit)(r,o),{...e});j.omitPaths=jc;var Sc=(e,t)=>e.reduce((r,o)=>{let n=t(o);return r[n]=r[n]??[],r[n].push(o),r},{});j.groupBy=Sc;var Cc=(e,t)=>Object.fromEntries(Object.entries(e).filter(t));j.filterObject=Cc;function aa(e,[t,...r]){return r.length===0?e?.[t]:aa(e?.[t],r)}var _c=(e,t,r)=>{let[o,...n]=t,a=Array.isArray(e)?[...e]:(0,j.isObject)(e)?{...e}:{};return a[o]=n.length===0?r:(0,j.set)(a[o],n,r),a};j.set=_c;var kc=(e,t,r=!0)=>(0,j.easySort)(Object.entries(e),t,r);j.sortObjectEntries=kc;var Rc=(e,t,r=!0)=>[...e].sort((o,n)=>{let a=t(o),s=t(n);return a===s?0:(a>s?1:-1)*(r?1:-1)});j.easySort=Rc;var Tc=e=>(0,Fc.isDefined)(e)?Array.isArray(e)?e.map(t=>(0,j.deepSortObject)(t)):typeof e=="object"&&Object.keys(e).length>0?[...Object.keys(e)].sort().reduce((t,r)=>(t[r]=(0,j.deepSortObject)(e[r]),t),{}):e:e;j.deepSortObject=Tc});var sa=w(lt=>{"use strict";Object.defineProperty(lt,"__esModule",{value:!0});lt.hash=void 0;var Hc=(e,t=0)=>{let r=3735928559^t,o=1103547991^t;for(let n=0,a;n<e.length;n++)a=e.charCodeAt(n),r=Math.imul(r^a,2654435761),o=Math.imul(o^a,1597334677);return r=Math.imul(r^r>>>16,2246822507),r^=Math.imul(o^o>>>13,3266489909),o=Math.imul(o^o>>>16,2246822507),o^=Math.imul(r^r>>>13,3266489909),4294967296*(2097151&o)+(r>>>0)};lt.hash=Hc});var la=w(ut=>{"use strict";Object.defineProperty(ut,"__esModule",{value:!0});ut.ApiMethod=void 0;var ia;(function(e){e.GET="GET",e.POST="POST",e.DELETE="DELETE",e.PUT="PUT",e.PATCH="PATCH",e.HEAD="HEAD",e.OPTIONS="OPTIONS"})(ia||(ut.ApiMethod=ia={}))});var dt=w(Z=>{"use strict";Object.defineProperty(Z,"__esModule",{value:!0});Z.functionFormula=Z.pathFormula=Z.valueFormula=void 0;Z.getFormulasInFormula=B;Z.getFormulasInAction=he;var ct=x(),ua=V(),Pc=Ne(),Dc=e=>({type:"value",value:e});Z.valueFormula=Dc;var Ic=e=>({type:"path",path:e});Z.pathFormula=Ic;var $c=(e,t)=>({type:"function",name:e,package:t?.package,arguments:t?.arguments??[],variableArguments:t?.variableArguments});Z.functionFormula=$c;function*B({formula:e,globalFormulas:t,path:r=[],visitedFormulas:o=new Set}){if((0,ct.isDefined)(e))switch(yield[r,e],e.type){case"path":case"value":break;case"record":for(let[n,a]of e.entries.entries())yield*B({formula:a.formula,globalFormulas:t,path:[...r,"entries",n,"formula"],visitedFormulas:o});break;case"function":{let n=[e.package,e.name].filter(ct.isDefined).join("/"),a=!o.has(n);o.add(n);let s=e.package?t.packages?.[e.package]?.formulas?.[e.name]:t.formulas?.[e.name];for(let[i,l]of(e.arguments??[]).entries())yield*B({formula:l.formula,globalFormulas:t,path:[...r,"arguments",i,"formula"],visitedFormulas:o});s&&(0,Pc.isToddleFormula)(s)&&a&&(yield*B({formula:s.formula,globalFormulas:t,path:[...r,"formula"],visitedFormulas:o}));break}case"array":case"or":case"and":case"object":for(let[n,a]of(e.arguments??[]).entries())yield*B({formula:a.formula,globalFormulas:t,path:[...r,"arguments",n,"formula"],visitedFormulas:o});break;case"apply":for(let[n,a]of(e.arguments??[]).entries())yield*B({formula:a.formula,globalFormulas:t,path:[...r,"arguments",n,"formula"],visitedFormulas:o});break;case"switch":for(let[n,a]of e.cases.entries())yield*B({formula:a.condition,globalFormulas:t,path:[...r,"cases",n,"condition"],visitedFormulas:o}),yield*B({formula:a.formula,globalFormulas:t,path:[...r,"cases",n,"formula"],visitedFormulas:o});yield*B({formula:e.default,globalFormulas:t,path:[...r,"default"],visitedFormulas:o});break}}function*he({action:e,globalFormulas:t,path:r=[],visitedFormulas:o=new Set}){if((0,ct.isDefined)(e))switch(e.type){case"Fetch":for(let[n,a]of Object.entries(e.inputs??{}))yield*B({formula:a.formula,globalFormulas:t,path:[...r,"input",n,"formula"],visitedFormulas:o});for(let[n,a]of Object.entries(e.onSuccess?.actions??{}))yield*he({action:a,globalFormulas:t,path:[...r,"onSuccess","actions",n],visitedFormulas:o});for(let[n,a]of Object.entries(e.onError?.actions??{}))yield*he({action:a,globalFormulas:t,path:[...r,"onError","actions",n],visitedFormulas:o});for(let[n,a]of Object.entries(e.onMessage?.actions??{}))yield*he({action:a,globalFormulas:t,path:[...r,"onMessage","actions",n],visitedFormulas:o});break;case"Custom":case void 0:(0,ua.isFormula)(e.data)&&(yield*B({formula:e.data,globalFormulas:t,path:[...r,"data"],visitedFormulas:o}));for(let[n,a]of Object.entries(e.arguments??{}))yield*B({formula:a.formula,globalFormulas:t,path:[...r,"arguments",n,"formula"],visitedFormulas:o});for(let[n,a]of Object.entries(e.events??{}))for(let[s,i]of Object.entries(a.actions??{}))yield*he({action:i,globalFormulas:t,path:[...r,"events",n,"actions",s],visitedFormulas:o});break;case"SetVariable":case"SetURLParameter":case"TriggerEvent":yield*B({formula:e.data,globalFormulas:t,path:[...r,"data"],visitedFormulas:o});break;case"TriggerWorkflow":for(let[n,a]of Object.entries(e.parameters??{}))yield*B({formula:a.formula,globalFormulas:t,path:[...r,"parameters",n,"formula"],visitedFormulas:o});break;case"Switch":(0,ct.isDefined)(e.data)&&(0,ua.isFormula)(e.data)&&(yield*B({formula:e.data,globalFormulas:t,path:[...r,"data"],visitedFormulas:o}));for(let[n,a]of e.cases.entries()){yield*B({formula:a.condition,globalFormulas:t,path:[...r,"cases",n,"condition"],visitedFormulas:o});for(let[s,i]of Object.entries(a.actions))yield*he({action:i,globalFormulas:t,path:[...r,"cases",n,"actions",s],visitedFormulas:o})}for(let[n,a]of Object.entries(e.default.actions))yield*he({action:a,globalFormulas:t,path:[...r,"default","actions",n],visitedFormulas:o});break}}});var dr=w(ft=>{"use strict";Object.defineProperty(ft,"__esModule",{value:!0});ft.LegacyToddleApi=void 0;var ca=V(),oe=dt(),Nc=x(),cr=class{api;key;globalFormulas;_apiReferences;constructor(t,r,o){this.api=t,this.key=r,this.globalFormulas=o}get apiReferences(){if(this._apiReferences)return this._apiReferences;let t=new Set,r=o=>{if((0,Nc.isDefined)(o))switch(o.type){case"path":o.path[0]==="Apis"&&t.add(o.path[1]);break;case"value":break;case"record":o.entries.forEach(n=>r(n.formula));break;case"function":case"array":case"or":case"and":case"apply":case"object":o.arguments?.forEach(n=>r(n.formula));break;case"switch":o.cases.forEach(n=>{r(n.condition),r(n.formula)});break}};return r(this.api.autoFetch),r(this.api.url),Object.values(this.api.path??{}).forEach(o=>r(o.formula)),Object.values(this.api.queryParams??{}).forEach(o=>r(o.formula)),(0,ca.isFormula)(this.api.headers)?r(this.api.headers):Object.values(this.api.headers??{}).forEach(o=>{r(o)}),r(this.api.body),this._apiReferences=t,t}get name(){return this.api.name}get type(){return this.api.type}get autoFetch(){return this.api.autoFetch}get url(){return this.api.url}get path(){return this.api.path}get proxy(){return this.api.proxy}get queryParams(){return this.api.queryParams}get headers(){return this.api.headers}get method(){return this.api.method}get body(){return this.api.body}get auth(){return this.api.auth}get throttle(){return this.api.throttle}get debounce(){return this.api.debounce}get onCompleted(){return this.api.onCompleted}get onFailed(){return this.api.onFailed}*formulasInApi(){let t=this.api,r=this.key;yield*(0,oe.getFormulasInFormula)({formula:t.autoFetch,globalFormulas:this.globalFormulas,path:["apis",r,"autoFetch"]}),yield*(0,oe.getFormulasInFormula)({formula:t.url,globalFormulas:this.globalFormulas,path:["apis",r,"url"]});for(let[o,n]of Object.entries(t.path??{}))yield*(0,oe.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"path",o,"formula"]});for(let[o,n]of Object.entries(t.queryParams??{}))yield*(0,oe.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"queryParams",o,"formula"]});if((0,ca.isFormula)(t.headers))yield*(0,oe.getFormulasInFormula)({formula:t.headers,globalFormulas:this.globalFormulas,path:["apis",r,"headers"]});else for(let[o,n]of Object.entries(t.headers??{}))yield*(0,oe.getFormulasInFormula)({formula:n,globalFormulas:this.globalFormulas,path:["apis",r,"headers",o]});yield*(0,oe.getFormulasInFormula)({formula:t.body,globalFormulas:this.globalFormulas,path:["apis",r,"body"]});for(let[o,n]of Object.entries(t.onCompleted?.actions??{}))yield*(0,oe.getFormulasInAction)({action:n,globalFormulas:this.globalFormulas,path:["apis",r,"onCompleted","actions",o]});for(let[o,n]of Object.entries(t.onFailed?.actions??{}))yield*(0,oe.getFormulasInAction)({action:n,globalFormulas:this.globalFormulas,path:["apis",r,"onFailed","actions",o]})}};ft.LegacyToddleApi=cr});var mr=w(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});fr.getActionsInAction=ge;var Lc=x();function*ge(e,t=[]){if((0,Lc.isDefined)(e))switch(yield[t,e],e.type){case"SetVariable":case"SetURLParameter":case"TriggerEvent":case"TriggerWorkflow":break;case"Fetch":for(let[r,o]of Object.entries(e.onSuccess?.actions??{}))yield*ge(o,[...t,"onSuccess","actions",r]);for(let[r,o]of Object.entries(e.onError?.actions??{}))yield*ge(o,[...t,"onError","actions",r]);for(let[r,o]of Object.entries(e.onMessage?.actions??{}))yield*ge(o,[...t,"onMessage","actions",r]);break;case"Custom":case void 0:for(let[r,o]of Object.entries(e.events??{}))for(let[n,a]of Object.entries(o?.actions??{}))yield*ge(a,[...t,"events",r,"actions",n]);break;case"Switch":for(let[r,o]of e.cases.entries())for(let[n,a]of Object.entries(o?.actions??{}))yield*ge(a,[...t,"cases",r,"actions",n]);for(let[r,o]of Object.entries(e.default.actions))yield*ge(o,[...t,"default","actions",r]);break}}});var gr=w(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.ToddleApiV2=void 0;var pr=mr(),L=dt(),qc=x(),hr=class{api;_apiReferences;key;globalFormulas;constructor(t,r,o){this.api=t,this.key=r,this.globalFormulas=o}get apiReferences(){if(this._apiReferences)return this._apiReferences;let t=new Set,r=o=>{if((0,qc.isDefined)(o))switch(o.type){case"path":o.path[0]==="Apis"&&t.add(o.path[1]);break;case"value":break;case"record":o.entries.forEach(n=>r(n.formula));break;case"function":case"array":case"or":case"and":case"apply":case"object":o.arguments?.forEach(n=>r(n.formula));break;case"switch":o.cases.forEach(n=>{r(n.condition),r(n.formula)});break}};return r(this.api.autoFetch),r(this.api.url),Object.values(this.api.path??{}).forEach(o=>r(o.formula)),Object.values(this.api.headers??{}).forEach(o=>r(o.formula)),r(this.api.body),Object.values(this.api.inputs).forEach(o=>r(o.formula)),Object.values(this.api.queryParams??{}).forEach(o=>{r(o.formula)}),r(this.api.server?.proxy?.enabled?.formula),r(this.api.server?.ssr?.enabled?.formula),r(this.api.client?.debounce?.formula),Object.values(this.api.redirectRules??{}).forEach(o=>{r(o.formula)}),r(this.api.isError?.formula),r(this.api.timeout?.formula),t.delete(this.key),this._apiReferences=t,t}get version(){return this.api.version}get name(){return this.api.name}get type(){return this.api.type}get autoFetch(){return this.api.autoFetch}get url(){return this.api.url}get path(){return this.api.path}get headers(){return this.api.headers}set headers(t){this.api.headers=t}get method(){return this.api.method}get body(){return this.api.body}get inputs(){return this.api.inputs}get queryParams(){return this.api.queryParams}get server(){return this.api.server}get client(){return this.api.client}get redirectRules(){return this.api.redirectRules}get isError(){return this.api.isError}get timeout(){return this.api.timeout}*formulasInApi(){let t=this.api,r=this.key;for(let[o,n]of Object.entries(this.api.inputs))yield*(0,L.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"inputs",o,"formula"]});yield*(0,L.getFormulasInFormula)({formula:t.autoFetch,globalFormulas:this.globalFormulas,path:["apis",r,"autoFetch"]}),yield*(0,L.getFormulasInFormula)({formula:t.url,globalFormulas:this.globalFormulas,path:["apis",r,"url"]});for(let[o,n]of Object.entries(t.path??{}))yield*(0,L.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"path",o,"formula"]});for(let[o,n]of Object.entries(t.queryParams??{}))yield*(0,L.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"queryParams",o,"formula"]}),yield*(0,L.getFormulasInFormula)({formula:n.enabled,globalFormulas:this.globalFormulas,path:["apis",r,"queryParams",o,"enabled"]});for(let[o,n]of Object.entries(t.headers??{}))yield*(0,L.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"headers",o,"formula"]}),yield*(0,L.getFormulasInFormula)({formula:n.enabled,globalFormulas:this.globalFormulas,path:["apis",r,"headers",o,"enabled"]});yield*(0,L.getFormulasInFormula)({formula:t.body,globalFormulas:this.globalFormulas,path:["apis",r,"body"]});for(let[o,n]of Object.entries(t.client?.onCompleted?.actions??{}))yield*(0,L.getFormulasInAction)({action:n,globalFormulas:this.globalFormulas,path:["apis",r,"client","onCompleted","actions",o]});for(let[o,n]of Object.entries(t.client?.onFailed?.actions??{}))yield*(0,L.getFormulasInAction)({action:n,globalFormulas:this.globalFormulas,path:["apis",r,"client","onFailed","actions",o]});yield*(0,L.getFormulasInFormula)({formula:t.client?.debounce?.formula,globalFormulas:this.globalFormulas,path:["apis",r,"client","debounce","formula"]});for(let[o,n]of Object.entries(t.client?.onMessage?.actions??{}))yield*(0,L.getFormulasInAction)({action:n,globalFormulas:this.globalFormulas,path:["apis",r,"client","onMessage","actions",o]});for(let[o,n]of Object.entries(t.redirectRules??{}))yield*(0,L.getFormulasInFormula)({formula:n.formula,globalFormulas:this.globalFormulas,path:["apis",r,"redirectRules",o,"formula"]});yield*(0,L.getFormulasInFormula)({formula:t.isError?.formula,globalFormulas:this.globalFormulas,path:["apis",r,"isError","formula"]}),yield*(0,L.getFormulasInFormula)({formula:t.timeout?.formula,globalFormulas:this.globalFormulas,path:["apis",r,"timeout","formula"]}),yield*(0,L.getFormulasInFormula)({formula:t.server?.proxy?.enabled.formula,globalFormulas:this.globalFormulas,path:["apis",r,"server","proxy","enabled","formula"]}),yield*(0,L.getFormulasInFormula)({formula:t.server?.ssr?.enabled?.formula,globalFormulas:this.globalFormulas,path:["apis",r,"server","ssr","enabled","formula"]})}*actionModelsInApi(){for(let[t,r]of Object.entries(this.api.client?.onCompleted?.actions??{}))yield*(0,pr.getActionsInAction)(r,["apis",this.key,"client","onCompleted","actions",t]);for(let[t,r]of Object.entries(this.api.client?.onFailed?.actions??{}))yield*(0,pr.getActionsInAction)(r,["apis",this.key,"client","onFailed","actions",t]);for(let[t,r]of Object.entries(this.api.client?.onMessage?.actions??{}))yield*(0,pr.getActionsInAction)(r,["apis",this.key,"client","onData","actions",t])}};mt.ToddleApiV2=hr});var qe=w(S=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});S.sortApiEntries=S.sortApiObjects=S.createApiEvent=S.isApiError=S.requestHash=S.getBaseUrl=S.getRequestHeaders=S.getRequestQueryParams=S.getRequestPath=S.applyAbortSignal=S.getUrl=S.createApiRequest=S.isLegacyApi=S.NON_BODY_RESPONSE_CODES=void 0;var ne=V(),da=Q(),Mc=sa(),de=x(),ye=la(),fa=dr(),Uc=gr();S.NON_BODY_RESPONSE_CODES=[101,204,205,304];var Bc=e=>e instanceof fa.LegacyToddleApi?!0:!("version"in e);S.isLegacyApi=Bc;var Vc=({api:e,formulaContext:t,baseUrl:r,defaultHeaders:o})=>{let n=(0,S.getUrl)(e,t,r),a=Gc({api:e,formulaContext:t,defaultHeaders:o});return{url:n,requestSettings:a}};S.createApiRequest=Vc;var Kc=(e,t,r)=>{let o="",n=new URLSearchParams,a,s=(0,ne.applyFormula)(e.url,t);if(["string","number"].includes(typeof s)){let d=typeof s=="number"?String(s):s;try{a=new URL(d,r),o=a.pathname,n=a.searchParams}catch{}}let i=(0,S.getRequestPath)(e.path,t),l=`${o}${i.length>0&&!o.endsWith("/")?"/":""}${i}`,u=new URLSearchParams([...n,...(0,S.getRequestQueryParams)(e.queryParams,t)]),c=[...u.entries()].length>0?`?${u.toString()}`:"";if(a){let d=new URL(a.origin,r);return d.pathname=l,d.search=u.toString(),d}else return new URL(`${l}${c}`,r)};S.getUrl=Kc;var Wc=[ye.ApiMethod.POST,ye.ApiMethod.DELETE,ye.ApiMethod.PUT,ye.ApiMethod.PATCH,ye.ApiMethod.OPTIONS],zc=(e,t,r)=>{if(e.timeout){let o=(0,ne.applyFormula)(e.timeout.formula,r);typeof o=="number"&&!Number.isNaN(o)&&o>0&&(t.signal=AbortSignal.timeout(o))}};S.applyAbortSignal=zc;var Gc=({api:e,formulaContext:t,defaultHeaders:r})=>{let o=Object.values(ye.ApiMethod).includes(e.method)?e.method:ye.ApiMethod.GET,n=(0,S.getRequestHeaders)({apiHeaders:e.headers,formulaContext:t,defaultHeaders:r}),a=td({api:e,formulaContext:t,headers:n,method:o});n.get("content-type")==="multipart/form-data"&&n.delete("content-type");let s={method:o,headers:n,body:a};return(0,S.applyAbortSignal)(e,s,t),s},Jc=(e,t)=>(0,da.sortObjectEntries)(e??{},([r,o])=>o.index).map(([r,o])=>(0,ne.applyFormula)(o.formula,t)).join("/");S.getRequestPath=Jc;var Xc=(e,t)=>{let r=new URLSearchParams;return Object.entries(e??{}).forEach(([o,n])=>{if(!((0,de.isDefined)(n.enabled)?(0,ne.applyFormula)(n.enabled,t):!0))return;let s=(0,ne.applyFormula)(n.formula,t);if((0,de.isDefined)(s))if(Array.isArray(s))s.forEach(i=>r.append(o,String(i)));else if((0,de.isObject)(s)){let i=(l,u)=>{Object.entries(l).forEach(([c,d])=>{if(!Array.isArray(d)&&(0,de.isObject)(d))return i(d,`${u}[${c}]`);r.set(`${u}[${c}]`,String(d))})};i(s,o)}else r.set(o,String(s))}),r};S.getRequestQueryParams=Xc;var Qc=({apiHeaders:e,formulaContext:t,defaultHeaders:r})=>{let o=new Headers(r);return Object.entries(e??{}).forEach(([n,a])=>{if((0,de.isDefined)(a.enabled)?(0,ne.applyFormula)(a.enabled,t):!0){let i=(0,ne.applyFormula)(a.formula,t);if((0,de.isDefined)(i))try{o.set(n.trim(),(typeof i=="string"?i:String(i)).trim())}catch{}}}),o};S.getRequestHeaders=Qc;var Yc=({origin:e,url:t})=>!(0,de.isDefined)(t)||t===""||t.startsWith("/")?e+t:t;S.getBaseUrl=Yc;var Zc=(e,t)=>(0,Mc.hash)(JSON.stringify({url:e.href,method:t.method,headers:(0,da.omitKeys)(Object.fromEntries(Object.entries(t.headers??{})),["host","cookie"]),body:t.body??null}));S.requestHash=Zc;var ed=({apiName:e,response:t,formulaContext:r,errorFormula:o,performance:n})=>{let a=o?(0,ne.applyFormula)(o.formula,{component:r.component,package:r.package,toddle:r.toddle,data:{Attributes:{},Args:r.data.Args,Apis:{[e]:{isLoading:!1,data:t.body,error:null,response:{status:t.status,headers:t.headers,performance:n}}}},env:r.env}):null;return a==null?!t.ok:(0,de.toBoolean)(a)};S.isApiError=ed;var td=({api:e,formulaContext:t,headers:r,method:o})=>{if(!e.body||!Wc.includes(o))return;let n=(0,ne.applyFormula)(e.body,t);if(n)switch(r.get("content-type")){case"application/x-www-form-urlencoded":return typeof n=="object"&&n!==null?Object.entries(n).map(([a,s])=>Array.isArray(s)?s.map(i=>`${encodeURIComponent(a)}=${encodeURIComponent(i)}`).join("&"):`${encodeURIComponent(a)}=${encodeURIComponent(String(s))}`).join("&"):"";case"multipart/form-data":{let a=new FormData;return typeof n=="object"&&n!==null&&Object.entries(n).forEach(([s,i])=>{a.set(s,i)}),a}case"text/plain":return String(n);default:return JSON.stringify(n)}},rd=(e,t)=>new CustomEvent(e,{detail:t});S.createApiEvent=rd;var ma=(e,t)=>{let r=e.apiReferences.has(t.name),o=t.apiReferences.has(e.name);return r===o?0:r?1:-1},od=e=>{let t=new Map,r=(o,n)=>{let a=t.get(n);return a||(a=o.version===2?new Uc.ToddleApiV2(o,n,{formulas:{},packages:{}}):new fa.LegacyToddleApi(o,n,{formulas:{},packages:{}}),t.set(n,a)),a};return[...e].sort(([o,n],[a,s])=>{let i=r(n,o),l=r(s,a);return ma(i,l)})};S.sortApiObjects=od;var nd=e=>[...e].sort(([t,r],[o,n])=>ma(r,n));S.sortApiEntries=nd});var ee=w(z=>{"use strict";Object.defineProperty(z,"__esModule",{value:!0});z.REWRITE_HEADER=z.PROXY_URL_HEADER=z.validateUrl=z.isLocalhostHostname=z.isLocalhostUrl=void 0;var ad=["http://localhost:54404","http://preview.localhost:54404"],sd=e=>ad.some(t=>e.startsWith(t));z.isLocalhostUrl=sd;var id=e=>e==="localhost"||e==="127.0.0.1";z.isLocalhostHostname=id;var ld=(e,t)=>{if(typeof e!="string")return!1;try{let r=new URL(e,t);return r.searchParams.forEach((o,n)=>{r.searchParams.set(n,o)}),r}catch{return!1}};z.validateUrl=ld;z.PROXY_URL_HEADER="x-toddle-url";z.REWRITE_HEADER="x-toddle-rewrite"});var ga=w(pt=>{"use strict";Object.defineProperty(pt,"__esModule",{value:!0});pt.parse=hd;pt.serialize=gd;var ud=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,cd=/^[\u0021-\u003A\u003C-\u007E]*$/,dd=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,fd=/^[\u0020-\u003A\u003D-\u007E]*$/,md=Object.prototype.toString,pd=(()=>{let e=function(){};return e.prototype=Object.create(null),e})();function hd(e,t){let r=new pd,o=e.length;if(o<2)return r;let n=t?.decode||yd,a=0;do{let s=e.indexOf("=",a);if(s===-1)break;let i=e.indexOf(";",a),l=i===-1?o:i;if(s>l){a=e.lastIndexOf(";",s-1)+1;continue}let u=pa(e,a,s),c=ha(e,s,u),d=e.slice(u,c);if(r[d]===void 0){let h=pa(e,s+1,l),f=ha(e,l,h),y=n(e.slice(h,f));r[d]=y}a=l+1}while(a<o);return r}function pa(e,t,r){do{let o=e.charCodeAt(t);if(o!==32&&o!==9)return t}while(++t<r);return r}function ha(e,t,r){for(;t>r;){let o=e.charCodeAt(--t);if(o!==32&&o!==9)return t+1}return r}function gd(e,t,r){let o=r?.encode||encodeURIComponent;if(!ud.test(e))throw new TypeError(`argument name is invalid: ${e}`);let n=o(t);if(!cd.test(n))throw new TypeError(`argument val is invalid: ${t}`);let a=e+"="+n;if(!r)return a;if(r.maxAge!==void 0){if(!Number.isInteger(r.maxAge))throw new TypeError(`option maxAge is invalid: ${r.maxAge}`);a+="; Max-Age="+r.maxAge}if(r.domain){if(!dd.test(r.domain))throw new TypeError(`option domain is invalid: ${r.domain}`);a+="; Domain="+r.domain}if(r.path){if(!fd.test(r.path))throw new TypeError(`option path is invalid: ${r.path}`);a+="; Path="+r.path}if(r.expires){if(!bd(r.expires)||!Number.isFinite(r.expires.valueOf()))throw new TypeError(`option expires is invalid: ${r.expires}`);a+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(a+="; HttpOnly"),r.secure&&(a+="; Secure"),r.partitioned&&(a+="; Partitioned"),r.priority)switch(typeof r.priority=="string"?r.priority.toLowerCase():void 0){case"low":a+="; Priority=Low";break;case"medium":a+="; Priority=Medium";break;case"high":a+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${r.priority}`)}if(r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:case"strict":a+="; SameSite=Strict";break;case"lax":a+="; SameSite=Lax";break;case"none":a+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${r.sameSite}`)}return a}function yd(e){if(e.indexOf("%")===-1)return e;try{return decodeURIComponent(e)}catch{return e}}function bd(e){return md.call(e)==="[object Date]"}});var yr=w(ht=>{"use strict";Object.defineProperty(ht,"__esModule",{value:!0});ht.getRequestCookies=void 0;var ya=x(),vd=ga(),Fd=e=>Object.fromEntries(Object.entries((0,vd.parse)(e.headers.get("cookie")??"")).filter(t=>(0,ya.isDefined)(t[0])&&(0,ya.isDefined)(t[1])));ht.getRequestCookies=Fd});var br=w(gt=>{"use strict";Object.defineProperty(gt,"__esModule",{value:!0});gt.STRING_TEMPLATE=void 0;var Ad=(e,t)=>`{{ ${wd[e]}.${t} }}`;gt.STRING_TEMPLATE=Ad;var wd={cookies:"cookies"}});var ba=w(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.skipToddleHeader=xe.skipCookieHeader=void 0;var Ed=ee(),Od=e=>{let t=new Headers(e);return t.delete("cookie"),t};xe.skipCookieHeader=Od;var xd=e=>{let t=new Headers(e);return t.delete(Ed.PROXY_URL_HEADER),t};xe.skipToddleHeader=xd});var Fa=w(te=>{"use strict";Object.defineProperty(te,"__esModule",{value:!0});te.mapTemplateHeaders=te.sanitizeProxyHeaders=te.applyTemplateValues=void 0;var jd=br(),Sd=x(),va=ba(),Cd=(e,t)=>{if(!(0,Sd.isDefined)(e))return"";let r=/{{ cookies\.(.+?) }}/gm,o=e,n=new Set,a;for(;(a=r.exec(e))!==null;)a.index===r.lastIndex&&r.lastIndex++,n.add(a[1]);for(let s of n){let i=t[s];i&&(o=o.replaceAll((0,jd.STRING_TEMPLATE)("cookies",s),i))}return o};te.applyTemplateValues=Cd;var _d=({cookies:e,headers:t})=>new Headers((0,te.mapTemplateHeaders)({cookies:e,headers:(0,va.skipCookieHeader)((0,va.skipToddleHeader)(t))}));te.sanitizeProxyHeaders=_d;var kd=({cookies:e,headers:t})=>new Headers([...t.entries()].map(([r,o])=>[r,(0,te.applyTemplateValues)(o,e)]));te.mapTemplateHeaders=kd});var vr=w(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.isPageComponent=void 0;var Rd=x(),Td=e=>(0,Rd.isDefined)(e.route);bt.isPageComponent=Td});var Ft=w(vt=>{"use strict";Object.defineProperty(vt,"__esModule",{value:!0});vt.ToddleComponent=void 0;var Oa=qe(),Hd=dr(),Pd=gr(),_=dt(),xa=x(),je=mr(),Dd=vr(),Fr=class e{component;globalFormulas;getComponent;packageName;constructor({component:t,getComponent:r,packageName:o,globalFormulas:n}){this.component=t,this.getComponent=r,this.packageName=o,this.globalFormulas=n}get uniqueSubComponents(){let t=new Map,r=o=>n=>{if(n.type!=="component"||t.has(n.name))return;let a=this.getComponent(n.name,n.package??o);a&&(t.set(a.name,new e({component:a,getComponent:this.getComponent,packageName:n.package??o,globalFormulas:this.globalFormulas})),Object.values(a.nodes).forEach(r(n.package??o)))};return Object.values(this.nodes).forEach(r()),[...t.values()]}get formulaReferences(){return new Set(Array.from(this.formulasInComponent()).filter(([,t])=>t.type==="function").map(([,t])=>t).map(t=>[t.package,t.name].filter(xa.isDefined).join("/")))}get actionReferences(){return new Set(Array.from(this.actionModelsInComponent()).map(([,t])=>t.type==="Custom"||t.type===void 0?[t.package,t.name].filter(xa.isDefined).join("/"):t.type))}*formulasInComponent(){let t=this.globalFormulas;function*r(o,n=[]){switch(o.type){case"text":yield*(0,_.getFormulasInFormula)({formula:o.condition,globalFormulas:t,path:[...n,"condition"]}),yield*(0,_.getFormulasInFormula)({formula:o.repeat,globalFormulas:t,path:[...n,"repeat"]}),yield*(0,_.getFormulasInFormula)({formula:o.repeatKey,globalFormulas:t,path:[...n,"repeatKey"]}),yield*(0,_.getFormulasInFormula)({formula:o.value,globalFormulas:t,path:[...n,"value"]});break;case"slot":yield*(0,_.getFormulasInFormula)({formula:o.condition,globalFormulas:t,path:[...n,"condition"]});break;case"component":yield*(0,_.getFormulasInFormula)({formula:o.condition,globalFormulas:t,path:[...n,"condition"]}),yield*(0,_.getFormulasInFormula)({formula:o.repeat,globalFormulas:t,path:[...n,"repeat"]}),yield*(0,_.getFormulasInFormula)({formula:o.repeatKey,globalFormulas:t,path:[...n,"repeatKey"]});for(let[a,s]of Object.entries(o.attrs??{}))yield*(0,_.getFormulasInFormula)({formula:s,globalFormulas:t,path:[...n,"attrs",a]});for(let[a,s]of Object.entries(o.events??{}))for(let[i,l]of Object.entries(s?.actions??{}))yield*(0,_.getFormulasInAction)({action:l,globalFormulas:t,path:[...n,"events",a,"actions",i]});break;case"element":yield*(0,_.getFormulasInFormula)({formula:o.condition,globalFormulas:t,path:[...n,"condition"]}),yield*(0,_.getFormulasInFormula)({formula:o.repeat,globalFormulas:t,path:[...n,"repeat"]}),yield*(0,_.getFormulasInFormula)({formula:o.repeatKey,globalFormulas:t,path:[...n,"repeatKey"]});for(let[a,s]of Object.entries(o.attrs??{}))yield*(0,_.getFormulasInFormula)({formula:s,globalFormulas:t,path:[...n,"attrs",a]});for(let[a,s]of Object.entries(o.events??{}))for(let[i,l]of Object.entries(s?.actions??{}))yield*(0,_.getFormulasInAction)({action:l,globalFormulas:t,path:[...n,"events",a,"actions",i]});for(let[a,s]of Object.entries(o.classes??{}))yield*(0,_.getFormulasInFormula)({formula:s.formula,globalFormulas:t,path:[...n,"classes",a,"formula"]});for(let[a,s]of Object.entries(o["style-variables"]??{}))yield*(0,_.getFormulasInFormula)({formula:s.formula,globalFormulas:t,path:[...n,"style-variables",a,"formula"]});break}}yield*(0,_.getFormulasInFormula)({formula:this.route?.info?.language?.formula,globalFormulas:t,path:["route","info","language","formula"]}),yield*(0,_.getFormulasInFormula)({formula:this.route?.info?.title?.formula,globalFormulas:t,path:["route","info","title","formula"]}),yield*(0,_.getFormulasInFormula)({formula:this.route?.info?.description?.formula,globalFormulas:t,path:["route","info","description","formula"]}),yield*(0,_.getFormulasInFormula)({formula:this.route?.info?.icon?.formula,globalFormulas:t,path:["route","info","icon","formula"]}),yield*(0,_.getFormulasInFormula)({formula:this.route?.info?.charset?.formula,globalFormulas:t,path:["route","info","charset","formula"]});for(let[o,n]of Object.entries(this.route?.info?.meta??{})){yield*(0,_.getFormulasInFormula)({formula:n.content,globalFormulas:t,path:["route","info","meta",o,"content"]});for(let[a,s]of Object.entries(n.attrs))yield*(0,_.getFormulasInFormula)({formula:s,globalFormulas:t,path:["route","info","meta",o,"attrs",a]})}for(let[o,n]of Object.entries(this.formulas??{}))yield*(0,_.getFormulasInFormula)({formula:n.formula,globalFormulas:t,path:["formulas",o,"formula"]});for(let[o,n]of Object.entries(this.variables??{}))yield*(0,_.getFormulasInFormula)({formula:n.initialValue,globalFormulas:t,path:["variables",o,"initialValue"]});for(let[o,n]of Object.entries(this.workflows??{}))for(let[a,s]of n.actions.entries())yield*(0,_.getFormulasInAction)({action:s,globalFormulas:t,path:["workflows",o,"actions",a]});for(let[,o]of Object.entries(this.apis))yield*o.formulasInApi();for(let[o,n]of Object.entries(this.component.onLoad?.actions??{}))yield*(0,_.getFormulasInAction)({action:n,globalFormulas:t,path:["onLoad","actions",o]});for(let[o,n]of Object.entries(this.component.onAttributeChange?.actions??{}))yield*(0,_.getFormulasInAction)({action:n,globalFormulas:t,path:["onAttributeChange","actions",o]});for(let[o,n]of Object.entries(this.nodes??{}))yield*r(n,["nodes",o])}*actionModelsInComponent(){function*t(r,o=[]){switch(r.type){case"text":case"slot":break;case"component":case"element":for(let[n,a]of Object.entries(r.events??{}))for(let[s,i]of Object.entries(a?.actions??{}))yield*(0,je.getActionsInAction)(i,[...o,"events",n,"actions",s]);break}}for(let[r,o]of Object.entries(this.workflows??{}))for(let[n,a]of Object.entries(o?.actions??{}))yield*(0,je.getActionsInAction)(a,["workflows",r,"actions",n]);for(let[r,o]of Object.entries(this.apis??{})){if(!(0,Oa.isLegacyApi)(o)){yield*o.actionModelsInApi();continue}for(let[n,a]of Object.entries(o.onCompleted?.actions??{}))yield*(0,je.getActionsInAction)(a,["apis",r,"onCompleted","actions",n]);for(let[n,a]of Object.entries(o.onFailed?.actions??{}))yield*(0,je.getActionsInAction)(a,["apis",r,"onFailed","actions",n])}for(let[r,o]of Object.entries(this.component.onLoad?.actions??{}))yield*(0,je.getActionsInAction)(o,["onLoad","actions",r]);for(let[r,o]of Object.entries(this.component.onAttributeChange?.actions??{}))yield*(0,je.getActionsInAction)(o,["onAttributeChange","actions",r]);for(let[r,o]of Object.entries(this.nodes??{}))yield*t(o,["nodes",r])}get formulas(){return this.component.formulas}get name(){return this.component.name}get route(){return this.component.route}get attributes(){return this.component.attributes}get variables(){return this.component.variables}get workflows(){return this.component.workflows}get apis(){return Object.fromEntries(Object.entries(this.component.apis??{}).map(([t,r])=>[t,(0,Oa.isLegacyApi)(r)?new Hd.LegacyToddleApi(r,t,this.globalFormulas):new Pd.ToddleApiV2(r,t,this.globalFormulas)]))}get nodes(){return this.component.nodes}get events(){return this.component.events}get onLoad(){return this.component.onLoad}get onAttributeChange(){return this.component.onAttributeChange}get isPage(){return(0,Dd.isPageComponent)(this.component)}};vt.ToddleComponent=Fr});var wr=w(Se=>{function ka(){var e={};return e["align-content"]=!1,e["align-items"]=!1,e["align-self"]=!1,e["alignment-adjust"]=!1,e["alignment-baseline"]=!1,e.all=!1,e["anchor-point"]=!1,e.animation=!1,e["animation-delay"]=!1,e["animation-direction"]=!1,e["animation-duration"]=!1,e["animation-fill-mode"]=!1,e["animation-iteration-count"]=!1,e["animation-name"]=!1,e["animation-play-state"]=!1,e["animation-timing-function"]=!1,e.azimuth=!1,e["backface-visibility"]=!1,e.background=!0,e["background-attachment"]=!0,e["background-clip"]=!0,e["background-color"]=!0,e["background-image"]=!0,e["background-origin"]=!0,e["background-position"]=!0,e["background-repeat"]=!0,e["background-size"]=!0,e["baseline-shift"]=!1,e.binding=!1,e.bleed=!1,e["bookmark-label"]=!1,e["bookmark-level"]=!1,e["bookmark-state"]=!1,e.border=!0,e["border-bottom"]=!0,e["border-bottom-color"]=!0,e["border-bottom-left-radius"]=!0,e["border-bottom-right-radius"]=!0,e["border-bottom-style"]=!0,e["border-bottom-width"]=!0,e["border-collapse"]=!0,e["border-color"]=!0,e["border-image"]=!0,e["border-image-outset"]=!0,e["border-image-repeat"]=!0,e["border-image-slice"]=!0,e["border-image-source"]=!0,e["border-image-width"]=!0,e["border-left"]=!0,e["border-left-color"]=!0,e["border-left-style"]=!0,e["border-left-width"]=!0,e["border-radius"]=!0,e["border-right"]=!0,e["border-right-color"]=!0,e["border-right-style"]=!0,e["border-right-width"]=!0,e["border-spacing"]=!0,e["border-style"]=!0,e["border-top"]=!0,e["border-top-color"]=!0,e["border-top-left-radius"]=!0,e["border-top-right-radius"]=!0,e["border-top-style"]=!0,e["border-top-width"]=!0,e["border-width"]=!0,e.bottom=!1,e["box-decoration-break"]=!0,e["box-shadow"]=!0,e["box-sizing"]=!0,e["box-snap"]=!0,e["box-suppress"]=!0,e["break-after"]=!0,e["break-before"]=!0,e["break-inside"]=!0,e["caption-side"]=!1,e.chains=!1,e.clear=!0,e.clip=!1,e["clip-path"]=!1,e["clip-rule"]=!1,e.color=!0,e["color-interpolation-filters"]=!0,e["column-count"]=!1,e["column-fill"]=!1,e["column-gap"]=!1,e["column-rule"]=!1,e["column-rule-color"]=!1,e["column-rule-style"]=!1,e["column-rule-width"]=!1,e["column-span"]=!1,e["column-width"]=!1,e.columns=!1,e.contain=!1,e.content=!1,e["counter-increment"]=!1,e["counter-reset"]=!1,e["counter-set"]=!1,e.crop=!1,e.cue=!1,e["cue-after"]=!1,e["cue-before"]=!1,e.cursor=!1,e.direction=!1,e.display=!0,e["display-inside"]=!0,e["display-list"]=!0,e["display-outside"]=!0,e["dominant-baseline"]=!1,e.elevation=!1,e["empty-cells"]=!1,e.filter=!1,e.flex=!1,e["flex-basis"]=!1,e["flex-direction"]=!1,e["flex-flow"]=!1,e["flex-grow"]=!1,e["flex-shrink"]=!1,e["flex-wrap"]=!1,e.float=!1,e["float-offset"]=!1,e["flood-color"]=!1,e["flood-opacity"]=!1,e["flow-from"]=!1,e["flow-into"]=!1,e.font=!0,e["font-family"]=!0,e["font-feature-settings"]=!0,e["font-kerning"]=!0,e["font-language-override"]=!0,e["font-size"]=!0,e["font-size-adjust"]=!0,e["font-stretch"]=!0,e["font-style"]=!0,e["font-synthesis"]=!0,e["font-variant"]=!0,e["font-variant-alternates"]=!0,e["font-variant-caps"]=!0,e["font-variant-east-asian"]=!0,e["font-variant-ligatures"]=!0,e["font-variant-numeric"]=!0,e["font-variant-position"]=!0,e["font-weight"]=!0,e.grid=!1,e["grid-area"]=!1,e["grid-auto-columns"]=!1,e["grid-auto-flow"]=!1,e["grid-auto-rows"]=!1,e["grid-column"]=!1,e["grid-column-end"]=!1,e["grid-column-start"]=!1,e["grid-row"]=!1,e["grid-row-end"]=!1,e["grid-row-start"]=!1,e["grid-template"]=!1,e["grid-template-areas"]=!1,e["grid-template-columns"]=!1,e["grid-template-rows"]=!1,e["hanging-punctuation"]=!1,e.height=!0,e.hyphens=!1,e.icon=!1,e["image-orientation"]=!1,e["image-resolution"]=!1,e["ime-mode"]=!1,e["initial-letters"]=!1,e["inline-box-align"]=!1,e["justify-content"]=!1,e["justify-items"]=!1,e["justify-self"]=!1,e.left=!1,e["letter-spacing"]=!0,e["lighting-color"]=!0,e["line-box-contain"]=!1,e["line-break"]=!1,e["line-grid"]=!1,e["line-height"]=!1,e["line-snap"]=!1,e["line-stacking"]=!1,e["line-stacking-ruby"]=!1,e["line-stacking-shift"]=!1,e["line-stacking-strategy"]=!1,e["list-style"]=!0,e["list-style-image"]=!0,e["list-style-position"]=!0,e["list-style-type"]=!0,e.margin=!0,e["margin-bottom"]=!0,e["margin-left"]=!0,e["margin-right"]=!0,e["margin-top"]=!0,e["marker-offset"]=!1,e["marker-side"]=!1,e.marks=!1,e.mask=!1,e["mask-box"]=!1,e["mask-box-outset"]=!1,e["mask-box-repeat"]=!1,e["mask-box-slice"]=!1,e["mask-box-source"]=!1,e["mask-box-width"]=!1,e["mask-clip"]=!1,e["mask-image"]=!1,e["mask-origin"]=!1,e["mask-position"]=!1,e["mask-repeat"]=!1,e["mask-size"]=!1,e["mask-source-type"]=!1,e["mask-type"]=!1,e["max-height"]=!0,e["max-lines"]=!1,e["max-width"]=!0,e["min-height"]=!0,e["min-width"]=!0,e["move-to"]=!1,e["nav-down"]=!1,e["nav-index"]=!1,e["nav-left"]=!1,e["nav-right"]=!1,e["nav-up"]=!1,e["object-fit"]=!1,e["object-position"]=!1,e.opacity=!1,e.order=!1,e.orphans=!1,e.outline=!1,e["outline-color"]=!1,e["outline-offset"]=!1,e["outline-style"]=!1,e["outline-width"]=!1,e.overflow=!1,e["overflow-wrap"]=!1,e["overflow-x"]=!1,e["overflow-y"]=!1,e.padding=!0,e["padding-bottom"]=!0,e["padding-left"]=!0,e["padding-right"]=!0,e["padding-top"]=!0,e.page=!1,e["page-break-after"]=!1,e["page-break-before"]=!1,e["page-break-inside"]=!1,e["page-policy"]=!1,e.pause=!1,e["pause-after"]=!1,e["pause-before"]=!1,e.perspective=!1,e["perspective-origin"]=!1,e.pitch=!1,e["pitch-range"]=!1,e["play-during"]=!1,e.position=!1,e["presentation-level"]=!1,e.quotes=!1,e["region-fragment"]=!1,e.resize=!1,e.rest=!1,e["rest-after"]=!1,e["rest-before"]=!1,e.richness=!1,e.right=!1,e.rotation=!1,e["rotation-point"]=!1,e["ruby-align"]=!1,e["ruby-merge"]=!1,e["ruby-position"]=!1,e["shape-image-threshold"]=!1,e["shape-outside"]=!1,e["shape-margin"]=!1,e.size=!1,e.speak=!1,e["speak-as"]=!1,e["speak-header"]=!1,e["speak-numeral"]=!1,e["speak-punctuation"]=!1,e["speech-rate"]=!1,e.stress=!1,e["string-set"]=!1,e["tab-size"]=!1,e["table-layout"]=!1,e["text-align"]=!0,e["text-align-last"]=!0,e["text-combine-upright"]=!0,e["text-decoration"]=!0,e["text-decoration-color"]=!0,e["text-decoration-line"]=!0,e["text-decoration-skip"]=!0,e["text-decoration-style"]=!0,e["text-emphasis"]=!0,e["text-emphasis-color"]=!0,e["text-emphasis-position"]=!0,e["text-emphasis-style"]=!0,e["text-height"]=!0,e["text-indent"]=!0,e["text-justify"]=!0,e["text-orientation"]=!0,e["text-overflow"]=!0,e["text-shadow"]=!0,e["text-space-collapse"]=!0,e["text-transform"]=!0,e["text-underline-position"]=!0,e["text-wrap"]=!0,e.top=!1,e.transform=!1,e["transform-origin"]=!1,e["transform-style"]=!1,e.transition=!1,e["transition-delay"]=!1,e["transition-duration"]=!1,e["transition-property"]=!1,e["transition-timing-function"]=!1,e["unicode-bidi"]=!1,e["vertical-align"]=!1,e.visibility=!1,e["voice-balance"]=!1,e["voice-duration"]=!1,e["voice-family"]=!1,e["voice-pitch"]=!1,e["voice-range"]=!1,e["voice-rate"]=!1,e["voice-stress"]=!1,e["voice-volume"]=!1,e.volume=!1,e["white-space"]=!1,e.widows=!1,e.width=!0,e["will-change"]=!1,e["word-break"]=!0,e["word-spacing"]=!0,e["word-wrap"]=!0,e["wrap-flow"]=!1,e["wrap-through"]=!1,e["writing-mode"]=!1,e["z-index"]=!1,e}function Id(e,t,r){}function $d(e,t,r){}var Nd=/javascript\s*\:/img;function Ld(e,t){return Nd.test(t)?"":t}Se.whiteList=ka();Se.getDefaultWhiteList=ka;Se.onAttr=Id;Se.onIgnoreAttr=$d;Se.safeAttrValue=Ld});var Er=w((hb,Ra)=>{Ra.exports={indexOf:function(e,t){var r,o;if(Array.prototype.indexOf)return e.indexOf(t);for(r=0,o=e.length;r<o;r++)if(e[r]===t)return r;return-1},forEach:function(e,t,r){var o,n;if(Array.prototype.forEach)return e.forEach(t,r);for(o=0,n=e.length;o<n;o++)t.call(r,e[o],o,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(e){return String.prototype.trimRight?e.trimRight():e.replace(/(\s*$)/g,"")}}});var Ha=w((gb,Ta)=>{var Ve=Er();function qd(e,t){e=Ve.trimRight(e),e[e.length-1]!==";"&&(e+=";");var r=e.length,o=!1,n=0,a=0,s="";function i(){if(!o){var c=Ve.trim(e.slice(n,a)),d=c.indexOf(":");if(d!==-1){var h=Ve.trim(c.slice(0,d)),f=Ve.trim(c.slice(d+1));if(h){var y=t(n,s.length,h,f,c);y&&(s+=y+"; ")}}}n=a+1}for(;a<r;a++){var l=e[a];if(l==="/"&&e[a+1]==="*"){var u=e.indexOf("*/",a+2);if(u===-1)break;a=u+1,n=a+1,o=!1}else l==="("?o=!0:l===")"?o=!1:l===";"?o||i():l===`
`&&i()}return Ve.trim(s)}Ta.exports=qd});var $a=w((bb,Ia)=>{var At=wr(),Md=Ha(),yb=Er();function Pa(e){return e==null}function Ud(e){var t={};for(var r in e)t[r]=e[r];return t}function Da(e){e=Ud(e||{}),e.whiteList=e.whiteList||At.whiteList,e.onAttr=e.onAttr||At.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||At.onIgnoreAttr,e.safeAttrValue=e.safeAttrValue||At.safeAttrValue,this.options=e}Da.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,r=t.options,o=r.whiteList,n=r.onAttr,a=r.onIgnoreAttr,s=r.safeAttrValue,i=Md(e,function(l,u,c,d,h){var f=o[c],y=!1;if(f===!0?y=f:typeof f=="function"?y=f(d):f instanceof RegExp&&(y=f.test(d)),y!==!0&&(y=!1),d=s(c,d),!!d){var b={position:u,sourcePosition:l,source:h,isWhite:y};if(y){var g=n(c,d,b);return Pa(g)?c+":"+d:g}else{var g=a(c,d,b);if(!Pa(g))return g}}});return i};Ia.exports=Da});var Et=w((wt,xr)=>{var Na=wr(),La=$a();function Bd(e,t){var r=new La(t);return r.process(e)}wt=xr.exports=Bd;wt.FilterCSS=La;for(Or in Na)wt[Or]=Na[Or];var Or;typeof window<"u"&&(window.filterCSS=xr.exports)});var Ot=w((vb,qa)=>{qa.exports={indexOf:function(e,t){var r,o;if(Array.prototype.indexOf)return e.indexOf(t);for(r=0,o=e.length;r<o;r++)if(e[r]===t)return r;return-1},forEach:function(e,t,r){var o,n;if(Array.prototype.forEach)return e.forEach(t,r);for(o=0,n=e.length;o<n;o++)t.call(r,e[o],o,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(e){var t=/\s|\n|\t/,r=t.exec(e);return r?r.index:-1}}});var jr=w(P=>{var Vd=Et().FilterCSS,Kd=Et().getDefaultWhiteList,jt=Ot();function Ba(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height","loading"],ins:["datetime"],kbd:[],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var Va=new Vd;function Wd(e,t,r){}function zd(e,t,r){}function Gd(e,t,r){}function Jd(e,t,r){}function Ka(e){return e.replace(Qd,"&lt;").replace(Yd,"&gt;")}function Xd(e,t,r,o){if(r=Qa(r),t==="href"||t==="src"){if(r=jt.trim(r),r==="#")return"#";if(!(r.substr(0,7)==="http://"||r.substr(0,8)==="https://"||r.substr(0,7)==="mailto:"||r.substr(0,4)==="tel:"||r.substr(0,11)==="data:image/"||r.substr(0,6)==="ftp://"||r.substr(0,2)==="./"||r.substr(0,3)==="../"||r[0]==="#"||r[0]==="/"))return""}else if(t==="background"){if(xt.lastIndex=0,xt.test(r))return""}else if(t==="style"){if(Ma.lastIndex=0,Ma.test(r)||(Ua.lastIndex=0,Ua.test(r)&&(xt.lastIndex=0,xt.test(r))))return"";o!==!1&&(o=o||Va,r=o.process(r))}return r=Ya(r),r}var Qd=/</g,Yd=/>/g,Zd=/"/g,ef=/&quot;/g,tf=/&#([a-zA-Z0-9]*);?/gim,rf=/&colon;?/gim,of=/&newline;?/gim,xt=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,Ma=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,Ua=/u\s*r\s*l\s*\(.*/gi;function Wa(e){return e.replace(Zd,"&quot;")}function za(e){return e.replace(ef,'"')}function Ga(e){return e.replace(tf,function(r,o){return o[0]==="x"||o[0]==="X"?String.fromCharCode(parseInt(o.substr(1),16)):String.fromCharCode(parseInt(o,10))})}function Ja(e){return e.replace(rf,":").replace(of," ")}function Xa(e){for(var t="",r=0,o=e.length;r<o;r++)t+=e.charCodeAt(r)<32?" ":e.charAt(r);return jt.trim(t)}function Qa(e){return e=za(e),e=Ga(e),e=Ja(e),e=Xa(e),e}function Ya(e){return e=Wa(e),e=Ka(e),e}function nf(){return""}function af(e,t){typeof t!="function"&&(t=function(){});var r=!Array.isArray(e);function o(s){return r?!0:jt.indexOf(e,s)!==-1}var n=[],a=!1;return{onIgnoreTag:function(s,i,l){if(o(s))if(l.isClosing){var u="[/removed]",c=l.position+u.length;return n.push([a!==!1?a:l.position,c]),a=!1,u}else return a||(a=l.position),"[removed]";else return t(s,i,l)},remove:function(s){var i="",l=0;return jt.forEach(n,function(u){i+=s.slice(l,u[0]),l=u[1]}),i+=s.slice(l),i}}}function sf(e){for(var t="",r=0;r<e.length;){var o=e.indexOf("<!--",r);if(o===-1){t+=e.slice(r);break}t+=e.slice(r,o);var n=e.indexOf("-->",o);if(n===-1)break;r=n+3}return t}function lf(e){var t=e.split("");return t=t.filter(function(r){var o=r.charCodeAt(0);return o===127?!1:o<=31?o===10||o===13:!0}),t.join("")}P.whiteList=Ba();P.getDefaultWhiteList=Ba;P.onTag=Wd;P.onIgnoreTag=zd;P.onTagAttr=Gd;P.onIgnoreTagAttr=Jd;P.safeAttrValue=Xd;P.escapeHtml=Ka;P.escapeQuote=Wa;P.unescapeQuote=za;P.escapeHtmlEntities=Ga;P.escapeDangerHtml5Entities=Ja;P.clearNonPrintableCharacter=Xa;P.friendlyAttrValue=Qa;P.escapeAttrValue=Ya;P.onIgnoreTagStripAll=nf;P.StripTagBody=af;P.stripCommentTag=sf;P.stripBlankChar=lf;P.attributeWrapSign='"';P.cssFilter=Va;P.getDefaultCSSWhiteList=Kd});var Cr=w(Sr=>{var fe=Ot();function uf(e){var t=fe.spaceIndex(e),r;return t===-1?r=e.slice(1,-1):r=e.slice(1,t+1),r=fe.trim(r).toLowerCase(),r.slice(0,1)==="/"&&(r=r.slice(1)),r.slice(-1)==="/"&&(r=r.slice(0,-1)),r}function cf(e){return e.slice(0,2)==="</"}function df(e,t,r){"use strict";var o="",n=0,a=!1,s=!1,i=0,l=e.length,u="",c="";e:for(i=0;i<l;i++){var d=e.charAt(i);if(a===!1){if(d==="<"){a=i;continue}}else if(s===!1){if(d==="<"){o+=r(e.slice(n,i)),a=i,n=i;continue}if(d===">"||i===l-1){o+=r(e.slice(n,a)),c=e.slice(a,i+1),u=uf(c),o+=t(a,o.length,u,c,cf(c)),n=i+1,a=!1;continue}if(d==='"'||d==="'")for(var h=1,f=e.charAt(i-h);f.trim()===""||f==="=";){if(f==="="){s=d;continue e}f=e.charAt(i-++h)}}else if(d===s){s=!1;continue}}return n<l&&(o+=r(e.substr(n))),o}var ff=/[^a-zA-Z0-9\\_:.-]/gim;function mf(e,t){"use strict";var r=0,o=0,n=[],a=!1,s=e.length;function i(h,f){if(h=fe.trim(h),h=h.replace(ff,"").toLowerCase(),!(h.length<1)){var y=t(h,f||"");y&&n.push(y)}}for(var l=0;l<s;l++){var u=e.charAt(l),c,d;if(a===!1&&u==="="){a=e.slice(r,l),r=l+1,o=e.charAt(r)==='"'||e.charAt(r)==="'"?r:hf(e,l+1);continue}if(a!==!1&&l===o){if(d=e.indexOf(u,l+1),d===-1)break;c=fe.trim(e.slice(o+1,d)),i(a,c),a=!1,l=d,r=l+1;continue}if(/\s|\n|\t/.test(u))if(e=e.replace(/\s|\n|\t/g," "),a===!1)if(d=pf(e,l),d===-1){c=fe.trim(e.slice(r,l)),i(c),a=!1,r=l+1;continue}else{l=d-1;continue}else if(d=gf(e,l-1),d===-1){c=fe.trim(e.slice(r,l)),c=Za(c),i(a,c),a=!1,r=l+1;continue}else continue}return r<e.length&&(a===!1?i(e.slice(r)):i(a,Za(fe.trim(e.slice(r))))),fe.trim(n.join(" "))}function pf(e,t){for(;t<e.length;t++){var r=e[t];if(r!==" ")return r==="="?t:-1}}function hf(e,t){for(;t<e.length;t++){var r=e[t];if(r!==" ")return r==="'"||r==='"'?t:-1}}function gf(e,t){for(;t>0;t--){var r=e[t];if(r!==" ")return r==="="?t:-1}}function yf(e){return e[0]==='"'&&e[e.length-1]==='"'||e[0]==="'"&&e[e.length-1]==="'"}function Za(e){return yf(e)?e.substr(1,e.length-2):e}Sr.parseTag=df;Sr.parseAttr=mf});var os=w((wb,rs)=>{var bf=Et().FilterCSS,G=jr(),es=Cr(),vf=es.parseTag,Ff=es.parseAttr,Ct=Ot();function St(e){return e==null}function Af(e){var t=Ct.spaceIndex(e);if(t===-1)return{html:"",closing:e[e.length-2]==="/"};e=Ct.trim(e.slice(t+1,-1));var r=e[e.length-1]==="/";return r&&(e=Ct.trim(e.slice(0,-1))),{html:e,closing:r}}function wf(e){var t={};for(var r in e)t[r]=e[r];return t}function Ef(e){var t={};for(var r in e)Array.isArray(e[r])?t[r.toLowerCase()]=e[r].map(function(o){return o.toLowerCase()}):t[r.toLowerCase()]=e[r];return t}function ts(e){e=wf(e||{}),e.stripIgnoreTag&&(e.onIgnoreTag,e.onIgnoreTag=G.onIgnoreTagStripAll),e.whiteList||e.allowList?e.whiteList=Ef(e.whiteList||e.allowList):e.whiteList=G.whiteList,this.attributeWrapSign=e.singleQuotedAttributeValue===!0?"'":G.attributeWrapSign,e.onTag=e.onTag||G.onTag,e.onTagAttr=e.onTagAttr||G.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||G.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||G.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||G.safeAttrValue,e.escapeHtml=e.escapeHtml||G.escapeHtml,this.options=e,e.css===!1?this.cssFilter=!1:(e.css=e.css||{},this.cssFilter=new bf(e.css))}ts.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,r=t.options,o=r.whiteList,n=r.onTag,a=r.onIgnoreTag,s=r.onTagAttr,i=r.onIgnoreTagAttr,l=r.safeAttrValue,u=r.escapeHtml,c=t.attributeWrapSign,d=t.cssFilter;r.stripBlankChar&&(e=G.stripBlankChar(e)),r.allowCommentTag||(e=G.stripCommentTag(e));var h=!1;r.stripIgnoreTagBody&&(h=G.StripTagBody(r.stripIgnoreTagBody,a),a=h.onIgnoreTag);var f=vf(e,function(y,b,g,A,E){var O={sourcePosition:y,position:b,isClosing:E,isWhite:Object.prototype.hasOwnProperty.call(o,g)},F=n(g,A,O);if(!St(F))return F;if(O.isWhite){if(O.isClosing)return"</"+g+">";var C=Af(A),H=o[g],k=Ff(C.html,function(R,T){var re=Ct.indexOf(H,R)!==-1,$=s(g,R,T,re);return St($)?re?(T=l(g,R,T,d),T?R+"="+c+T+c:R):($=i(g,R,T,re),St($)?void 0:$):$});return A="<"+g,k&&(A+=" "+k),C.closing&&(A+=" /"),A+=">",A}else return F=a(g,A,O),St(F)?u(A):F},u);return h&&(f=h.remove(f)),f};rs.exports=ts});var kt=w((Ce,_t)=>{var ns=jr(),as=Cr(),ss=os();function is(e,t){var r=new ss(t);return r.process(e)}Ce=_t.exports=is;Ce.filterXSS=is;Ce.FilterXSS=ss;(function(){for(var e in ns)Ce[e]=ns[e];for(var t in as)Ce[t]=as[t]})();typeof window<"u"&&(window.filterXSS=_t.exports);function Of(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}Of()&&(self.filterXSS=_t.exports)});var cs=w(Tt=>{"use strict";Object.defineProperty(Tt,"__esModule",{value:!0});Tt.safeCustomElementName=void 0;var jf=e=>{let t=e.toLocaleLowerCase().replaceAll(" ","");return t.includes("-")?t:`toddle-${t}`};Tt.safeCustomElementName=jf});var Rr=w(kr=>{"use strict";Object.defineProperty(kr,"__esModule",{value:!0});kr.takeIncludedComponents=Sf;var ds=x();function Sf({root:e,projectComponents:t,packages:r={},includeRoot:o=!0}){let n={...t,...Object.fromEntries(Object.values(r).flatMap(s=>Object.values(s.components).map(i=>[`${s.manifest.name}/${i.name}`,i])))},a=[];return o&&a.push(e),a.push(...Cf(e,n)),a}function Cf(e,t){let r=new Map,o=(n,a)=>{if(n.type!=="component")return;let s=[n.package??a,n.name].filter(ds.isDefined).join("/");if(r.has(s))return;let i=t[s];(0,ds.isDefined)(i)&&(Object.hasOwn(t,s)&&r.set(s,{...i,name:s}),Object.values(i.nodes).forEach(l=>o(l,(l.type==="component"?l.package:void 0)??a)))};return Object.values(e.nodes).forEach(n=>o(n,n.type==="component"?n.package:void 0)),Array.from(r.values())}});var fs=w(Tr=>{"use strict";Object.defineProperty(Tr,"__esModule",{value:!0});Tr.removeTestData=_f;var Ke=Q();function _f(e){return{...e,attributes:(0,Ke.mapObject)(e.attributes,([t,r])=>[t,(0,Ke.omit)(r,["testValue"])]),...e.route?{route:{...e.route,path:e.route.path.map(t=>(0,Ke.omit)(t,["testValue"])),query:(0,Ke.mapObject)(e.route.query,([t,r])=>[t,(0,Ke.omit)(r,["testValue"])])}}:{}}}});var ms=w(Ht=>{"use strict";Object.defineProperty(Ht,"__esModule",{value:!0});Ht.replaceTagInNodes=void 0;var kf=(e,t)=>r=>({...r,nodes:Object.entries(r.nodes).reduce((o,[n,a])=>a.type!=="element"?{...o,[n]:a}:{...o,[n]:{...a,tag:a.tag===e?t:a.tag}},{})});Ht.replaceTagInNodes=kf});var Pt=w(_e=>{"use strict";Object.defineProperty(_e,"__esModule",{value:!0});_e.theme=_e.RESET_STYLES=void 0;_e.RESET_STYLES=`
@layer reset {
  html {
    height:100%;
  }

  #App {
    height:100%;
    display:flex;
    flex-direction:column;
  }

  body {
    height:100%;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    margin:0;
  }

  [data-node-id]:not([data-unset-toddle-styles],[data-node-type="text"],noscript,br,script,style,link,template,meta,title,base), [data-node-id]:not([data-unset-toddle-styles],noscript)::before, [data-node-id]:not([data-unset-toddle-styles],noscript)::after {
    display: flex;
    flex-direction: column;
    flex-grow: 0;
    flex-shrink: 0;

    position: relative;
    box-sizing: border-box;
    padding: 0;
    margin: 0;

    font-size: var(--text-base);
    font-family: var(--font-sans);
    font-weight: var(--font-weight-normal);

    background: transparent;
    color: inherit;
    border: none;
    box-shadow: none;
  }

  [data-node-id]:not([data-unset-toddle-styles]):is(p, h1, h2, h3, h4, h5, h6, label, span, strong, b, i, address, caption, code, cite, dt, dd, em, figcaption, legend, blockquote, abbr, pre, bdo, bdi) {
    display: inline-block;
    overflow-wrap: break-word;
    color: inherit;
  }

  [data-node-id]:not([data-unset-toddle-styles]):is(input, button, textarea, select) {
    outline: none;
  }

  [data-node-id]:not([data-unset-toddle-styles]):is(a) {
    color: inherit;
    text-decoration: none;
  }

  [data-node-id]:not([data-unset-toddle-styles]):is(ul, ol, li) {
    list-style: none;
  }

  [data-node-id]:not([data-unset-toddle-styles]):is(span[data-node-type="text"]) {
    font: inherit;
    display: inline;
    flex-direction: column;
    flex-grow: 0;
    flex-shrink: 0;
    box-sizing: border-box;
  }

  [popover]:not(:popover-open):not(dialog[open]) {
    display: revert;
  }
}`;_e.theme={colors:{grey:{order:0,variants:{50:{order:0,value:"#FAFAFA"},100:{order:1,value:"#F5F5F5"},200:{order:2,value:"#E5E5E5"},300:{order:3,value:"#D4D4D4"},400:{order:4,value:"#A3A3A3"},500:{order:5,value:"#737373"},600:{order:6,value:"#525252"},700:{order:7,value:"#404040"},800:{order:8,value:"#262626"},900:{order:9,value:"#171717"}}},red:{order:1,variants:{50:{order:0,value:"#FEF2F2"},100:{order:1,value:"#FEE2E2"},200:{order:2,value:"#FECACA"},300:{order:3,value:"#FCA5A5"},400:{order:4,value:"#F87171"},500:{order:5,value:"#EF4444"},600:{order:6,value:"#DC2626"},700:{order:7,value:"#B91C1C"},800:{order:8,value:"#991B1B"},900:{order:9,value:"#7F1D1D"}}},rose:{order:3,variants:{50:{order:0,value:"#FFF1F2"},100:{order:1,value:"#FFE4E6"},200:{order:2,value:"#FECDD3"},300:{order:3,value:"#FDA4AF"},400:{order:4,value:"#FB7185"},500:{order:5,value:"#F43F5E"},600:{order:6,value:"#E11D48"},700:{order:7,value:"#BE123C"},800:{order:8,value:"#9F1239"},900:{order:9,value:"#881337"}}},pink:{order:4,variants:{50:{order:0,value:"#FDF2F8"},100:{order:1,value:"#FCE7F3"},200:{order:2,value:"#FBCFE8"},300:{order:3,value:"#F9A8D4"},400:{order:4,value:"#F472B6"},500:{order:5,value:"#EC4899"},600:{order:6,value:"#DB2777"},700:{order:7,value:"#BE185D"},800:{order:8,value:"#9D174D"},900:{order:9,value:"#831843"}}},amber:{order:5,variants:{50:{order:0,value:"#FFFBEB"},100:{order:1,value:"#FEF3C7"},200:{order:2,value:"#FDE68A"},300:{order:3,value:"#FCD34D"},400:{order:4,value:"#FBBF24"},500:{order:5,value:"#F59E0B"},600:{order:6,value:"#D97706"},700:{order:7,value:"#B45309"},800:{order:8,value:"#92400E"},900:{order:9,value:"#78350F"}}},orange:{order:6,variants:{50:{order:0,value:"#FFF7ED"},100:{order:1,value:"#FFEDD5"},200:{order:2,value:"#FED7AA"},300:{order:3,value:"#FDBA74"},400:{order:4,value:"#FB923C"},500:{order:5,value:"#F97316"},600:{order:6,value:"#EA580C"},700:{order:7,value:"#C2410C"},800:{order:8,value:"#9A3412"},900:{order:9,value:"#7C2D12"}}},yellow:{order:7,variants:{50:{order:0,value:"#FFFBEB"},100:{order:1,value:"#FEF3C7"},200:{order:2,value:"#FDE68A"},300:{order:3,value:"#FCD34D"},400:{order:4,value:"#FBBF24"},500:{order:5,value:"#F59E0B"},600:{order:6,value:"#D97706"},700:{order:7,value:"#B45309"},800:{order:8,value:"#92400E"},900:{order:9,value:"#78350F"}}},lime:{order:8,variants:{50:{order:0,value:"#F7FEE7"},100:{order:1,value:"#ECFCCB"},200:{order:2,value:"#D9F99D"},300:{order:3,value:"#BEF264"},400:{order:4,value:"#A3E635"},500:{order:5,value:"#84CC16"},600:{order:6,value:"#65A30D"},700:{order:7,value:"#4D7C0F"},800:{order:8,value:"#3F6212"},900:{order:9,value:"#365314"}}},green:{order:9,variants:{50:{order:0,value:"#ECFDF5"},100:{order:1,value:"#D1FAE5"},200:{order:2,value:"#A7F3D0"},300:{order:3,value:"#6EE7B7"},400:{order:4,value:"#34D399"},500:{order:5,value:"#10B981"},600:{order:6,value:"#059669"},700:{order:7,value:"#047857"},800:{order:8,value:"#065F46"},900:{order:9,value:"#064E3B"}}},emerald:{order:10,variants:{50:{order:0,value:"#ECFDF5"},100:{order:1,value:"#D1FAE5"},200:{order:2,value:"#A7F3D0"},300:{order:3,value:"#6EE7B7"},400:{order:4,value:"#34D399"},500:{order:5,value:"#10B981"},600:{order:6,value:"#059669"},700:{order:7,value:"#047857"},800:{order:8,value:"#065F46"},900:{order:9,value:"#064E3B"}}},teal:{order:11,variants:{50:{order:0,value:"#F0FDFA"},100:{order:1,value:"#CCFBF1"},200:{order:2,value:"#99F6E4"},300:{order:3,value:"#5EEAD4"},400:{order:4,value:"#2DD4BF"},500:{order:5,value:"#14B8A6"},600:{order:6,value:"#0D9488"},700:{order:7,value:"#0F766E"},800:{order:8,value:"#115E59"},900:{order:9,value:"#134E4A"}}},cyan:{order:12,variants:{50:{order:0,value:"#ECFEFF"},100:{order:1,value:"#CFFAFE"},200:{order:2,value:"#A5F3FC"},300:{order:3,value:"#67E8F9"},400:{order:4,value:"#22D3EE"},500:{order:5,value:"#06B6D4"},600:{order:6,value:"#0891B2"},700:{order:7,value:"#0E7490"},800:{order:8,value:"#155E75"},900:{order:9,value:"#164E63"}}},sky:{order:13,variants:{50:{order:0,value:"#F0F9FF"},100:{order:1,value:"#E0F2FE"},200:{order:2,value:"#BAE6FD"},300:{order:3,value:"#7DD3FC"},400:{order:4,value:"#38BDF8"},500:{order:5,value:"#0EA5E9"},600:{order:6,value:"#0284C7"},700:{order:7,value:"#0369A1"},800:{order:8,value:"#075985"},900:{order:9,value:"#0C4A6E"}}},blue:{order:14,variants:{50:{order:0,value:"#EFF6FF"},100:{order:1,value:"#DBEAFE"},200:{order:2,value:"#BFDBFE"},300:{order:3,value:"#93C5FD"},400:{order:4,value:"#60A5FA"},500:{order:5,value:"#3B82F6"},600:{order:6,value:"#2563EB"},700:{order:7,value:"#1D4ED8"},800:{order:8,value:"#1E40AF"},900:{order:9,value:"#1E3A8A"}}},indigo:{order:15,variants:{50:{order:0,value:"#EEF2FF"},100:{order:1,value:"#E0E7FF"},200:{order:2,value:"#C7D2FE"},300:{order:3,value:"#A5B4FC"},400:{order:4,value:"#818CF8"},500:{order:5,value:"#6366F1"},600:{order:6,value:"#4F46E5"},700:{order:7,value:"#4338CA"},800:{order:8,value:"#3730A3"},900:{order:9,value:"#312E81"}}},purple:{order:16,variants:{50:{order:0,value:"#F5F3FF"},100:{order:1,value:"#EDE9FE"},200:{order:2,value:"#DDD6FE"},300:{order:3,value:"#C4B5FD"},400:{order:4,value:"#A78BFA"},500:{order:5,value:"#8B5CF6"},600:{order:6,value:"#7C3AED"},700:{order:7,value:"#6D28D9"},800:{order:8,value:"#5B21B6"},900:{order:9,value:"#4C1D95"}}},fuchsia:{order:17,variants:{50:{order:0,value:"#FDF4FF"},100:{order:1,value:"#FAE8FF"},200:{order:2,value:"#F5D0FE"},300:{order:3,value:"#F0ABFC"},400:{order:4,value:"#E879F9"},500:{order:5,value:"#D946EF"},600:{order:6,value:"#C026D3"},700:{order:7,value:"#A21CAF"},800:{order:8,value:"#86198F"},900:{order:9,value:"#701A75"}}}},shadow:{sm:{order:0,value:"0 1px 2px 0 rgba(0, 0, 0, 0.25)"},base:{order:1,value:"0 1px 3px 0 rgba(0, 0, 0, 0.25), 0 1px 2px 0 rgba(0, 0, 0, 0.25)"},md:{order:2,value:"0 4px 6px -1px rgba(0, 0, 0, 0.25), 0 2px 4px -1px rgba(0, 0, 0, 0.25)"},lg:{order:3,value:"0 10px 15px -3px rgba(0, 0, 0, 0.25), 0 4px 6px -2px rgba(0, 0, 0, 0.25)"},xl:{order:4,value:"0 20px 25px -5px rgba(0, 0, 0, 0.25), 0 10px 10px -5px rgba(0, 0, 0, 0.25)"},"2xl":{order:5,value:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"}},spacing:.25,fontSize:{lg:{order:0,value:"1.125rem"},sm:{order:1,value:"0.875rem"},xl:{order:2,value:"1.25rem"},xs:{order:3,value:"0.75rem"},"2xl":{order:4,value:"1.5rem"},"3xl":{order:5,value:"1.875rem"},"4xl":{order:6,value:"2.25rem"},"5xl":{order:7,value:"3rem"},xxs:{order:8,value:"0.625rem"},base:{order:9,value:"1rem",default:!0}},fontFamily:{mono:{order:0,value:["Fira Code","monospace"]},sans:{order:1,value:["Inter","sans-serif"],default:!0}},fontWeight:{bold:{order:0,value:"700"},bolder:{order:1,value:"800"},normal:{order:2,value:"500",default:!0},regular:{order:3,value:"400"},"semi-bold":{order:4,value:"600"}},breakpoints:{large:{order:2,value:1440},small:{order:0,value:576},medium:{order:1,value:960}}}});var Ir=w(ke=>{"use strict";Object.defineProperty(ke,"__esModule",{value:!0});ke.toValidClassName=ke.getClassName=void 0;var Hf=5381,Pf=(e,t)=>{let r=t.length;for(;r;)e=e*33^t.charCodeAt(--r);return e},Df=e=>Pf(Hf,e),If=/(a)(d)/gi,Dt=52,zs=e=>String.fromCharCode(e+(e>25?39:97));function $f(e){let t="",r;for(r=Math.abs(e);r>Dt;r=r/Dt|0)t=zs(r%Dt)+t;return(zs(r%Dt)+t).replace(If,"$1-$2")}var Nf=e=>$f(Df(JSON.stringify(e)));ke.getClassName=Nf;var Lf=(e,t=!1)=>{let r=e.trim().replace(/\s+/g,"-");return t&&(r=r.replace(/[^a-zA-Z0-9-_]/g,o=>`\\${o}`)),/^[^a-zA-Z]/.test(r)&&(r=`_${r}`),r};ke.toValidClassName=Lf});var Js=w(be=>{"use strict";Object.defineProperty(be,"__esModule",{value:!0});be.getOldThemeCss=be.getThemeCss=void 0;var Gs=Pt(),qf=(e,t)=>"breakpoints"in e?(0,be.getOldThemeCss)(e):`
${t.includeResetStyle?Gs.RESET_STYLES:""}

@layer base {
  ${t.createFontFaces?e.fonts.map(r=>`
    ${r.variants.map(o=>`
    @font-face {
      font-family: "${r.family}";
      font-style: ${o.italic?"italic":"normal"};
      font-weight: ${o.weight};
      font-display: auto;
      src: local("${o.url.substring(o.url.lastIndexOf("/")+1)}"), url("${o.url.replace("https://fonts.gstatic.com","/.toddle/fonts/font")}") format("woff2");
    }
    `).join(`
`)}
    `).join(`
`):""}

  body, :host {
    /* Color */
      ${e.color.flatMap(r=>r.tokens.map(o=>`--${o.name}: ${o.value};`)).join(`
`)}
  /* Fonts */
    ${e.fonts.map(r=>`--font-${r.name}: '${r.family}',${r.type};`).join(`
`)}

    /* Font size */
    ${e["font-size"].flatMap(r=>r.tokens.map(o=>`--${o.name}: ${o.type==="variable"?`var(--${o.value})`:o.value};`)).join(`
`)}

    /* Font weight */
    ${e["font-weight"].flatMap(r=>r.tokens.map(o=>`--${o.name}: ${o.type==="variable"?`var(--${o.value})`:o.value};`)).join(`
`)}

    /* Shadows */
    ${e.shadow.flatMap(r=>r.tokens.map(o=>`--${o.name}: ${o.type==="variable"?`var(--${o.value})`:o.value};`)).join(`
`)}

    /* Border radius */
    ${e["border-radius"].flatMap(r=>r.tokens.map(o=>`--${o.name}: ${o.type==="variable"?`var(--${o.value})`:o.value};`)).join(`
`)}

    /* Spacing */
    ${e.spacing.map(r=>r.tokens.map(o=>`--${o.name}: ${o.type==="variable"?`var(--${o.value})`:o.value};`).join(`
`)).join(`
`)}

    /* Z-index */
    ${e["z-index"].map(r=>r.tokens.map(o=>`--${o.name}: ${o.type==="variable"?`var(--${o.value})`:o.value};`).join(`
`)).join(`
`)}
  }

  @keyframes animation-spin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }

  @keyframes animation-fade-in {
    from {
      opacity:0;
    }
    to {
      opacity:1;
    }
  }


  @keyframes animation-fade-out {
    from {
      opacity:1;
    }
    to {
      opacity:0;
    }
  }
}
`;be.getThemeCss=qf;var Mf=e=>{let t=Object.entries(e.colors).flatMap(([r,{variants:o}])=>Object.entries(o).map(([n,{value:a}])=>`--${r}-${n}:${a}`));return`




body, :host {
  ${Object.entries(e.fontFamily).map(([r,{value:[o,...n]}])=>`--font-${r}: '${o}',${n.join(",")};`).join(`
`)}

  ${Object.entries(e.fontWeight).map(([r,{value:o}])=>`--font-weight-${r}: ${o};`).join(`
`)}

  ${Object.entries(e.fontSize).map(([r,{value:o}])=>`--font-size-${r}: ${o};`).join(`
`)}

  --spacing:${e.spacing}rem;
    ${t.join(`;
`)};


  --text-xxs:0.625rem;
  --line-height-xxs:0.9rem;

  --text-xs:0.75rem;
  --line-height-xs:1rem;

  --text-sm:0.875rem;
  --line-height-sm:1.25rem;

  --text-base:1rem;
  --line-height-base:1.5rem;

  --text-lg:1.125rem;
  --line-height-lg:1.75rem;

  --text-xl:1.25rem;
  --line-height-xl:1.75rem;

  --text-2xl:1.5rem;
  --line-height-2xl:2rem;

  --text-3xl:1.875rem;
  --line-height-3xl:2.25rem;

  --text-4xl:2.25rem;
  --line-height-4xl:2.5rem;

  --text-5xl:3rem;
  --line-height-5xl:3rem;

  ${Object.entries(e.shadow).map(([r,{value:o}])=>`--shadow-${r}:${o};`).join(`
`)}
}

${Gs.RESET_STYLES}

@keyframes animation-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@keyframes animation-fade-in {
  from {
    opacity:0;
  }
  to {
    opacity:1;
  }
}


@keyframes animation-fade-out {
  from {
    opacity:1;
  }
  to {
    opacity:0;
  }
}`};be.getOldThemeCss=Mf});var Xs=w(It=>{"use strict";Object.defineProperty(It,"__esModule",{value:!0});It.variantSelector=void 0;var Uf=e=>[(e.className??e.class)&&`.${e.className}`,(e.evenChild??e["even-child"])&&":nth-child(even)",(e.firstChild??e["first-child"])&&":first-child",(e.focusWithin??e["focus-within"])&&":focus-within",(e.lastChild??e["last-child"])&&":last-child",e.active&&":active",e.autofill&&":is(:-webkit-autofill, :autofill)",e.checked&&":checked",e.disabled&&":disabled",e.empty&&":empty",e.focus&&":focus",e.hover&&":hover",e.invalid&&":invalid",e.link&&":link",e.visited&&":visited",e["first-of-type"]&&":first-of-type",e["focus-visible"]&&":focus-visible",e["last-of-type"]&&":last-of-type",e["popover-open"]&&":popover-open",e.pseudoElement&&`::${e.pseudoElement}`].filter(Boolean).join("");It.variantSelector=Uf});var ei=w(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.getAllFonts=me.createStylesheet=void 0;me.kebabCase=Zs;var Bf=Q(),Ys=x(),Qs=Ir(),Vf=Js(),Kf=Xs(),Wf={large:1440,small:576,medium:960};function Zs(e){return e.split("").map(t=>"ABCDEFGHIJKLMNOPQRSTYVWXYZ".includes(t)?"-"+t.toLocaleLowerCase():t).join("")}var zf=new Set(["width","min-width","max-width","height","min-height","max-height","margin","margin-top","margin-left","margin-bottom","margin-right","padding","padding-top","padding-left","padding-bottom","padding-right","gap","gap-x","gap-y","border-radius","border-bottom-left-radius","border-bottom-right-radius","border-top-left-radius","border-top-right-radius","border-width","border-top-width","border-left-width","border-bottom-width","border-right-width","font-size","top","right","bottom","left","outline-width"]),Gf=(e,t,r,o)=>{let n=new Set,a=(0,me.getAllFonts)(t),s=(0,Vf.getThemeCss)("breakpoints"in r?{...r,fontFamily:Object.fromEntries(Object.entries(r.fontFamily).filter(([d,h])=>h.default??a.has("--font-"+d)))}:{...r,fonts:r.fonts},o),i=d=>Object.entries(d).map(([h,f])=>{if(!(0,Ys.isDefined)(f))return;let y=Zs(h),b=String(Number(f))===String(f)&&zf.has(y)?`${Number(f)*4}px`:f;return`${y}:${b};`}).filter(Boolean).join(`
  `),l=(d,h)=>{try{let f=(0,Bf.omitKeys)(d.style??{},["variants","breakpoints","shadows"]),y=d.variants??d.style?.variants,b=(g,A,E)=>{let O=Object.entries(A).filter(([C])=>C=="scrollbar-width"),F=i(A);return E?.startingStyle&&(F=`@starting-style {
            ${F}
          }`),`
  ${F.length>0?`${g} {
    ${F}
  }`:""}
      ${O.length>0?`
${g}::-webkit-scrollbar {
  ${O.map(([C,H])=>{switch(H){case"none":return"width: 0;";case"thinn":case"thin":return"width: 4px;";default:return""}}).join(`
`)}
}
`:""}
`};return`
      ${b("."+h,f)}
      ${(y??[]).map(g=>{let A=b(`.${h}${(0,Kf.variantSelector)(g)}`,g.style,{startingStyle:g.startingStyle});return g.mediaQuery?`
          @media (${Object.entries(g.mediaQuery).map(([E,O])=>`${E}: ${O}`).filter(Boolean).join(") and (")}) {
            ${A}
          }
          `:g.breakpoint?`
          @media (min-width: ${Wf[g.breakpoint]}px) {
            ${A}
          }
          `:A}).join(`
`)}
      `}catch{return""}},u=new Set;function c(d,h){u.has(d.name)||(u.add(d.name),d.nodes&&Object.entries(d.nodes).forEach(([f,y])=>{if(y.type==="component"){let g=t.find(A=>A.name===[y.package??h,y.name].filter(E=>E).join("/"));if(g){c(g,y.package??h),s+=`
`+l(y,(0,Qs.toValidClassName)(`${d.name}:${f}`,!0));return}}if(y.type!=="element")return;let b=(0,Qs.getClassName)([y.style,y.variants]);if(n.has(b))return"";n.add(b),s+=`
`+l(y,b)}))}return c(e),s};me.createStylesheet=Gf;var Jf=e=>new Set(e.flatMap(t=>Object.values(t.nodes).flatMap(r=>r.type==="element"?[r.style.fontFamily,r.style["font-family"],...r.variants?.map(o=>o.style.fontFamily??o.style["font-family"])??[]].filter(Ys.isDefined):[])).map(t=>t.replace("var(","").replace(")","").replace(/'/g,"")));me.getAllFonts=Jf});var $r=w($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.VOID_HTML_ELEMENTS=void 0;$t.VOID_HTML_ELEMENTS=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"]});var Lr=w(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.toEncodedText=ae.escapeAttrValue=void 0;ae.getNodeAttrs=nm;var Nr=V(),ti=x(),Xf=/"/g,Qf=/</g,Yf=/>/g,Zf=["string","number","boolean"],em=e=>!(0,ti.isDefined)(e)||!Zf.includes(typeof e)?"":rm(tm(String(e)));ae.escapeAttrValue=em;var tm=e=>e.replace(Xf,"&quot;"),rm=e=>e.replace(Qf,"&lt;").replace(Yf,"&gt;"),om=e=>e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;").replaceAll(`
`,"<br />");ae.toEncodedText=om;function nm({node:e,data:t,component:r,packageName:o,env:n,toddle:a}){let{style:s,...i}=e.attrs,l=Object.entries(i).reduce((d,[h,f])=>{let y=(0,Nr.applyFormula)(f,{data:t,component:r,package:o,env:n,toddle:a});return(0,ti.toBoolean)(y)&&d.push(`${h}="${(0,ae.escapeAttrValue)(y)}"`),d},[]),u=Object.values(e["style-variables"]??{}).map(({name:d,formula:h,unit:f})=>`--${d}: ${String((0,Nr.applyFormula)(h,{data:t,component:r,package:o,env:n,toddle:a}))+(f??"")}`),c=[...s?[(0,Nr.applyFormula)(s,{data:t,component:r,package:o,env:n,toddle:a})]:[],...u].filter(Boolean).map(String).join("; ");return c.length>0?[...l,`style="${(0,ae.escapeAttrValue)(c)};"`].join(" "):l.join(" ")}});var ai=w(Mt=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});Mt.renderPageBody=void 0;var am=Ft(),W=V(),ri=Ir(),qt=Q(),Nt=x(),Lt=kt(),sm=$r(),oi=Lr(),ni=async({apiCache:e,children:t,component:r,data:o,env:n,evaluateComponentApis:a,files:s,toddle:i,includedComponents:l,instance:u,packageName:c,projectId:d,req:h,updateApiCache:f})=>{let y=async({id:b,node:g,data:A,packageName:E,isComponentRootNode:O=!1})=>{if(!g)return"";let F={data:A,component:r,package:E,env:n,toddle:i};if(g.repeat){let C=(0,W.applyFormula)(g.repeat,F);return Array.isArray(C)?(await Promise.all(C.map((k,R)=>y({id:b,node:{...g,repeat:void 0},data:{...A,ListItem:A.ListItem?{Index:R,Item:k,Parent:A.ListItem}:{Index:R,Item:k}},packageName:E})))).join(""):""}if(g.condition&&!(0,Nt.toBoolean)((0,W.applyFormula)(g.condition,F)))return"";switch(g.type){case"text":return`<span data-node-type="text" data-node-id="${b}">${(0,oi.toEncodedText)(String((0,W.applyFormula)(g.value,F)))}</span>`;case"slot":{let C=t?.[g.name??"default"];return C||(await Promise.all(g.children.map(k=>y({id:k,node:r.nodes[k],data:A,packageName:E})))).join("")}case"element":{if(g.tag.toLocaleLowerCase()==="script")return"";let C=(0,oi.getNodeAttrs)({node:g,data:A,component:r,packageName:E,env:n,toddle:i}),H=(0,ri.getClassName)([g.style,g.variants]),k=Object.entries(g.classes).filter(([$,{formula:le}])=>(0,Nt.toBoolean)((0,W.applyFormula)(le,F))).map(([$])=>$).join(" ");u&&b==="root"&&Object.entries(u).forEach(([$,le])=>{k+=" "+(0,ri.toValidClassName)(`${$}:${le}`)});let R="";if(["script","style"].includes(g.tag.toLocaleLowerCase())===!1&&(R=(await Promise.all(g.children.map(le=>y({id:le,node:r.nodes[le],data:A,packageName:E})))).join("")),g.tag.toLocaleLowerCase()==="style"){let $=g.children[0]?r.nodes[g.children[0]]:void 0;$?.type==="text"&&(R=String((0,W.applyFormula)($.value,F)))}let T=r.version===2&&O?`${E??d}-${g.tag}`:g.tag,re=`${H} ${k}`.trim();return sm.VOID_HTML_ELEMENTS.includes(T)?`<${T} ${C} data-node-id="${(0,Lt.escapeAttrValue)(b)}" class="${(0,Lt.escapeAttrValue)(re)}" />`:`<${T} ${C} data-node-id="${(0,Lt.escapeAttrValue)(b)}" class="${(0,Lt.escapeAttrValue)(re)}">${R}</${T}>`}case"component":{let C=(0,qt.mapValues)(g.attrs,N=>(0,W.applyFormula)(N,F)),H={...A.Contexts,[r.name]:Object.fromEntries(Object.entries(r.formulas??{}).filter(([,N])=>N.exposeInContext).map(([N,J])=>[N,(0,W.applyFormula)(J.formula,F)]))},k,R=g.package??E;if(R?k=s.packages?.[R]?.components[g.name]??s.components[g.name]:k=s.components[g.name],!(0,Nt.isDefined)(k))return"";let T=k,re=l.some(N=>N.name===T.name),$=await a({component:new am.ToddleComponent({component:T,getComponent:(N,J)=>{let Pe=[J,N].filter(Nt.isDefined).join("/"),ue=J?s.packages?.[J]?.components[N]:s.components[N];if(ue)return ue},packageName:E,globalFormulas:{formulas:s.formulas,packages:s.packages}}),formulaContext:{data:{Location:F.data.Location,Attributes:C,Contexts:H,Variables:(0,qt.mapValues)(T.variables,({initialValue:N})=>(0,W.applyFormula)(N,F)),Apis:{}},component:T,package:g.package??(re?void 0:E),env:n,toddle:i},req:h,apiCache:e,updateApiCache:f}),le=await Promise.all(g.children.map(N=>y({id:N,node:r.nodes[N],data:{...A,Contexts:{...H,[T.name]:Object.fromEntries(Object.entries(T.formulas??{}).filter(([,J])=>J.exposeInContext).map(([J,Pe])=>[J,(0,W.applyFormula)(Pe.formula,{component:T,package:R,data:{Contexts:{...A.Contexts,...Object.fromEntries(Object.entries(T.formulas??{}).filter(([,ue])=>ue.exposeInContext).map(([ue,Vu])=>[ue,(0,W.applyFormula)(Vu.formula,{data:{Attributes:C,Apis:{...A.Apis,...$}},component:r,package:R,env:n,toddle:i})]))},Apis:$,Attributes:C,Variables:(0,qt.mapValues)(T.variables,({initialValue:ue})=>(0,W.applyFormula)(ue,{data:{Attributes:C},component:r,package:R,env:n,toddle:i}))},env:n,toddle:i})]))}},packageName:g.package??E}))),Xt={};return le.forEach((N,J)=>{let Pe=r.nodes[g.children[J]]?.slot??"default";Xt[Pe]=`${Xt[Pe]??""} ${N}`}),im({attrs:C,component:T,contexts:H,children:Xt,packageName:g.package??(re?void 0:E),instance:b==="root"?{...u,[r.name]:"root"}:{[r.name]:b},apis:$,env:n,includedComponents:l,formulaContext:F,files:s,apiCache:e,updateApiCache:f,projectId:d,evaluateComponentApis:a,req:h})}}};return y({id:"root",node:r.nodes.root,data:o,packageName:c,isComponentRootNode:!0})},im=async({apiCache:e,apis:t,attrs:r,children:o,component:n,contexts:a,env:s,evaluateComponentApis:i,files:l,formulaContext:u,includedComponents:c,instance:d,packageName:h,projectId:f,req:y,updateApiCache:b})=>{let g={Location:u.data.Location,Attributes:r,Contexts:a,Variables:(0,qt.mapValues)(n.variables,({initialValue:A})=>(0,W.applyFormula)(A,{...u,data:{...u.data,Contexts:a}})),Apis:t};return g.Contexts={...g.Contexts,...Object.fromEntries(Object.entries(n.formulas??{}).filter(([,A])=>A.exposeInContext).map(([A,E])=>[A,(0,W.applyFormula)(E.formula,{...u,data:g})]))},ni({apiCache:e,children:o,component:n,data:g,env:s,evaluateComponentApis:i,files:l,includedComponents:c,instance:d,packageName:h,projectId:f,req:y,toddle:u.toddle,updateApiCache:b})},lm=async({component:e,env:t,evaluateComponentApis:r,files:o,formulaContext:n,includedComponents:a,req:s,projectId:i})=>{let l={},u=(h,f)=>l[h]=f,c=await r({component:e,formulaContext:n,req:s,apiCache:l,updateApiCache:u});return n.data.Apis=c,{html:await ni({apiCache:l,component:e,data:n.data,env:t,evaluateComponentApis:r,files:o,includedComponents:a,instance:{},packageName:void 0,projectId:i,req:s,toddle:n.toddle,updateApiCache:u}),apiCache:l}};Mt.renderPageBody=lm});var qr={};p(qr,{default:()=>cm});var si,um,cm,ii=m(()=>{si=v(x()),um=([e])=>(0,si.toBoolean)(e),cm=um});var Mr={};p(Mr,{default:()=>fm});var dm,fm,li=m(()=>{dm=([e])=>typeof e!="string"?null:e.length===0?e:e[0].toLocaleUpperCase()+e.substring(1).toLocaleLowerCase(),fm=dm});var Ur={};p(Ur,{default:()=>pm});var mm,pm,ui=m(()=>{mm=([e,t])=>typeof t!="number"||isNaN(t)?null:Array.isArray(e)?e.slice(t):typeof e=="string"?e.substring(t):null,pm=mm});var Br={};p(Br,{default:()=>gm});var hm,gm,ci=m(()=>{hm=([e,t])=>{if(typeof e!="number"||typeof t!="number")return null;let r=Math.max(1,Math.pow(10,t));return Math.round(e*r)/r},gm=hm});var Vr={};p(Vr,{default:()=>bm});var ym,bm,di=m(()=>{ym=([e])=>typeof e!="string"?null:e.trim(),bm=ym});var Kr={};p(Kr,{default:()=>Fm});var vm,Fm,fi=m(()=>{vm=([e],{root:t})=>typeof e!="string"?null:t.getElementById(e),Fm=vm});var Wr={};p(Wr,{default:()=>wm});var Am,wm,mi=m(()=>{Am=([e])=>typeof e=="number"?new Date(e):null,wm=Am});var zr={};p(zr,{default:()=>Om});var pi,Em,Om,hi=m(()=>{pi=v(br()),Em=([e])=>!e||typeof e!="string"?null:(0,pi.STRING_TEMPLATE)("cookies",e),Om=Em});var Gr={};p(Gr,{default:()=>jm});var gi,xm,jm,yi=m(()=>{gi=v(x()),xm=([e])=>Array.isArray(e)?e.length:(0,gi.isObject)(e)?Object.keys(e).length:typeof e=="string"?e.length:null,jm=xm});var Jr={};p(Jr,{default:()=>Cm});var Sm,Cm,bi=m(()=>{Sm=([e])=>typeof e!="string"?null:e.toLocaleUpperCase(),Cm=Sm});var Xr={};p(Xr,{default:()=>km});var _m,km,vi=m(()=>{_m=()=>Math.random(),km=_m});var Qr={};p(Qr,{default:()=>Tm});var Rm,Tm,Fi=m(()=>{Rm=([e,t])=>typeof e=="string"?e.indexOf(t):Array.isArray(e)?e.findIndex(r=>globalThis.toddle.isEqual(r,t)):null,Tm=Rm});var Yr={};p(Yr,{default:()=>Pm});var Hm,Pm,Ai=m(()=>{Hm=([e,t])=>typeof e=="string"?e.lastIndexOf(t):Array.isArray(e)?e.findLastIndex(r=>globalThis.toddle.isEqual(r,t)):null,Pm=Hm});var Zr={};p(Zr,{default:()=>Im});var Dm,Im,wi=m(()=>{Dm=([e,t])=>Array.isArray(e)?e.join(String(t)):null,Im=Dm});var eo={};p(eo,{default:()=>Nm});var $m,Nm,Ei=m(()=>{$m=([e])=>typeof e!="string"?null:encodeURIComponent(e),Nm=$m});var to={};p(to,{default:()=>qm});var Lm,qm,Oi=m(()=>{Lm=([e])=>typeof e!="string"?null:btoa(e),qm=Lm});var ro={};p(ro,{default:()=>Um});var Mm,Um,xi=m(()=>{Mm=([e])=>typeof e!="number"?null:Math.sqrt(e),Um=Mm});var oo={};p(oo,{default:()=>Vm});var Bm,Vm,ji=m(()=>{Bm=()=>new Date,Vm=Bm});var no={};p(no,{default:()=>Km,getArgumentInputData:()=>Wm,handler:()=>Si});var Si,Km,Wm,Ci=m(()=>{Si=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.findIndex((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.entries(e).findIndex(([r,o])=>t({key:r,value:o})):null,Km=Si,Wm=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{key:o[0],value:o[1]}}}return r}});var ao={};p(ao,{default:()=>Gm});var zm,Gm,_i=m(()=>{zm=([e])=>Array.isArray(e)?[...e].reverse():null,Gm=zm});var so={};p(so,{default:()=>Xm});var Jm,Xm,ki=m(()=>{Jm=([e,t])=>e>=t,Xm=Jm});var io={};p(io,{default:()=>Ym});var Qm,Ym,Ri=m(()=>{Qm=([e])=>Number(e),Ym=Qm});var lo={};p(lo,{default:()=>ep,getArgumentInputData:()=>tp});var Zm,ep,tp,Ti=m(()=>{Zm=([e,t,r])=>{if(!Array.isArray(e)||typeof t!="function"||typeof r!="boolean")return null;let o=r?1:-1;return[...e].sort((n,a)=>{let s=t({item:n}),i=t({item:a});if(Array.isArray(s)&&Array.isArray(i)){for(let l in s)if(s[l]!==i[l])return(s[l]>i[l]?1:-1)*o;return 0}return s===i?0:(s>i?1:-1)*o})},ep=Zm,tp=([e],t,r)=>t===1&&Array.isArray(e)?{...r,Args:{item:e[0]}}:r});var uo={};p(uo,{default:()=>op});var Hi,rp,op,Pi=m(()=>{Hi=v(x()),rp=e=>{if(e.every(Array.isArray)){let t=[];for(let r of e)t.push(...r);return t}return e.every(Hi.isObject)?Object.assign({},...e):e.join("")},op=rp});var co={};p(co,{default:()=>ap,getArgumentInputData:()=>sp});var np,ap,sp,Di=m(()=>{np=([e,t,r])=>typeof t!="function"?null:Array.isArray(e)?e.reduce((o,n,a)=>t({result:o,item:n,index:a}),r):e&&typeof e=="object"?Object.entries(e).reduce((o,[n,a])=>t({result:o,key:n,value:a}),r):null,ap=np,sp=([e,t,r],o,n)=>{if(o!==1)return n;if(Array.isArray(e))return{...n,Args:{item:e[0],index:0,result:r}};if(e&&typeof e=="object"){let[a]=Object.entries(e);if(a)return{...n,Args:{key:a[0],value:a[1],result:r}}}return n}});var fo={};p(fo,{default:()=>ip,getArgumentInputData:()=>lp,handler:()=>Ii});var Ii,ip,lp,$i=m(()=>{Ii=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.find((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.entries(e).find(([r,o])=>t({key:r,value:o}))?.[1]:null,ip=Ii,lp=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{key:o[0],value:o[1]}}}return r}});var mo={};p(mo,{default:()=>cp});var up,cp,Ni=m(()=>{up=([e,t])=>typeof t!="number"?null:Array.isArray(e)?e.slice(e.length-t):typeof e=="string"?e.substring(e.length-t):null,cp=up});var po={};p(po,{default:()=>fp});var dp,fp,Li=m(()=>{dp=([e])=>{switch(typeof e){case"number":return isNaN(e)?null:"Number";case"string":return"String";case"boolean":return"Boolean";case"object":return Array.isArray(e)?"Array":e===null?"Null":"Object";case"undefined":return"Null";default:return null}},fp=dp});var ho={};p(ho,{default:()=>pp});var mp,pp,qi=m(()=>{mp=([e,t])=>globalThis.toddle.isEqual(e,t),pp=mp});var go={};p(go,{default:()=>gp});var hp,gp,Mi=m(()=>{hp=([e,t,r])=>{if(typeof e!="number"||Number.isNaN(e))return null;let o=typeof t=="string"&&t.length>0||Array.isArray(t)&&t.every(F=>typeof F=="string")?t:void 0;if(!r||typeof r!="object")return Intl.NumberFormat(o).format(e);let n=(F,C)=>typeof F=="string"&&(C?.includes(F)??!0)?F:void 0,a=r,s=n(a.style,["decimal","currency","percent","unit"]),i=typeof a.currency=="string"&&a.currency.length===3?a.currency:void 0;if(s==="currency"&&typeof i!="string")return null;let l=n(a.currencyDisplay,["code","symbol","narrowSymbol","name"]),u=typeof a.unit=="string"?a.unit:void 0;if(s==="unit"&&typeof u!="string")return null;let c=n(a.unitDisplay,["short","narrow","long"]),d=typeof a.minimumIntegerDigits=="number"&&a.minimumIntegerDigits>=1&&a.minimumIntegerDigits<=21?a.minimumIntegerDigits:void 0,h=typeof a.minimumFractionDigits=="number"&&a.minimumFractionDigits>=0&&a.minimumFractionDigits<=100?a.minimumFractionDigits:void 0,f=typeof a.maximumFractionDigits=="number"&&a.maximumFractionDigits>=0&&a.maximumFractionDigits<=100?a.maximumFractionDigits:void 0,y=typeof a.minimumSignificantDigits=="number"&&a.minimumSignificantDigits>=1&&a.minimumSignificantDigits<=21?a.minimumSignificantDigits:void 0,b=typeof a.maximumSignificantDigits=="number"&&a.maximumSignificantDigits>=1&&a.maximumSignificantDigits<=21?a.maximumSignificantDigits:void 0,g=n(a.notation,["standard","scientific","engineering","compact"]),A=n(a.compactDisplay,["short","long"]),E=["always","auto","min2"],O=typeof a.useGrouping=="boolean"?a.useGrouping:n(a.useGrouping,E);return new Intl.NumberFormat(o,{style:s,currency:i,currencyDisplay:l,unit:u,unitDisplay:c,minimumIntegerDigits:d,minimumFractionDigits:h,maximumFractionDigits:f,minimumSignificantDigits:y,maximumSignificantDigits:b,notation:g,compactDisplay:A,useGrouping:O}).format(e)},gp=hp});var yo={};p(yo,{default:()=>yp,getArgumentInputData:()=>bp,handler:()=>Ui});var Ui,yp,bp,Bi=m(()=>{Ui=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.some((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.entries(e).some(([r,o])=>t({key:r,value:o})):null,yp=Ui,bp=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{key:o[0],value:o[1]}}}return r}});var bo={};p(bo,{default:()=>Fp});var vp,Fp,Vi=m(()=>{vp=([e,t])=>e<t,Fp=vp});var vo={};p(vo,{default:()=>Ap,getArgumentInputData:()=>wp,handler:()=>Ki});var Ki,Ap,wp,Wi=m(()=>{Ki=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.every((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.entries(e).every(([r,o])=>t({key:r,value:o})):null,Ap=Ki,wp=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{key:o[0],value:o[1]}}}return r}});var Fo={};p(Fo,{default:()=>Op});var Ep,Op,zi=m(()=>{Ep=(e,t)=>t.env.branchName,Op=Ep});var Ao={};p(Ao,{default:()=>jp});var Ut,xp,jp,Gi=m(()=>{Ut=v(x()),xp=([e,t,r,o,n])=>{if(typeof e!="string"||typeof t!="string")return[];let a=[(0,Ut.toBoolean)(r)?"g":"",(0,Ut.toBoolean)(o)?"i":"",(0,Ut.toBoolean)(n)?"m":""].join(""),s=new RegExp(t,a);return e.match(s)??[]},jp=xp});var wo={};p(wo,{default:()=>Cp});var Sp,Cp,Ji=m(()=>{Sp=([e])=>typeof e=="string"||Array.isArray(e)?e[e.length-1]:null,Cp=Sp});var Xi=w(Eo=>{"use strict";Object.defineProperty(Eo,"__esModule",{value:!0});Eo.parseJSONWithDate=kp;var _p=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:.\d{1,3})?Z$/;function kp(e){return JSON.parse(e,(t,r)=>typeof r=="string"&&r.length===24&&_p.test(r)?new Date(r):r)}});var Oo={};p(Oo,{default:()=>Tp});var Qi,Rp,Tp,Yi=m(()=>{Qi=v(Xi()),Rp=([e])=>{if(typeof e!="string")return null;try{return(0,Qi.parseJSONWithDate)(e)}catch{return null}},Tp=Rp});var xo={};p(xo,{default:()=>Hp,getArgumentInputData:()=>Pp,handler:()=>Zi});var Zi,Hp,Pp,el=m(()=>{Zi=([e,t])=>{if(typeof t!="function"||!e||typeof e!="object"||!Array.isArray(e))return null;let r={};for(let o in e){let n=e[o],a=String(t({item:n,index:o}));r[a]=r[a]??[],r[a].push(n)}return r},Hp=Zi,Pp=([e],t,r)=>t===1&&Array.isArray(e)?{...r,Args:{item:e[0],index:0}}:r});var jo={};p(jo,{default:()=>Dp,getArgumentInputData:()=>Ip,handler:()=>tl});var tl,Dp,Ip,rl=m(()=>{tl=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.filter((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.fromEntries(Object.entries(e).filter(([r,o])=>t({key:r,value:o}))):Array.isArray(e)?e.filter((r,o)=>t({item:r,index:o})):null,Dp=tl,Ip=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{value:o[1],key:o[0]}}}return r}});var So={};p(So,{default:()=>Np});var $p,Np,ol=m(()=>{$p=([e,t])=>e<=t,Np=$p});var Co={};p(Co,{default:()=>qp});var Lp,qp,nl=m(()=>{Lp=([e,t])=>!globalThis.toddle.isEqual(e,t),qp=Lp});var _o={};p(_o,{default:()=>Up});var Mp,Up,al=m(()=>{Mp=([e])=>typeof e!="number"?null:Math.abs(e),Up=Mp});var ko={};p(ko,{default:()=>Vp});var Bp,Vp,sl=m(()=>{Bp=([e,t])=>e>t,Vp=Bp});var Ro={};p(Ro,{default:()=>Wp});var il,Kp,Wp,ll=m(()=>{il=v(x()),Kp=([e])=>!(0,il.toBoolean)(e),Wp=Kp});var To={};p(To,{default:()=>Gp});var zp,Gp,ul=m(()=>{zp=([e,t])=>typeof e=="string"&&typeof t=="string"?e.includes(t):Array.isArray(e)?e.some(r=>globalThis.toddle.isEqual(r,t)):null,Gp=zp});var Ho={};p(Ho,{default:()=>Xp});var Jp,Xp,cl=m(()=>{Jp=([e,t])=>{if(typeof e!="number"||typeof t!="number")return null;let r=Math.max(1,Math.pow(10,t));return Math.ceil(e*r)/r},Xp=Jp});var Po={};p(Po,{default:()=>Yp});var Qp,Yp,dl=m(()=>{Qp=(e,t)=>t.env.isServer,Yp=Qp});var Do={};p(Do,{default:()=>eh});var Zp,eh,fl=m(()=>{Zp=e=>!Array.isArray(e)||e.some(t=>t===null||typeof t!="number")?null:e.reduce((t,r)=>t+Number(r),0),eh=Zp});var Io={};p(Io,{default:()=>rh});var th,rh,ml=m(()=>{th=e=>e.some(t=>isNaN(Number(t)))?null:e.reduce((t,r)=>t*r,1),rh=th});var $o={};p($o,{default:()=>nh});var pl,oh,nh,hl=m(()=>{pl=v(x()),oh=e=>{for(let t of e)if((0,pl.toBoolean)(t))return t;return null},nh=oh});var No={};p(No,{default:()=>sh});var ah,sh,gl=m(()=>{ah=([e,t])=>typeof e!="string"||typeof t!="string"?null:e.startsWith(t),sh=ah});var Lo={};p(Lo,{default:()=>lh});var ih,lh,yl=m(()=>{ih=([e])=>Array.isArray(e)?e.flat():null,lh=ih});var qo={};p(qo,{default:()=>ch});var uh,ch,bl=m(()=>{uh=([e,t])=>{let r=isNaN(Number(t))?0:Number(t);return JSON.stringify(e,null,r)},ch=uh});var Mo={};p(Mo,{default:()=>fh});var dh,fh,vl=m(()=>{dh=([e,t])=>typeof t!="number"||isNaN(t)?null:Array.isArray(e)?e.slice(0,e.length-t):typeof e=="string"?e.substring(0,e.length-t):null,fh=dh});var Uo={};p(Uo,{default:()=>ph});var mh,ph,Fl=m(()=>{mh=([e])=>typeof e=="string"?new Date(e):null,ph=mh});var Bo={};p(Bo,{default:()=>gh});var hh,gh,Al=m(()=>{hh=([e])=>typeof e=="object"&&e!==null?Object.entries(e).map(([t,r])=>({key:t,value:r})):null,gh=hh});var Vo={};p(Vo,{default:()=>bh});var yh,bh,wl=m(()=>{yh=([e])=>{if(!Array.isArray(e))return null;let t=new Set;return e.filter(r=>{let o=typeof r=="object"?JSON.stringify(r):r;return t.has(o)?!1:(t.add(o),!0)})},bh=yh});var Ko={};p(Ko,{default:()=>Fh});var vh,Fh,El=m(()=>{vh=([e,t,r])=>typeof e!="string"||typeof t!="string"?null:e.replaceAll(t,String(r)),Fh=vh});var Wo={};p(Wo,{default:()=>wh});var Ah,wh,Ol=m(()=>{Ah=([e,t,r])=>typeof e!="number"||typeof t!="number"||typeof r!="number"?null:Math.min(Math.max(e,t),r),wh=Ah});var zo={};p(zo,{default:()=>Oh});var Eh,Oh,xl=m(()=>{Eh=([e])=>typeof e!="string"?null:e.toLocaleLowerCase(),Oh=Eh});var Go={};p(Go,{default:()=>jh});function jl(e){let t=[...e];for(let r=t.length-1;r>0;r--){let o=Math.floor(Math.random()*(r+1));[t[r],t[o]]=[t[o],t[r]]}return t}var xh,jh,Sl=m(()=>{xh=([e])=>Array.isArray(e)?jl(e):typeof e=="string"?jl(e.split("")).join(""):null;jh=xh});var Jo={};p(Jo,{default:()=>Ch});var Sh,Ch,Cl=m(()=>{Sh=([e])=>!e||!(e instanceof Date)?null:e.getTime(),Ch=Sh});var Xo={};p(Xo,{default:()=>kh});var _l,_h,kh,kl=m(()=>{_l=v(x()),_h=([e,t])=>{if(typeof e!="object"||e===null||!Array.isArray(t)&&typeof t!="string"&&typeof t!="number")return null;let r=(n,[a,...s])=>{if(Array.isArray(n)){let i=Number(a);return Number.isNaN(i)?n:s.length===0?n.filter((l,u)=>u!==Number(a)):n.map((l,u)=>u===i?r(n[i],s):l)}return(0,_l.isObject)(n)?s.length===0?Object.fromEntries(Object.entries(n).filter(([i])=>i!==a)):{...n,[a]:r(n[a],s)}:null},o=Array.isArray(t)?t:[t];return r(e,o)},kh=_h});var Yo={};p(Yo,{default:()=>Th});var Qo,Rh,Th,Rl=m(()=>{Qo=v(x()),Rh=([e,t,r])=>{if(!(0,Qo.isDefined)(navigator.canShare))return!1;let o=a=>(0,Qo.isDefined)(a)&&typeof a=="string";if(!o(e)&&!o(t)&&!o(r))return!1;let n={};return o(t)&&(n.title=t),o(r)&&(n.text=r),o(e)&&(n.url=e),navigator.canShare(n)},Th=Rh});var Zo={};p(Zo,{default:()=>Ph});var Hh,Ph,Tl=m(()=>{Hh=([e,t])=>typeof e!="number"||typeof t!="number"?null:e>t?[]:Array.from({length:t-e+1},(r,o)=>o+e),Ph=Hh});var en={};p(en,{default:()=>Ih});var Dh,Ih,Hl=m(()=>{Dh=e=>Math.min(...e.map(Number)),Ih=Dh});var tn={};p(tn,{default:()=>Nh});var $h,Nh,Pl=m(()=>{$h=([e,t])=>{if(typeof e!="number"||typeof t!="number")return null;let r=Math.max(1,Math.pow(10,t));return Math.floor(e*r)/r},Nh=$h});var rn={};p(rn,{default:()=>Lh,getArgumentInputData:()=>qh,handler:()=>Dl});var Dl,Lh,qh,Il=m(()=>{Dl=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.findLast((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.entries(e).findLast(([r,o])=>t({key:r,value:o}))?.[1]:null,Lh=Dl,qh=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{key:o[0],value:o[1]}}}return r}});var on={};p(on,{default:()=>Uh});var Mh,Uh,$l=m(()=>{Mh=([e])=>typeof e!="string"?null:decodeURIComponent(e),Uh=Mh});var nn={};p(nn,{default:()=>Vh});var Bh,Vh,Nl=m(()=>{Bh=(e,{env:t})=>t.isServer?t.request?.headers["user-agent"]??null:window.navigator.userAgent,Vh=Bh});var an={};p(an,{default:()=>Wh});var Kh,Wh,Ll=m(()=>{Kh=([e])=>{if(Array.isArray(e)){let t=0;for(let r of e){if(isNaN(r)||typeof r!="number")return null;t+=r}return t}return null},Wh=Kh});var sn={};p(sn,{default:()=>Gh});var zh,Gh,ql=m(()=>{zh=e=>Math.max(...e.map(Number)),Gh=zh});var ln={};p(ln,{default:()=>Xh});var Jh,Xh,Ml=m(()=>{Jh=([e,t])=>{let r=Number(e),o=Number(t);return isNaN(r)||isNaN(o)?null:r-o},Xh=Jh});var un={};p(un,{default:()=>Yh});var Qh,Yh,Ul=m(()=>{Qh=([e,t,r])=>{if(!e||!(e instanceof Date))return null;let o=typeof t=="string"&&t.length>0||Array.isArray(t)&&t.every(F=>typeof F=="string")?t:void 0;if(!r||typeof r!="object")return Intl.DateTimeFormat(o).format(e);let n=(F,C)=>typeof F=="string"&&(C?.includes(F)??!0)?F:void 0,a=r,s=n(a.dateStyle,["full","long","medium","short"]),i=n(a.timeStyle,["full","long","medium","short"]),l=n(a.calendar),u=n(a.weekday,["long","short","narrow"]),c=n(a.era,["long","short","narrow"]),d=n(a.year,["numeric","2-digit"]),h=n(a.month,["long","short","narrow","numeric","2-digit"]),f=n(a.day,["numeric","2-digit"]),y=n(a.hour,["numeric","2-digit"]),b=n(a.minute,["numeric","2-digit"]),g=n(a.second,["numeric","2-digit"]),A=n(a.timeZoneName,["long","short","shortOffset","longOffset","shortGeneric","longGeneric"]),E=n(a.timeZone),O=a.hour12===!0?!0:a.hour12===!1?!1:void 0;return Intl.DateTimeFormat(o,{dateStyle:s,timeStyle:i,calendar:l,weekday:u,era:c,year:d,month:h,day:f,hour:y,minute:b,second:g,timeZoneName:A,timeZone:E,hour12:O}).format(e)},Yh=Qh});var cn={};p(cn,{default:()=>tg,getArgumentInputData:()=>eg});var Zh,eg,tg,Bl=m(()=>{Zh=([e,t])=>typeof t!="function"?null:Array.isArray(e)?e.map((r,o)=>t({item:r,index:o})):e&&typeof e=="object"?Object.fromEntries(Object.entries(e).map(([r,o])=>{let n=t({key:r,value:o});return"key"in n&&"value"in n?[n.key,n.value]:null})):null,eg=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{key:o[0],value:o[1]}}}return r},tg=Zh});var dn={};p(dn,{default:()=>og});var rg,og,Vl=m(()=>{rg=([e])=>{if(Array.isArray(e)){let t={};for(let{key:r,value:o}of e)t[r]=o;return t}return null},og=rg});var fn={};p(fn,{default:()=>ag});var ng,ag,Kl=m(()=>{ng=([e,t])=>typeof e!="string"||typeof t!="string"?null:e.split(t),ag=ng});var mn={};p(mn,{default:()=>ig});var sg,ig,Wl=m(()=>{sg=([e,t])=>{if(typeof e=="string")return e[Number(t)];let r=(o,n)=>{if(n.length===0)return o;let[a,...s]=n;return r(o?.[String(a)],s)};return r(e,Array.isArray(t)?t:[t])},ig=sg});var pn={};p(pn,{default:()=>ug});var lg,ug,zl=m(()=>{lg=([e,t])=>{if(typeof e!="string")return null;try{let{hostname:r,searchParams:o,pathname:n,hash:a,href:s,protocol:i,port:l,origin:u}=new URL(e,typeof t=="string"?t:void 0);return{hostname:r,searchParams:Object.fromEntries(o),path:n.split("/").filter((c,d)=>d!==0||c!==""),hash:a.replace("#",""),href:s,protocol:i,port:l,origin:u}}catch{return null}},ug=lg});var hn={};p(hn,{default:()=>dg});var cg,dg,Gl=m(()=>{cg=([e,t])=>isNaN(Number(e))||isNaN(Number(t))?null:Number(e)/Number(t),dg=cg});var gn={};p(gn,{default:()=>mg});var fg,mg,Jl=m(()=>{fg=([e,t])=>isNaN(Number(e))||isNaN(Number(t))?null:Number(e)%Number(t),mg=fg});var yn={};p(yn,{default:()=>pg});var Xl,Ql,pg,Yl=m(()=>{Xl=v(x()),Ql=([e,t,r],o)=>{if(typeof t!="string"&&typeof t!="number"&&!Array.isArray(t))return null;let[n,...a]=Array.isArray(t)?t:[t];if((0,Xl.isObject)(e)){let s=Array.isArray(e)?[...e]:{...e};return s[n]=a.length===0?r:Ql([s[n],a,r],o),s}return null},pg=Ql});var bn={};p(bn,{default:()=>gg});var hg,gg,Zl=m(()=>{hg=([e])=>{if(typeof e!="string"||e.length===0||typeof window>"u")return null;let t=window.localStorage.getItem(e);if(t===null)return t;try{return JSON.parse(t)}catch{return t}},gg=hg});var vn={};p(vn,{default:()=>bg});var yg,bg,eu=m(()=>{yg=([e])=>typeof e=="string"||Array.isArray(e)?e[0]:null,bg=yg});var Fn={};p(Fn,{default:()=>Fg});var vg,Fg,tu=m(()=>{vg=(e,{env:t})=>t.isServer?t.request.url:window?.location.href??null,Fg=vg});var An={};p(An,{default:()=>Ag,getArgumentInputData:()=>wg,handler:()=>ru});var ru,Ag,wg,ou=m(()=>{ru=([e,t])=>{if(typeof t!="function"||!e||typeof e!="object")return null;let r=Array.isArray(e)?e:Object.entries(e),o={};for(let n=0;n<r.length;n++){let a=r[n],s=String(t({item:a,i:n}));o[s]=a}return o},Ag=ru,wg=([e],t,r)=>{if(t===0)return r;if(Array.isArray(e))return{...r,Args:{item:e[0],index:0}};if(e&&typeof e=="object"){let[o]=Object.entries(e);if(o)return{...r,Args:{value:o[1],key:o[0]}}}return r}});var wn={};p(wn,{default:()=>Og});var Eg,Og,nu=m(()=>{Eg=([e,t])=>Array.isArray(e)?[t,...e]:null,Og=Eg});var En={};p(En,{default:()=>jg});var xg,jg,au=m(()=>{xg=([e])=>{if(typeof e!="string"||e.length===0||typeof window>"u")return null;let t=window.sessionStorage.getItem(e);if(t===null)return t;try{return JSON.parse(t)}catch{return t}},jg=xg});var On={};p(On,{default:()=>Cg});var Sg,Cg,su=m(()=>{Sg=([e,t])=>Array.isArray(e)?[...e,t]:null,Cg=Sg});var xn={};p(xn,{default:()=>kg});var _g,kg,iu=m(()=>{_g=([e])=>typeof e!="string"?null:atob(e),kg=_g});var jn={};p(jn,{default:()=>Tg});var Rg,Tg,lu=m(()=>{Rg=(e,{env:t})=>t.isServer?t.request?.headers["accept-language"]?.split(",").map(r=>r.split(";")[0])??[]:window.navigator.languages,Tg=Rg});var Sn={};p(Sn,{default:()=>Pg});var Hg,Pg,uu=m(()=>{Hg=([e],{env:t,root:r})=>!e||typeof e!="string"?null:t.isServer?t.request.cookies[e]??null:r instanceof ShadowRoot?null:r.cookie.split("; ")?.find(o=>o.startsWith(`${e}=`))?.split("=")[1]??null,Pg=Hg});var Cn={};p(Cn,{default:()=>Ig});var Dg,Ig,cu=m(()=>{Dg=([e,t])=>typeof t!="number"?null:JSON.stringify(e,null,t),Ig=Dg});var _n={};p(_n,{default:()=>Ng});var $g,Ng,du=m(()=>{$g=([e])=>String(e),Ng=$g});var kn={};p(kn,{default:()=>qg});var Lg,qg,fu=m(()=>{Lg=([e,t])=>typeof t!="number"?null:Array.isArray(e)?e.slice(0,t):typeof e=="string"?e.substring(0,t):null,qg=Lg});var Rn={};p(Rn,{default:()=>Ug});var Mg,Ug,mu=m(()=>{Mg=([e,t])=>isNaN(Number(e))||isNaN(Number(t))?null:Number(e)**Number(t),Ug=Mg});var pu={};p(pu,{absolute:()=>_o,add:()=>Do,append:()=>On,boolean:()=>qr,branchName:()=>Fo,canShare:()=>Yo,capitalize:()=>Mr,clamp:()=>Wo,concatenate:()=>uo,currentURL:()=>Fn,dateFromString:()=>Uo,dateFromTimestamp:()=>Wr,decodeBase64:()=>xn,decodeURIComponent:()=>on,defaultTo:()=>$o,deleteKey:()=>Xo,divide:()=>hn,drop:()=>Ur,dropLast:()=>Mo,encodeBase64:()=>to,encodeJSON:()=>Cn,encodeURIComponent:()=>eo,entries:()=>Bo,equals:()=>ho,every:()=>vo,filter:()=>jo,find:()=>fo,findIndex:()=>no,findLast:()=>rn,first:()=>vn,flatten:()=>Lo,formatDate:()=>un,formatNumber:()=>go,fromEntries:()=>dn,get:()=>mn,getCookie:()=>Sn,getElementById:()=>Kr,getFromLocalStorage:()=>bn,getFromSessionStorage:()=>En,getHttpOnlyCookie:()=>zr,greaterOrEqueal:()=>so,greaterThan:()=>ko,groupBy:()=>xo,includes:()=>To,indexOf:()=>Qr,isServer:()=>Po,join:()=>Zr,json:()=>qo,keyBy:()=>An,languages:()=>jn,last:()=>wo,lastIndexOf:()=>Yr,lessOrEqual:()=>So,lessThan:()=>bo,lowercase:()=>zo,map:()=>cn,matches:()=>Ao,max:()=>sn,min:()=>en,minus:()=>ln,modulo:()=>gn,multiply:()=>Io,not:()=>Ro,notEqual:()=>Co,now:()=>oo,number:()=>io,parseJSON:()=>Oo,parseURL:()=>pn,power:()=>Rn,prepend:()=>wn,randomNumber:()=>Xr,range:()=>Zo,reduce:()=>co,replaceAll:()=>Ko,reverse:()=>ao,round:()=>Br,roundDown:()=>tn,roundUp:()=>Ho,set:()=>yn,shuffle:()=>Go,size:()=>Gr,some:()=>yo,sort_by:()=>lo,split:()=>fn,squareRoot:()=>ro,startsWith:()=>No,string:()=>_n,sum:()=>an,take:()=>kn,takeLast:()=>mo,timestamp:()=>Jo,trim:()=>Vr,typeOf:()=>po,unique:()=>Vo,uppercase:()=>Jr,userAgent:()=>nn});var hu=m(()=>{ii();li();ui();ci();di();fi();mi();hi();yi();bi();vi();Fi();Ai();wi();Ei();Oi();xi();ji();Ci();_i();ki();Ri();Ti();Pi();Di();$i();Ni();Li();qi();Mi();Bi();Vi();Wi();zi();Gi();Ji();Yi();el();rl();ol();nl();al();sl();ll();ul();cl();dl();fl();ml();hl();gl();yl();bl();vl();Fl();Al();wl();El();Ol();xl();Sl();Cl();kl();Rl();Tl();Hl();Pl();Il();$l();Nl();Ll();ql();Ml();Ul();Bl();Vl();Kl();Wl();zl();Gl();Jl();Yl();Zl();eu();tu();ou();nu();au();su();iu();lu();uu();cu();du();fu();mu()});var Bt=w(M=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0});M.getPathSegments=M.get404Page=M.getRouteDestination=M.matchRoutes=M.matchRouteForUrl=M.matchPageForUrl=void 0;var Bg=qe(),Vg=x(),gu=Tn(),Kg=({url:e,components:t})=>(0,M.matchRoutes)({url:e,entries:yu(t),getRoute:r=>r.route});M.matchPageForUrl=Kg;var Wg=({url:e,routes:t})=>(0,M.matchRoutes)({url:e,entries:Object.values(t??{}),getRoute:r=>r.source});M.matchRouteForUrl=Wg;var zg=({url:e,entries:t,getRoute:r})=>{let o=(0,M.getPathSegments)(e);return Object.values(t).filter(a=>{let s=r(a);return o.length<=s.path.length&&s.path.every((i,l)=>i.type==="param"||i.optional===!0||i.name===o[l])}).sort((a,s)=>{let i=r(a),l=r(s),u=i.path.length-l.path.length;if(u!==0)return u;for(let c=0;c<o.length;c++){let d=i.path[c].type==="static"?1:0,h=l.path[c].type==="static"?1:0;if(d!==h)return h-d}return 0})[0]};M.matchRoutes=zg;var Gg=({files:e,req:t,route:r})=>{try{let o=new URL(t.url),{searchParamsWithDefaults:n,pathParams:a}=(0,gu.getParameters)({route:r.source,req:t}),s=(0,Bg.getUrl)(r.destination,{data:{"Route parameters":{path:a,query:n}},toddle:(0,gu.getServerToddleObject)(e)},r.type==="redirect"?o.origin:void 0);return r.type==="redirect"&&o.origin===s.origin&&o.pathname===s.pathname||r.type==="rewrite"&&o.origin===s.origin?void 0:s}catch{}};M.getRouteDestination=Gg;var Jg=e=>yu(e).find(t=>t.name==="404");M.get404Page=Jg;var yu=e=>Object.values(e).filter(t=>(0,Vg.isDefined)(t.route)),Xg=e=>e.pathname.substring(1).split("/").filter(t=>t!=="").map(t=>decodeURIComponent(t));M.getPathSegments=Xg});var bu=w(se=>{"use strict";var Qg=se&&se.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(se,"__esModule",{value:!0});se.escapeSearchParameters=se.escapeSearchParameter=void 0;var Yg=x(),Zg=Qg(kt()),ey=e=>typeof e=="string"?(0,Zg.default)(e):null;se.escapeSearchParameter=ey;var ty=e=>new URLSearchParams([...e.entries()].reduce((t,[r,o])=>{let n=(0,se.escapeSearchParameter)(o);return(0,Yg.isDefined)(n)&&(t[r]=n),t},{}));se.escapeSearchParameters=ty});var Tn=w(D=>{"use strict";var ry=D&&D.__createBinding||(Object.create?function(e,t,r,o){o===void 0&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){o===void 0&&(o=r),e[o]=t[r]}),oy=D&&D.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ny=D&&D.__importStar||function(){var e=function(t){return e=Object.getOwnPropertyNames||function(r){var o=[];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(o[o.length]=n);return o},e(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(t!=null)for(var o=e(t),n=0;n<o.length;n++)o[n]!=="default"&&ry(r,t,o[n]);return oy(r,t),r}}();Object.defineProperty(D,"__esModule",{value:!0});D.serverEnv=D.getParameters=D.getDataUrlParameters=D.getServerToddleObject=D.getPageFormulaContext=void 0;var ay=V(),sy=Ne(),iy=Q(),vu=x(),ly=ny((hu(),Xu(pu))),uy=Bt(),cy=yr(),dy=bu(),fy=({branchName:e,component:t,req:r,logErrors:o,files:n})=>{let a=(0,D.serverEnv)({req:r,branchName:e,logErrors:o}),{searchParamsWithDefaults:s,hash:i,combinedParams:l,url:u}=(0,D.getParameters)({route:t.route,req:r}),c={data:{Location:{page:t.page??"",path:u.pathname,params:l,query:s,hash:i},Attributes:l,"URL parameters":(0,D.getDataUrlParameters)({route:t.route,req:r}),Apis:{}},component:t,root:null,package:void 0,env:a,toddle:(0,D.getServerToddleObject)(n)};return c.data.Variables=(0,iy.mapValues)(t.variables,({initialValue:d})=>(0,ay.applyFormula)(d,c)),c};D.getPageFormulaContext=fy;var my=e=>{let t=Object.fromEntries(Object.entries(ly).map(([r,o])=>["@toddle/"+r,o.default]));return{getFormula:r=>t[r],getCustomFormula:(r,o)=>{let n;if((0,vu.isDefined)(o)?n=e.packages?.[o]?.formulas?.[r]:n=e.formulas?.[r],n&&(0,sy.isToddleFormula)(n))return n},errors:[]}};D.getServerToddleObject=my;var py=({route:e,req:t})=>{let{searchParamsWithDefaults:r,combinedParams:o}=(0,D.getParameters)({route:e,req:t});return{...r,...o}};D.getDataUrlParameters=py;var hy=({route:e,req:t})=>{let r=new URL(t.url),o=[...(0,dy.escapeSearchParameters)(r.searchParams).entries()].reduce((i,[l,u])=>({...i,[l]:u??null}),{}),n=(0,uy.getPathSegments)(r),a=e?.path.reduce((i,l,u)=>l.type==="param"?(0,vu.isDefined)(n[u])&&typeof n[u]=="string"?{...i,[l.name]:n[u]}:{...i,[l.name]:null}:i,{}),s=Object.keys(e?.query??{}).reduce((i,l)=>({...i,[l]:null}),{});return{pathParams:a,searchParamsWithDefaults:{...s,...o},combinedParams:{...o,...a},hash:r.hash.slice(1),url:r}};D.getParameters=hy;var gy=({branchName:e,req:t,logErrors:r})=>({branchName:e,isServer:!0,request:{headers:Object.fromEntries(t.headers.entries()),cookies:(0,cy.getRequestCookies)(t),url:t.url},logErrors:r});D.serverEnv=gy});var Au=w(Vt=>{"use strict";Object.defineProperty(Vt,"__esModule",{value:!0});Vt.HeadTagTypes=void 0;var Fu;(function(e){e.Meta="meta",e.Link="link",e.Script="script",e.NoScript="noscript",e.Style="style"})(Fu||(Vt.HeadTagTypes=Fu={}))});var wu=w(Re=>{"use strict";Object.defineProperty(Re,"__esModule",{value:!0});Re.transformRelativePaths=Re.isCloudflareImagePath=void 0;var yy=e=>typeof e=="string"&&e.startsWith("/cdn-cgi/imagedelivery/");Re.isCloudflareImagePath=yy;var by=e=>t=>({...t,nodes:Object.entries(t.nodes).reduce((r,[o,n])=>({...r,[o]:{...n,...n.type==="element"?{attrs:Object.entries(n.attrs).reduce((a,[s,i])=>["src"].includes(s)&&i?.type==="value"&&typeof i.value=="string"?{...a,[s]:{...i,value:new URL(i.value,e).href}}:{...a,[s]:i},{})}:{}}}),{})});Re.transformRelativePaths=by});var Eu=w(Kt=>{"use strict";Object.defineProperty(Kt,"__esModule",{value:!0});Kt.nanoid=void 0;var vy="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Fy=(e=21)=>{let t="",r=e|0;for(;r--;)t+=vy[Math.random()*64|0];return t};Kt.nanoid=Fy});var Ou=w(Wt=>{"use strict";Object.defineProperty(Wt,"__esModule",{value:!0});Wt.getFontCssUrl=void 0;var Ay=Q(),wy=({fonts:e,baseForAbsoluteUrls:t,basePath:r="/.toddle/fonts/stylesheet/css2"})=>{if(e.length===0)return;let o=new URLSearchParams;o.set("display","swap");for(let a of e){let s=(0,Ay.easySort)(a.variants.filter(f=>!Number.isNaN(Number(f.weight))),f=>Number(f.weight));if(s.length===0)continue;let i=s.filter(f=>f.italic),l=s.filter(f=>!f.italic),u=(f,y)=>f.map(b=>`${typeof y=="number"?`${y},`:""}${b.weight}`).join(";"),c=i.length>0,d=[l,i].map((f,y)=>u(f,c?y:void 0)).filter(Boolean).join(";"),h=a.family;c?h+=`:ital,wght@${d}`:h+=`:wght@${d}`,o.append("family",h)}let n=`${r}?${o.toString()}`;try{return{swap:typeof t=="string"?new URL(n,t).toString():n}}catch{}};Wt.getFontCssUrl=wy});var Hn=w(Te=>{"use strict";Object.defineProperty(Te,"__esModule",{value:!0});Te.getCharset=Te.getHtmlLanguage=void 0;var xu=V(),Ey=({pageInfo:e,formulaContext:t,defaultLanguage:r="en"})=>{let o=e?.language?(0,xu.applyFormula)(e.language.formula,t):r;return typeof o=="string"?o:r};Te.getHtmlLanguage=Ey;var Oy=({pageInfo:e,formulaContext:t,defaultCharset:r="utf-8"})=>{let o=e?.charset?(0,xu.applyFormula)(e.charset.formula,t):r;return typeof o=="string"?o:r};Te.getCharset=Oy});var ju=w(zt=>{"use strict";Object.defineProperty(zt,"__esModule",{value:!0});zt.defaultSpeculationRules=void 0;zt.defaultSpeculationRules={prerender:[{source:"document",where:{selector_matches:'[data-prerender="eager"]'},eagerness:"eager"},{source:"document",where:{selector_matches:'[data-prerender="moderate"]'},eagerness:"moderate"}]}});var _u=w(ie=>{"use strict";Object.defineProperty(ie,"__esModule",{value:!0});ie.defaultHeadOrdering=ie.renderHeadItems=ie.getHeadItems=void 0;var xy=Au(),ve=V(),jy=Q(),Sy=ee(),ze=x(),Cy=$r(),U=Lr(),Su=wu(),_y=Eu(),ky=Ou(),Ry=Hn(),Ty=ju(),Hy=({cacheBuster:e,context:t,cssBasePath:r="/.toddle/fonts/stylesheet/css2",files:o,page:n,project:a,theme:s,url:i})=>{let l=n.route?.info,u=Dy({component:n,context:t,defaultTitle:a.name}),c=Iy({component:n,context:t,defaultDescription:a.description}),d=[];if(!("breakpoints"in s)&&s.fonts.length>0){let O=(0,ky.getFontCssUrl)({fonts:s.fonts,basePath:r});O&&d.push(["link:font:swap",`<link href="${(0,U.escapeAttrValue)(O.swap.toString())}" rel="stylesheet" />`])}let h=Cu("/_static/reset.css",e),f=(0,Ry.getCharset)({pageInfo:l,formulaContext:t}),y=[];typeof c=="string"&&(y.push(["meta:description",`<meta name="description" content="${(0,U.escapeAttrValue)(c)}" />`]),y.push(["meta:og:description",`<meta property="og:description" content="${(0,U.escapeAttrValue)(c)}" />`]));let b=new Map([["link:reset",`<link rel="stylesheet" fetchpriority="high" href="${(0,U.escapeAttrValue)(h)}" />`],...d,["meta:charset",`<meta charset="${(0,U.escapeAttrValue)(f)}" />`],["meta:viewport",'<meta name="viewport" content="width=device-width, initial-scale=1" />'],["title",`<title>${u}</title>`],["meta:og:title",`<meta property="og:title" content="${(0,U.escapeAttrValue)(u)}" />`],["meta:apple-mobile-web-app-title",`<meta name="apple-mobile-web-app-title" content="${(0,U.escapeAttrValue)(u)}">`],...y,["meta:og:type",'<meta property="og:type" content="website" />'],["meta:og:url",`<meta property="og:url" content="${(0,U.escapeAttrValue)(i.href)}" />`],["meta:application-name",`<meta name="application-name" content="${a.short_id==="toddle"?"toddle":(0,U.escapeAttrValue)(a.name)}">`],["script:speculationrules",`<script type="speculationrules">${JSON.stringify(Ty.defaultSpeculationRules)}</script>`]]);if(a.type==="package"&&a.thumbnail){let O=(0,Su.isCloudflareImagePath)(a.thumbnail.path)?`${i.origin}${a.thumbnail.path}/256`:a.thumbnail.path;b.set("meta:og:image",`<meta property="og:image" content="${(0,U.escapeAttrValue)(`${O}`)}" />`)}if((0,Sy.validateUrl)((0,ve.applyFormula)(o.config?.meta?.manifest?.formula,t))){let O=Cu("/manifest.json",e);b.set("link:manifest",`<link rel="manifest" href="${(0,U.escapeAttrValue)(O)}">`)}else b.set("meta:theme-color",'<meta name="theme-color" content="#171717">'),b.set("meta:msapplication-tilecolor",'<meta name="msapplication-TileColor" content="#171717">');let A=O=>Object.values(l?.meta??{}).some(F=>Object.entries(F.attrs??{}).some(([C,H])=>["name","property"].includes(C.toLowerCase())&&H.type==="value"&&typeof H.value=="string"&&H.value.toLowerCase()===O.toLowerCase())),E=o.config?.meta?.icon;if((0,ze.isDefined)(E)){let O=(0,ve.applyFormula)(E.formula,t);if((0,ze.isDefined)(O)&&typeof O=="string")if((0,Su.isCloudflareImagePath)(O)){let F=O.split("/").slice(0,-1).join("/");b.set("link:icon:16",`<link rel="icon" sizes="16x16" href="${(0,U.escapeAttrValue)(`${F}/16`)}" />`),b.set("link:icon:32",`<link rel="icon" sizes="32x32" href="${(0,U.escapeAttrValue)(`${F}/32`)}" />`),b.set("link:icon",`<link rel="shortcut icon" href="${(0,U.escapeAttrValue)(`${F}/48`)}" />`)}else b.set("link:icon",`<link rel="icon" href="${(0,U.escapeAttrValue)(O)}" />`)}else["link:icon","link:mask-icon","link:apple-touch-icon","link:icon:16","link:icon:32"].every(O=>!A(O))||(a.emoji&&b.set("link:icon",`<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>${(0,U.escapeAttrValue)(a.emoji)}</text></svg>">`),b.set("link:mask-icon",'<link rel="mask-icon" href="https://raw.githubusercontent.com/toddledev/resources/main/icons/safari-pinned-tab.svg" color="#171717">'),b.set("link:apple-touch-icon",'<link rel="apple-touch-icon" sizes="180x180" href="https://raw.githubusercontent.com/toddledev/resources/main/icons/apple-touch-icon.png">'),b.set("link:icon:16",'<link rel="icon" type="image/png" sizes="16x16" href="https://raw.githubusercontent.com/toddledev/resources/main/icons/favicon-16x16.png">'),b.set("link:icon:32",'<link rel="icon" type="image/png" sizes="32x32" href="https://raw.githubusercontent.com/toddledev/resources/main/icons/favicon-32x32.png">'));return l?.meta&&Object.entries(l.meta).forEach(([O,F])=>{if(Object.values(xy.HeadTagTypes).includes(F.tag)){let C=Object.entries(F.attrs??{}).find(([k])=>k==="name"||k==="property"),H=`${F.tag}:${(0,ze.isDefined)(C)?(0,ve.applyFormula)(C[1],t):O??(0,_y.nanoid)()}`;b.set(H,`<${F.tag} data-toddle-id="${O}" ${Object.entries(F.attrs??{}).map(([k,R])=>{let T=(0,ve.applyFormula)(R,t);return T===!0?k:`${k}="${(0,U.escapeAttrValue)(T)}"`}).join(" ")} ${Cy.VOID_HTML_ELEMENTS.includes(F.tag)?"/>":`>${F.content?(0,ve.applyFormula)(F.content,t):""}</${F.tag}>`}`)}}),b};ie.getHeadItems=Hy;var Py=({headItems:e,ordering:t=ie.defaultHeadOrdering})=>(0,jy.easySort)([...e.entries()],([r])=>{let o=t.indexOf(r);return o===-1?t.length:o}).map(([r,o])=>o).join(`
    `);ie.renderHeadItems=Py;ie.defaultHeadOrdering=["meta:charset","meta:viewport","title","meta:description","link:icon:16","link:icon:32","link:icon","meta:og:title","meta:application-name","meta:og:url","meta:og:description","meta:og:type","link:manifest","link:mask-icon","link:apple-touch-icon","meta:theme-color","meta:apple-mobile-web-app-title","meta:msapplication-tilecolor","meta:og:locale","link:reset"];var Dy=({component:e,context:t,defaultTitle:r})=>{let o=e.route?.info,n=r??e.name;if(!(0,ze.isDefined)(o?.title))return n;let a=(0,ve.applyFormula)(o.title.formula,t);return typeof a=="string"?a:n},Iy=({component:e,context:t,defaultDescription:r})=>{let o=e.route?.info;if(!(0,ze.isDefined)(o?.description))return r;let n=(0,ve.applyFormula)(o.description.formula,t);return typeof n=="string"?n:r},Cu=(e,t)=>typeof t=="string"?`${e}?${new URLSearchParams([["v",t]]).toString()}`:e});var Bu=v(Ln());var qn=async(e,t=Object.create(null))=>{let{all:r=!1,dot:o=!1}=t,a=(e instanceof Je?e.raw.headers:e.headers).get("Content-Type");return a?.startsWith("multipart/form-data")||a?.startsWith("application/x-www-form-urlencoded")?ec(e,{all:r,dot:o}):{}};async function ec(e,t){let r=await e.formData();return r?tc(r,t):{}}function tc(e,t){let r=Object.create(null);return e.forEach((o,n)=>{t.all||n.endsWith("[]")?rc(r,n,o):r[n]=o}),t.dot&&Object.entries(r).forEach(([o,n])=>{o.includes(".")&&(oc(r,o,n),delete r[o])}),r}var rc=(e,t,r)=>{e[t]!==void 0?Array.isArray(e[t])?e[t].push(r):e[t]=[e[t],r]:e[t]=r},oc=(e,t,r)=>{let o=e,n=t.split(".");n.forEach((a,s)=>{s===n.length-1?o[a]=r:((!o[a]||typeof o[a]!="object"||Array.isArray(o[a])||o[a]instanceof File)&&(o[a]=Object.create(null)),o=o[a])})};var Yt=e=>{let t=e.split("/");return t[0]===""&&t.shift(),t},Mn=e=>{let{groups:t,path:r}=nc(e),o=Yt(r);return ac(o,t)},nc=e=>{let t=[];return e=e.replace(/\{[^}]+\}/g,(r,o)=>{let n=`@${o}`;return t.push([n,r]),n}),{groups:t,path:e}},ac=(e,t)=>{for(let r=t.length-1;r>=0;r--){let[o]=t[r];for(let n=e.length-1;n>=0;n--)if(e[n].includes(o)){e[n]=e[n].replace(o,t[r][1]);break}}return e},Xe={},Zt=e=>{if(e==="*")return"*";let t=e.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);return t?(Xe[e]||(t[2]?Xe[e]=[e,t[1],new RegExp("^"+t[2]+"$")]:Xe[e]=[e,t[1],!0]),Xe[e]):null},er=(e,t)=>{try{return t(e)}catch{return e.replace(/(?:%[0-9A-Fa-f]{2})+/g,r=>{try{return t(r)}catch{return r}})}},sc=e=>er(e,decodeURI),tr=e=>{let t=e.url,r=t.indexOf("/",8),o=r;for(;o<t.length;o++){let n=t.charCodeAt(o);if(n===37){let a=t.indexOf("?",o),s=t.slice(r,a===-1?void 0:a);return sc(s.includes("%25")?s.replace(/%25/g,"%2525"):s)}else if(n===63)break}return t.slice(r,o)};var Un=e=>{let t=tr(e);return t.length>1&&t.at(-1)==="/"?t.slice(0,-1):t},we=(...e)=>{let t="",r=!1;for(let o of e)t.at(-1)==="/"&&(t=t.slice(0,-1),r=!0),o[0]!=="/"&&(o=`/${o}`),o==="/"&&r?t=`${t}/`:o!=="/"&&(t=`${t}${o}`),o==="/"&&t===""&&(t="/");return t},Qe=e=>{if(!e.match(/\:.+\?$/))return null;let t=e.split("/"),r=[],o="";return t.forEach(n=>{if(n!==""&&!/\:/.test(n))o+="/"+n;else if(/\:/.test(n))if(/\?/.test(n)){r.length===0&&o===""?r.push("/"):r.push(o);let a=n.replace("?","");o+="/"+a,r.push(o)}else o+="/"+n}),r.filter((n,a,s)=>s.indexOf(n)===a)},Qt=e=>/[%+]/.test(e)?(e.indexOf("+")!==-1&&(e=e.replace(/\+/g," ")),e.indexOf("%")!==-1?rr(e):e):e,Bn=(e,t,r)=>{let o;if(!r&&t&&!/[%+]/.test(t)){let s=e.indexOf(`?${t}`,8);for(s===-1&&(s=e.indexOf(`&${t}`,8));s!==-1;){let i=e.charCodeAt(s+t.length+1);if(i===61){let l=s+t.length+2,u=e.indexOf("&",l);return Qt(e.slice(l,u===-1?void 0:u))}else if(i==38||isNaN(i))return"";s=e.indexOf(`&${t}`,s+1)}if(o=/[%+]/.test(e),!o)return}let n={};o??=/[%+]/.test(e);let a=e.indexOf("?",8);for(;a!==-1;){let s=e.indexOf("&",a+1),i=e.indexOf("=",a);i>s&&s!==-1&&(i=-1);let l=e.slice(a+1,i===-1?s===-1?void 0:s:i);if(o&&(l=Qt(l)),a=s,l==="")continue;let u;i===-1?u="":(u=e.slice(i+1,s===-1?void 0:s),o&&(u=Qt(u))),r?(n[l]&&Array.isArray(n[l])||(n[l]=[]),n[l].push(u)):n[l]??=u}return t?n[t]:n},Vn=Bn,Kn=(e,t)=>Bn(e,t,!0),rr=decodeURIComponent;var Wn=e=>er(e,rr),Je=class{raw;#t;#e;routeIndex=0;path;bodyCache={};constructor(e,t="/",r=[[]]){this.raw=e,this.path=t,this.#e=r,this.#t={}}param(e){return e?this.#o(e):this.#a()}#o(e){let t=this.#e[0][this.routeIndex][1][e],r=this.#n(t);return r?/\%/.test(r)?Wn(r):r:void 0}#a(){let e={},t=Object.keys(this.#e[0][this.routeIndex][1]);for(let r of t){let o=this.#n(this.#e[0][this.routeIndex][1][r]);o&&typeof o=="string"&&(e[r]=/\%/.test(o)?Wn(o):o)}return e}#n(e){return this.#e[1]?this.#e[1][e]:e}query(e){return Vn(this.url,e)}queries(e){return Kn(this.url,e)}header(e){if(e)return this.raw.headers.get(e.toLowerCase())??void 0;let t={};return this.raw.headers.forEach((r,o)=>{t[o]=r}),t}async parseBody(e){return this.bodyCache.parsedBody??=await qn(this,e)}#r=e=>{let{bodyCache:t,raw:r}=this,o=t[e];if(o)return o;let n=Object.keys(t)[0];return n?t[n].then(a=>(n==="json"&&(a=JSON.stringify(a)),new Response(a)[e]())):t[e]=r[e]()};json(){return this.#r("json")}text(){return this.#r("text")}arrayBuffer(){return this.#r("arrayBuffer")}blob(){return this.#r("blob")}formData(){return this.#r("formData")}addValidatedData(e,t){this.#t[e]=t}valid(e){return this.#t[e]}get url(){return this.raw.url}get method(){return this.raw.method}get matchedRoutes(){return this.#e[0].map(([[,e]])=>e)}get routePath(){return this.#e[0].map(([[,e]])=>e)[this.routeIndex].path}};var Ye={Stringify:1,BeforeStream:2,Stream:3},X=(e,t)=>{let r=new String(e);return r.isEscaped=!0,r.callbacks=t,r},ic=/[&<>'"]/,zn=async(e,t)=>{let r="";t||=[];let o=await Promise.all(e);for(let n=o.length-1;r+=o[n],n--,!(n<0);n--){let a=o[n];typeof a=="object"&&t.push(...a.callbacks||[]);let s=a.isEscaped;if(a=await(typeof a=="object"?a.toString():a),typeof a=="object"&&t.push(...a.callbacks||[]),a.isEscaped??s)r+=a;else{let i=[r];Ze(a,i),r=i[0]}}return X(r,t)},Ze=(e,t)=>{let r=e.search(ic);if(r===-1){t[0]+=e;return}let o,n,a=0;for(n=r;n<e.length;n++){switch(e.charCodeAt(n)){case 34:o="&quot;";break;case 39:o="&#39;";break;case 38:o="&amp;";break;case 60:o="&lt;";break;case 62:o="&gt;";break;default:continue}t[0]+=e.substring(a,n)+o,a=n+1}t[0]+=e.substring(a,n)},Gn=e=>{let t=e.callbacks;if(!t?.length)return e;let r=[e],o={};return t.forEach(n=>n({phase:Ye.Stringify,buffer:r,context:o})),r[0]},et=async(e,t,r,o,n)=>{typeof e=="object"&&!(e instanceof String)&&(e instanceof Promise||(e=e.toString()),e instanceof Promise&&(e=await e));let a=e.callbacks;if(!a?.length)return Promise.resolve(e);n?n[0]+=e:n=[e];let s=Promise.all(a.map(i=>i({phase:t,buffer:n,context:o}))).then(i=>Promise.all(i.filter(Boolean).map(l=>et(l,t,!1,o,n))).then(()=>n[0]));return r?X(await s,a):s};var Jn="text/plain; charset=UTF-8",or=(e,t={})=>{for(let r of Object.keys(t))e.set(r,t[r]);return e},tt=class{#t;#e;env={};#o;finalized=!1;error;#a=200;#n;#r;#s;#l;#u=!0;#f;#c;#d;#m;#p;constructor(e,t){this.#t=e,t&&(this.#n=t.executionCtx,this.env=t.env,this.#d=t.notFoundHandler,this.#p=t.path,this.#m=t.matchResult)}get req(){return this.#e??=new Je(this.#t,this.#p,this.#m),this.#e}get event(){if(this.#n&&"respondWith"in this.#n)return this.#n;throw Error("This context has no FetchEvent")}get executionCtx(){if(this.#n)return this.#n;throw Error("This context has no ExecutionContext")}get res(){return this.#u=!1,this.#l||=new Response("404 Not Found",{status:404})}set res(e){if(this.#u=!1,this.#l&&e)try{for(let[t,r]of this.#l.headers.entries())if(t!=="content-type")if(t==="set-cookie"){let o=this.#l.headers.getSetCookie();e.headers.delete("set-cookie");for(let n of o)e.headers.append("set-cookie",n)}else e.headers.set(t,r)}catch(t){if(t instanceof TypeError&&t.message.includes("immutable")){this.res=new Response(e.body,{headers:e.headers,status:e.status});return}else throw t}this.#l=e,this.finalized=!0}render=(...e)=>(this.#c??=t=>this.html(t),this.#c(...e));setLayout=e=>this.#f=e;getLayout=()=>this.#f;setRenderer=e=>{this.#c=e};header=(e,t,r)=>{if(t===void 0){this.#r?this.#r.delete(e):this.#s&&delete this.#s[e.toLocaleLowerCase()],this.finalized&&this.res.headers.delete(e);return}r?.append?(this.#r||(this.#u=!1,this.#r=new Headers(this.#s),this.#s={}),this.#r.append(e,t)):this.#r?this.#r.set(e,t):(this.#s??={},this.#s[e.toLowerCase()]=t),this.finalized&&(r?.append?this.res.headers.append(e,t):this.res.headers.set(e,t))};status=e=>{this.#u=!1,this.#a=e};set=(e,t)=>{this.#o??=new Map,this.#o.set(e,t)};get=e=>this.#o?this.#o.get(e):void 0;get var(){return this.#o?Object.fromEntries(this.#o):{}}#i(e,t,r){if(this.#u&&!r&&!t&&this.#a===200)return new Response(e,{headers:this.#s});if(t&&typeof t!="number"){let n=new Headers(t.headers);this.#r&&this.#r.forEach((s,i)=>{i==="set-cookie"?n.append(i,s):n.set(i,s)});let a=or(n,this.#s);return new Response(e,{headers:a,status:t.status??this.#a})}let o=typeof t=="number"?t:this.#a;this.#s??={},this.#r??=new Headers,or(this.#r,this.#s),this.#l&&(this.#l.headers.forEach((n,a)=>{a==="set-cookie"?this.#r?.append(a,n):this.#r?.set(a,n)}),or(this.#r,this.#s)),r??={};for(let[n,a]of Object.entries(r))if(typeof a=="string")this.#r.set(n,a);else{this.#r.delete(n);for(let s of a)this.#r.append(n,s)}return new Response(e,{status:o,headers:this.#r})}newResponse=(...e)=>this.#i(...e);body=(e,t,r)=>typeof t=="number"?this.#i(e,t,r):this.#i(e,t);text=(e,t,r)=>{if(!this.#s){if(this.#u&&!r&&!t)return new Response(e);this.#s={}}return this.#s["content-type"]=Jn,typeof t=="number"?this.#i(e,t,r):this.#i(e,t)};json=(e,t,r)=>{let o=JSON.stringify(e);return this.#s??={},this.#s["content-type"]="application/json",typeof t=="number"?this.#i(o,t,r):this.#i(o,t)};html=(e,t,r)=>(this.#s??={},this.#s["content-type"]="text/html; charset=UTF-8",typeof e=="object"?et(e,Ye.Stringify,!1,{}).then(o=>typeof t=="number"?this.#i(o,t,r):this.#i(o,t)):typeof t=="number"?this.#i(e,t,r):this.#i(e,t));redirect=(e,t)=>(this.#r??=new Headers,this.#r.set("Location",String(e)),this.newResponse(null,t??302));notFound=()=>(this.#d??=()=>new Response,this.#d(this))};var nr=(e,t,r)=>(o,n)=>{let a=-1,s=o instanceof tt;return i(0);async function i(l){if(l<=a)throw new Error("next() called multiple times");a=l;let u,c=!1,d;if(e[l]?(d=e[l][0][0],s&&(o.req.routeIndex=l)):d=l===e.length&&n||void 0,!d)s&&o.finalized===!1&&r&&(u=await r(o));else try{u=await d(o,()=>i(l+1))}catch(h){if(h instanceof Error&&s&&t)o.error=h,u=await t(h,o),c=!0;else throw h}return u&&(o.finalized===!1||c)&&(o.res=u),o}};var I="ALL",Xn="all",Qn=["get","post","put","delete","options","patch"],rt="Can not add a route since the matcher is already built.",ot=class extends Error{};var Yn="__COMPOSED_HANDLER";var lc=e=>e.text("404 Not Found",404),Zn=(e,t)=>"getResponse"in e?e.getResponse():t.text("Internal Server Error",500),ar=class{get;post;put;delete;options;patch;all;on;use;router;getPath;_basePath="/";#t="/";routes=[];constructor(e={}){[...Qn,Xn].forEach(o=>{this[o]=(n,...a)=>(typeof n=="string"?this.#t=n:this.#a(o,this.#t,n),a.forEach(s=>{this.#a(o,this.#t,s)}),this)}),this.on=(o,n,...a)=>{for(let s of[n].flat()){this.#t=s;for(let i of[o].flat())a.map(l=>{this.#a(i.toUpperCase(),this.#t,l)})}return this},this.use=(o,...n)=>(typeof o=="string"?this.#t=o:(this.#t="*",n.unshift(o)),n.forEach(a=>{this.#a(I,this.#t,a)}),this);let r=e.strict??!0;delete e.strict,Object.assign(this,e),this.getPath=r?e.getPath??tr:Un}#e(){let e=new ar({router:this.router,getPath:this.getPath});return e.routes=this.routes,e}#o=lc;errorHandler=Zn;route(e,t){let r=this.basePath(e);return t.routes.map(o=>{let n;t.errorHandler===Zn?n=o.handler:(n=async(a,s)=>(await nr([],t.errorHandler)(a,()=>o.handler(a,s))).res,n[Yn]=o.handler),r.#a(o.method,o.path,n)}),this}basePath(e){let t=this.#e();return t._basePath=we(this._basePath,e),t}onError=e=>(this.errorHandler=e,this);notFound=e=>(this.#o=e,this);mount(e,t,r){let o,n;r&&(typeof r=="function"?n=r:(n=r.optionHandler,o=r.replaceRequest));let a=n?i=>{let l=n(i);return Array.isArray(l)?l:[l]}:i=>{let l;try{l=i.executionCtx}catch{}return[i.env,l]};o||=(()=>{let i=we(this._basePath,e),l=i==="/"?0:i.length;return u=>{let c=new URL(u.url);return c.pathname=c.pathname.slice(l)||"/",new Request(c,u)}})();let s=async(i,l)=>{let u=await t(o(i.req.raw),...a(i));if(u)return u;await l()};return this.#a(I,we(e,"*"),s),this}#a(e,t,r){e=e.toUpperCase(),t=we(this._basePath,t);let o={path:t,method:e,handler:r};this.router.add(e,t,[r,o]),this.routes.push(o)}#n(e,t){if(e instanceof Error)return this.errorHandler(e,t);throw e}#r(e,t,r,o){if(o==="HEAD")return(async()=>new Response(null,await this.#r(e,t,r,"GET")))();let n=this.getPath(e,{env:r}),a=this.router.match(o,n),s=new tt(e,{path:n,matchResult:a,env:r,executionCtx:t,notFoundHandler:this.#o});if(a[0].length===1){let l;try{l=a[0][0][0][0](s,async()=>{s.res=await this.#o(s)})}catch(u){return this.#n(u,s)}return l instanceof Promise?l.then(u=>u||(s.finalized?s.res:this.#o(s))).catch(u=>this.#n(u,s)):l??this.#o(s)}let i=nr(a[0],this.errorHandler,this.#o);return(async()=>{try{let l=await i(s);if(!l.finalized)throw new Error("Context is not finalized. Did you forget to return a Response object or `await next()`?");return l.res}catch(l){return this.#n(l,s)}})()}fetch=(e,...t)=>this.#r(e,t[1],t[0],e.method);request=(e,t,r,o)=>e instanceof Request?this.fetch(t?new Request(e,t):e,r,o):(e=e.toString(),this.fetch(new Request(/^https?:\/\//.test(e)?e:`http://localhost${we("/",e)}`,t),r,o));fire=()=>{addEventListener("fetch",e=>{e.respondWith(this.#r(e.request,e,void 0,e.request.method))})}};var nt="[^/]+",De=".*",Ie="(?:|/.*)",Ee=Symbol(),uc=new Set(".\\+*[^]$()");function cc(e,t){return e.length===1?t.length===1?e<t?-1:1:-1:t.length===1||e===De||e===Ie?1:t===De||t===Ie?-1:e===nt?1:t===nt?-1:e.length===t.length?e<t?-1:1:t.length-e.length}var at=class{#t;#e;#o=Object.create(null);insert(e,t,r,o,n){if(e.length===0){if(this.#t!==void 0)throw Ee;if(n)return;this.#t=t;return}let[a,...s]=e,i=a==="*"?s.length===0?["","",De]:["","",nt]:a==="/*"?["","",Ie]:a.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/),l;if(i){let u=i[1],c=i[2]||nt;if(u&&i[2]&&(c=c.replace(/^\((?!\?:)(?=[^)]+\)$)/,"(?:"),/\((?!\?:)/.test(c)))throw Ee;if(l=this.#o[c],!l){if(Object.keys(this.#o).some(d=>d!==De&&d!==Ie))throw Ee;if(n)return;l=this.#o[c]=new at,u!==""&&(l.#e=o.varIndex++)}!n&&u!==""&&r.push([u,l.#e])}else if(l=this.#o[a],!l){if(Object.keys(this.#o).some(u=>u.length>1&&u!==De&&u!==Ie))throw Ee;if(n)return;l=this.#o[a]=new at}l.insert(s,t,r,o,n)}buildRegExpStr(){let t=Object.keys(this.#o).sort(cc).map(r=>{let o=this.#o[r];return(typeof o.#e=="number"?`(${r})@${o.#e}`:uc.has(r)?`\\${r}`:r)+o.buildRegExpStr()});return typeof this.#t=="number"&&t.unshift(`#${this.#t}`),t.length===0?"":t.length===1?t[0]:"(?:"+t.join("|")+")"}};var ea=class{#t={varIndex:0};#e=new at;insert(e,t,r){let o=[],n=[];for(let s=0;;){let i=!1;if(e=e.replace(/\{[^}]+\}/g,l=>{let u=`@\\${s}`;return n[s]=[u,l],s++,i=!0,u}),!i)break}let a=e.match(/(?::[^\/]+)|(?:\/\*$)|./g)||[];for(let s=n.length-1;s>=0;s--){let[i]=n[s];for(let l=a.length-1;l>=0;l--)if(a[l].indexOf(i)!==-1){a[l]=a[l].replace(i,n[s][1]);break}}return this.#e.insert(a,t,o,this.#t,r),o}buildRegExp(){let e=this.#e.buildRegExpStr();if(e==="")return[/^$/,[],[]];let t=0,r=[],o=[];return e=e.replace(/#(\d+)|@(\d+)|\.\*\$/g,(n,a,s)=>a!==void 0?(r[++t]=Number(a),"$()"):(s!==void 0&&(o[Number(s)]=++t),"")),[new RegExp(`^${e}`),r,o]}};var ta=[],dc=[/^$/,[],Object.create(null)],ra=Object.create(null);function oa(e){return ra[e]??=new RegExp(e==="*"?"":`^${e.replace(/\/\*$|([.\\+*[^\]$()])/g,(t,r)=>r?`\\${r}`:"(?:|/.*)")}$`)}function fc(){ra=Object.create(null)}function mc(e){let t=new ea,r=[];if(e.length===0)return dc;let o=e.map(u=>[!/\*|\/:/.test(u[0]),...u]).sort(([u,c],[d,h])=>u?1:d?-1:c.length-h.length),n=Object.create(null);for(let u=0,c=-1,d=o.length;u<d;u++){let[h,f,y]=o[u];h?n[f]=[y.map(([g])=>[g,Object.create(null)]),ta]:c++;let b;try{b=t.insert(f,c,h)}catch(g){throw g===Ee?new ot(f):g}h||(r[c]=y.map(([g,A])=>{let E=Object.create(null);for(A-=1;A>=0;A--){let[O,F]=b[A];E[O]=F}return[g,E]}))}let[a,s,i]=t.buildRegExp();for(let u=0,c=r.length;u<c;u++)for(let d=0,h=r[u].length;d<h;d++){let f=r[u][d]?.[1];if(!f)continue;let y=Object.keys(f);for(let b=0,g=y.length;b<g;b++)f[y[b]]=i[f[y[b]]]}let l=[];for(let u in s)l[u]=r[s[u]];return[a,l,n]}function Oe(e,t){if(e){for(let r of Object.keys(e).sort((o,n)=>n.length-o.length))if(oa(r).test(t))return[...e[r]]}}var sr=class{name="RegExpRouter";#t;#e;constructor(){this.#t={[I]:Object.create(null)},this.#e={[I]:Object.create(null)}}add(e,t,r){let o=this.#t,n=this.#e;if(!o||!n)throw new Error(rt);o[e]||[o,n].forEach(i=>{i[e]=Object.create(null),Object.keys(i[I]).forEach(l=>{i[e][l]=[...i[I][l]]})}),t==="/*"&&(t="*");let a=(t.match(/\/:/g)||[]).length;if(/\*$/.test(t)){let i=oa(t);e===I?Object.keys(o).forEach(l=>{o[l][t]||=Oe(o[l],t)||Oe(o[I],t)||[]}):o[e][t]||=Oe(o[e],t)||Oe(o[I],t)||[],Object.keys(o).forEach(l=>{(e===I||e===l)&&Object.keys(o[l]).forEach(u=>{i.test(u)&&o[l][u].push([r,a])})}),Object.keys(n).forEach(l=>{(e===I||e===l)&&Object.keys(n[l]).forEach(u=>i.test(u)&&n[l][u].push([r,a]))});return}let s=Qe(t)||[t];for(let i=0,l=s.length;i<l;i++){let u=s[i];Object.keys(n).forEach(c=>{(e===I||e===c)&&(n[c][u]||=[...Oe(o[c],u)||Oe(o[I],u)||[]],n[c][u].push([r,a-l+i+1]))})}}match(e,t){fc();let r=this.#o();return this.match=(o,n)=>{let a=r[o]||r[I],s=a[2][n];if(s)return s;let i=n.match(a[0]);if(!i)return[[],ta];let l=i.indexOf("",1);return[a[1][l],i]},this.match(e,t)}#o(){let e=Object.create(null);return Object.keys(this.#e).concat(Object.keys(this.#t)).forEach(t=>{e[t]||=this.#a(t)}),this.#t=this.#e=void 0,e}#a(e){let t=[],r=e===I;return[this.#t,this.#e].forEach(o=>{let n=o[e]?Object.keys(o[e]).map(a=>[a,o[e][a]]):[];n.length!==0?(r||=!0,t.push(...n)):e!==I&&t.push(...Object.keys(o[I]).map(a=>[a,o[I][a]]))}),r?mc(t):null}};var ir=class{name="SmartRouter";#t=[];#e=[];constructor(e){this.#t=e.routers}add(e,t,r){if(!this.#e)throw new Error(rt);this.#e.push([e,t,r])}match(e,t){if(!this.#e)throw new Error("Fatal error");let r=this.#t,o=this.#e,n=r.length,a=0,s;for(;a<n;a++){let i=r[a];try{for(let l=0,u=o.length;l<u;l++)i.add(...o[l]);s=i.match(e,t)}catch(l){if(l instanceof ot)continue;throw l}this.match=i.match.bind(i),this.#t=[i],this.#e=void 0;break}if(a===n)throw new Error("Fatal error");return this.name=`SmartRouter + ${this.activeRouter.name}`,s}get activeRouter(){if(this.#e||this.#t.length!==1)throw new Error("No active router has been determined yet.");return this.#t[0]}};var $e=Object.create(null),lr=class{#t;#e;#o;#a=0;#n=$e;constructor(e,t,r){if(this.#e=r||Object.create(null),this.#t=[],e&&t){let o=Object.create(null);o[e]={handler:t,possibleKeys:[],score:0},this.#t=[o]}this.#o=[]}insert(e,t,r){this.#a=++this.#a;let o=this,n=Mn(t),a=[];for(let l=0,u=n.length;l<u;l++){let c=n[l];if(Object.keys(o.#e).includes(c)){o=o.#e[c];let h=Zt(c);h&&a.push(h[1]);continue}o.#e[c]=new lr;let d=Zt(c);d&&(o.#o.push(d),a.push(d[1])),o=o.#e[c]}let s=Object.create(null),i={handler:r,possibleKeys:a.filter((l,u,c)=>c.indexOf(l)===u),score:this.#a};return s[e]=i,o.#t.push(s),o}#r(e,t,r,o){let n=[];for(let a=0,s=e.#t.length;a<s;a++){let i=e.#t[a],l=i[t]||i[I],u={};if(l!==void 0&&(l.params=Object.create(null),n.push(l),r!==$e||o&&o!==$e))for(let c=0,d=l.possibleKeys.length;c<d;c++){let h=l.possibleKeys[c],f=u[l.score];l.params[h]=o?.[h]&&!f?o[h]:r[h]??o?.[h],u[l.score]=!0}}return n}search(e,t){let r=[];this.#n=$e;let n=[this],a=Yt(t);for(let s=0,i=a.length;s<i;s++){let l=a[s],u=s===i-1,c=[];for(let d=0,h=n.length;d<h;d++){let f=n[d],y=f.#e[l];y&&(y.#n=f.#n,u?(y.#e["*"]&&r.push(...this.#r(y.#e["*"],e,f.#n)),r.push(...this.#r(y,e,f.#n))):c.push(y));for(let b=0,g=f.#o.length;b<g;b++){let A=f.#o[b],E=f.#n===$e?{}:{...f.#n};if(A==="*"){let R=f.#e["*"];R&&(r.push(...this.#r(R,e,f.#n)),c.push(R));continue}if(l==="")continue;let[O,F,C]=A,H=f.#e[O],k=a.slice(s).join("/");if(C instanceof RegExp&&C.test(k)){E[F]=k,r.push(...this.#r(H,e,f.#n,E));continue}(C===!0||C.test(l))&&(E[F]=l,u?(r.push(...this.#r(H,e,E,f.#n)),H.#e["*"]&&r.push(...this.#r(H.#e["*"],e,E,f.#n))):(H.#n=E,c.push(H)))}}n=c}return r.length>1&&r.sort((s,i)=>s.score-i.score),[r.map(({handler:s,params:i})=>[s,i])]}};var ur=class{name="TrieRouter";#t;constructor(){this.#t=new lr}add(e,t,r){let o=Qe(t);if(o){for(let n=0,a=o.length;n<a;n++)this.#t.insert(e,o[n],r);return}this.#t.insert(e,t,r)}match(e,t){return this.#t.search(e,t)}};var pe=class extends ar{constructor(e={}){super(e),this.router=e.router??new ir({routers:[new sr,new ur]})}};import{staticProject as $y}from"./__project.js";var Aa=v(qe()),Me=v(ee()),wa=v(yr()),yt=v(Fa()),Ea=async e=>{let t=e.req.raw,r=(0,wa.getRequestCookies)(t),o=(0,Me.validateUrl)((0,yt.applyTemplateValues)(t.headers.get(Me.PROXY_URL_HEADER),r));if(!o)return e.json({error:`The provided URL is invalid: ${t.headers.get(Me.PROXY_URL_HEADER)}`},{status:400});let n;try{n=(0,yt.sanitizeProxyHeaders)({cookies:r,headers:t.headers})}catch{return e.json({error:"Proxy validation failed: one or more headers had an invalid name/value"},{status:400})}try{let a=new Request(o.href,{method:e.req.method,headers:n,body:t.body,signal:AbortSignal.timeout(5e3)}),s;try{s=await fetch(a)}catch(u){let c=u instanceof Error&&u.name==="TimeoutError"?504:500;s=Response.json(u.message,{status:c})}let i=Aa.NON_BODY_RESPONSE_CODES.includes(s.status)?void 0:s.body??new ReadableStream;return new Response(i,{status:s.status,headers:Object.fromEntries(s.headers)})}catch(a){let s=a instanceof Error?a.message:"Unable to build a valid request from the API definition";return e.json({error:s},{status:500})}};var _r=v(x());var Sa=v(Ft()),Ue=v(Ne()),Y=v(Q()),Be=v(x());function Ar({component:e,files:t}){if(!(0,Be.isDefined)(e))return{__PROJECT__:{actions:{...t.actions??{}},formulas:{...t.formulas??{}}},...(0,Y.mapObject)(t.packages??{},([a,{actions:s,formulas:i}])=>[a,{actions:s??{},formulas:i??{}}])};let r=new Set,o=new Set,n=new Sa.ToddleComponent({component:e,getComponent:(a,s)=>{let i=[s,a].filter(Be.isDefined).join("/"),l=s?t.packages?.[s]?.components[a]:t.components[a];if(l)return l},packageName:void 0,globalFormulas:{formulas:t.formulas,packages:t.packages}});return n.actionReferences.forEach(a=>r.add(a)),n.formulaReferences.forEach(a=>o.add(a)),n.uniqueSubComponents.forEach(a=>{a.actionReferences.forEach(s=>r.add([a.packageName,s].filter(Be.isDefined).join("/"))),a.formulaReferences.forEach(s=>o.add([a.packageName,s].filter(Be.isDefined).join("/")))}),{...(0,Y.mapObject)((0,Y.filterObject)(t.packages??{},([a,{actions:s,formulas:i}])=>Object.values(s??{}).some(l=>r.has(`${a}/${l.name}`))||Object.values(i??{}).some(l=>o.has(`${a}/${l.name}`))),([a,{actions:s,formulas:i}])=>[a,{actions:(0,Y.filterObject)(s??{},([l,u])=>typeof u.name=="string"&&r.has(`${a}/${u.name}`)),formulas:(0,Y.filterObject)(i??{},([l,u])=>typeof u.name=="string"&&o.has(`${a}/${u.name}`))}]),__PROJECT__:{actions:{...Object.fromEntries(Object.entries(t.actions??{}).filter(([a])=>r.has(a)))},formulas:{...Object.fromEntries(Object.entries(t.formulas??{}).filter(([a])=>o.has(a)))}}}}var Ca=(e,t)=>{let r=Ar({component:e,files:t});return Object.values(r).some(o=>Object.keys(o.actions).length>0||Object.keys(o.formulas).length>0)},_a=({code:e,componentName:t,projectId:r})=>{let o=(0,Y.mapObject)((0,Y.filterObject)(e,([a,s])=>Object.values(s.actions).some(i=>i.version===2)),([a,s])=>[a==="__PROJECT__"?r:a,s]),n=(0,Y.mapObject)((0,Y.filterObject)(e,([a,s])=>Object.values(s.formulas).some(i=>(0,Ue.isToddleFormula)(i)||i.version===2)),([a,s])=>[a==="__PROJECT__"?r:a,s]);return`/*
 * This file is autogenerated by toddle and should not be edited manually.
 *
 * ${typeof t=="string"?`Entry file: ${t}`:"No entry file specified"}
 */

export const project = "${r}";

export const loadCustomCode = () => {
  ${Object.values(e.__PROJECT__.actions).filter(a=>typeof a.name=="string"&&a.version===void 0).map(a=>a.handler).join(`
`)}
  ${Object.values(e.__PROJECT__.formulas).filter(a=>!(0,Ue.isToddleFormula)(a)&&typeof a.name=="string"&&a.version===void 0).map(a=>a.handler).join(`
`)}
}

export const actions = {
  ${Object.entries(o).map(([a,{actions:s}])=>`"${a}": {
    ${Object.values(s).filter(i=>i.version===2).map(i=>`"${i.name}": {
      arguments: ${JSON.stringify(i.arguments)},
      handler: (args, ctx) => {
        ${i.handler}
        return ${ja(i.name)}(args, ctx)
      }
    }`).join(`,
`)}
  }`).join(`,
`)}
}

export const formulas = {
  ${Object.entries(n).map(([a,{formulas:s}])=>`"${a}": {
    ${Object.values(s).filter(i=>(0,Ue.isToddleFormula)(i)||i.version===2).map(i=>(0,Ue.isToddleFormula)(i)?`"${i.name}": {
      arguments: ${JSON.stringify(i.arguments)},
      formula: ${JSON.stringify(i.formula)}
    }`:`"${i.name}": {
      arguments: ${JSON.stringify(i.arguments)},
      handler: (args, ctx) => {
        ${i.handler}
        return ${ja(i.name)}(args, ctx)
      }
    }`).join(`,
`)}
  }`).join(`,
`)}
}`},ja=e=>e.replaceAll(/[^a-zA-Z0-9_]/g,"").replace(/^[0-9]+/,"");var xf=v(x()),ls=v(kt()),Rt=e=>typeof e=="string"?(0,ls.default)(e):null;var us=async e=>{let t=new URL(e.req.url),r=Rt(t.searchParams.get("entry")),o;if((0,_r.isDefined)(r)&&(o=e.var.project.files.components[r],!(0,_r.isDefined)(o)))return e.text(`Component "${r}" not found in project`,{status:404});let n=Ar({component:o,files:e.var.project.files}),a=_a({code:n,componentName:o?.name??r??void 0,projectId:e.var.project.project.short_id}),s={"content-type":"text/javascript","Access-Control-Allow-Origin":"*"};return new Response(a,{headers:s})};var Hr=v(cs()),ys=v(x()),bs=v(Rr()),vs=v(fs()),Fs=v(ms());var ps=v(Q()),hs=({fonts:e,baseForAbsoluteUrls:t,basePath:r="/.toddle/fonts/stylesheet/css2"})=>{if(e.length===0)return;let o=new URLSearchParams;o.set("display","swap");for(let a of e){let s=(0,ps.easySort)(a.variants.filter(f=>!Number.isNaN(Number(f.weight))),f=>Number(f.weight));if(s.length===0)continue;let i=s.filter(f=>f.italic),l=s.filter(f=>!f.italic),u=(f,y)=>f.map(b=>`${typeof y=="number"?`${y},`:""}${b.weight}`).join(";"),c=i.length>0,d=[l,i].map((f,y)=>u(f,c?y:void 0)).filter(Boolean).join(";"),h=a.family;c?h+=`:ital,wght@${d}`:h+=`:wght@${d}`,o.append("family",h)}let n=`${r}?${o.toString()}`;try{return{swap:typeof t=="string"?new URL(n,t).toString():n}}catch{}};var gs=e=>t=>({...t,nodes:Object.entries(t.nodes).reduce((r,[o,n])=>({...r,[o]:{...n,...n.type==="element"?{attrs:Object.entries(n.attrs).reduce((a,[s,i])=>["src"].includes(s)&&i?.type==="value"&&typeof i.value=="string"?{...a,[s]:{...i,value:new URL(i.value,e).href}}:{...a,[s]:i},{})}:{}}}),{})});var As=async e=>{let t=new URL(e.req.url),r=e.req.param("filename")?.replace(".js",""),o=(s,i)=>e.json({error:s,info:"Please see https://toddle.dev/docs/export-component for more information on web component export"},{headers:{"Access-Control-Allow-Origin":"*"},status:i}),{files:n,project:a}=e.var.project;try{let s=Object.values(n.components).find(f=>f.name===r);if(!s)return o(`Unable to find component ${Rt(r)}`,404);if(s.route)return o("Pages are not supported as custom elements, only components",403);let i=n.themes??{},l=Object.values(i).flatMap(f=>f.fonts),u=(0,bs.takeIncludedComponents)({root:s,projectComponents:n.components,packages:n.packages}),c=new URLSearchParams([["entry",s.name]]),d=hs({fonts:l,baseForAbsoluteUrls:t.origin}),h=`/*
 * This file is autogenerated by toddle and should not be edited manually.
 *
 * <${(0,Hr.safeCustomElementName)(s.name)} />
 *
 * Attributes:
 *
 * ${Object.entries(s.attributes??{}).map(([,f])=>`- ${f.name}`).join(`
 * `)}
 *
 * Events:
 *
 * ${Object.entries(s.events??{}).map(([,f])=>`- ${f.name}`).join(`
 * `)}
 */

import { defineComponents, loadCorePlugins } from '/_static/esm-custom-element.main.js';
import { loadCustomCode, formulas, actions } from '/.toddle/custom-code.js?${c.toString()}';

${(0,ys.isDefined)(d)?`
    // Font loading in shadow-dom is not supported widely, so we inject in <head>
    // Ideally, we would inject the stylesheet directly in the ToddleComponent,
    // but it appears it doesn't fetch the fonts - only the stylesheet
    // See https://developer.mozilla.org/en-US/docs/Web/API/Web_components/Using_custom_elements#referencing_external_styles
    const linkElem = document.createElement("link");
    linkElem.setAttribute("rel", "stylesheet");
    linkElem.setAttribute("href", "${d.swap}");
    document.head.appendChild(linkElem);`:""}

// Global toddle object
const toddle = (() => {
  const legacyActions = {}
  const legacyFormulas = {}
  const argumentInputDataList = {}
  return {
    formulas,
    actions,
    errors:[],
    project:"${a.name}",
    branch:"main",
    commit:"unknown",
    registerAction: (name, handler) => {
      if (legacyActions[name]) {
        console.error('There already exists an action with the name ', name)
        return
      }
      legacyActions[name] = handler
    },
    getAction: (name) => legacyActions[name],
    registerFormula: (name,handler,getArgumentInputData) => {
      if (legacyFormulas[name]) {
        console.error('There already exists a formula with the name ', name)
        return
      }
      legacyFormulas[name] = handler
      if (getArgumentInputData) {
        argumentInputDataList[name] = getArgumentInputData
      }
    },
    getFormula: (name) => legacyFormulas[name],
    getCustomAction: (name, packageName) => {
      return actions[packageName ?? "${a.name}"]?.[name] ?? actions["${a.name}"]?.[name]
    },
    getCustomFormula: (name, packageName) => {
      return formulas[packageName ?? "${a.name}"]?.[name] ?? formulas["${a.name}"]?.[name]
    },
    getArgumentInputData: (formulaName,args,argIndex,data
    ) => argumentInputDataList[formulaName]?.(args, argIndex, data) || data,
    data: {},
    locationSignal: null,
    eventLog: [],
    pageState: {},
    env: {
      isServer: false,
      branchName: "main",
      request: undefined,
    }
  }
})();

// Load core plugin (actions and formulas)
loadCorePlugins(toddle);

// Load project's custom actions and formulas
loadCustomCode();

// toddle.isEqual is required for some formulas to work. TODO: Remove this once they can consume from somewhere else.
if(!globalThis.toddle || !globalThis.toddle.isEqual) {
  globalThis.toddle = {
    isEqual: toddle.isEqual,
  }
}

// Define the custom element
defineComponents(${JSON.stringify([s.name])}, ${JSON.stringify({themes:i,components:u.map((0,Fs.replaceTagInNodes)((0,Hr.safeCustomElementName)(s.name),"div")).map(vs.removeTestData).map(gs(t.origin))})}, toddle);
`;return new Response(h,{headers:{"Cache-Control":"no-cache","Access-Control-Allow-Origin":"*","content-type":"text/javascript"}})}catch{return o("404",404)}};var ws=v(V()),Es=v(ee()),Os=v(x());var Pr=class{writer;encoder;writable;abortSubscribers=[];responseReadable;aborted=!1;closed=!1;constructor(e,t){this.writable=e,this.writer=e.getWriter(),this.encoder=new TextEncoder;let r=t.getReader();this.abortSubscribers.push(async()=>{await r.cancel()}),this.responseReadable=new ReadableStream({async pull(o){let{done:n,value:a}=await r.read();n?o.close():o.enqueue(a)},cancel:()=>{this.abort()}})}async write(e){try{typeof e=="string"&&(e=this.encoder.encode(e)),await this.writer.write(e)}catch{}return this}async writeln(e){return await this.write(e+`
`),this}sleep(e){return new Promise(t=>setTimeout(t,e))}async close(){try{await this.writer.close()}catch{}this.closed=!0}async pipe(e){this.writer.releaseLock(),await e.pipeTo(this.writable,{preventClose:!0}),this.writer=this.writable.getWriter()}onAbort(e){this.abortSubscribers.push(e)}abort(){this.aborted||(this.aborted=!0,this.abortSubscribers.forEach(e=>e()))}};var Rf=new WeakMap,K=(e,t,r)=>{let{readable:o,writable:n}=new TransformStream,a=new Pr(n,o);return e.req.raw.signal.addEventListener("abort",()=>{a.closed||a.abort()}),Rf.set(a.responseReadable,e),(async()=>{try{await t(a)}catch(s){s===void 0||s instanceof Error&&r&&await r(s,a)}finally{a.close()}})(),e.newResponse(a.responseReadable)};var xs=async e=>{try{let t=(0,ws.applyFormula)(e.var.project.files.config?.meta?.icon?.formula,void 0),r=(0,Es.validateUrl)(t);if(r){let{body:o,ok:n,headers:a}=await fetch(r);if(n&&o){e.header("Cache-Control","public, max-age=3600");let s=a.get("content-type");return(0,Os.isDefined)(s)&&e.header("Content-Type",s),K(e,i=>i.pipe(o))}}}catch{}return new Response(null,{status:404})};var js=e=>{let r={...{origin:"*",allowMethods:["GET","HEAD","PUT","POST","DELETE","PATCH"],allowHeaders:[],exposeHeaders:[]},...e},o=(n=>typeof n=="string"?n==="*"?()=>n:a=>n===a?a:null:typeof n=="function"?n:a=>n.includes(a)?a:null)(r.origin);return async function(a,s){function i(u,c){a.res.headers.set(u,c)}let l=o(a.req.header("origin")||"",a);if(l&&i("Access-Control-Allow-Origin",l),r.origin!=="*"){let u=a.req.header("Vary");u?i("Vary",u):i("Vary","Origin")}if(r.credentials&&i("Access-Control-Allow-Credentials","true"),r.exposeHeaders?.length&&i("Access-Control-Expose-Headers",r.exposeHeaders.join(",")),a.req.method==="OPTIONS"){r.maxAge!=null&&i("Access-Control-Max-Age",r.maxAge.toString()),r.allowMethods?.length&&i("Access-Control-Allow-Methods",r.allowMethods.join(","));let u=r.allowHeaders;if(!u?.length){let c=a.req.header("Access-Control-Request-Headers");c&&(u=c.split(/\s*,\s*/))}return u?.length&&(i("Access-Control-Allow-Headers",u.join(",")),a.res.headers.append("Vary","Access-Control-Request-Headers")),a.res.headers.delete("Content-Length"),a.res.headers.delete("Content-Type"),new Response(null,{headers:a.res.headers,status:204,statusText:"No Content"})}await s()}};var We=new pe;We.use(js());We.get("/stylesheet/:stylesheet{.*}",async({req:e,...t})=>{let r=new URL(e.url);try{let o=await fetch(`https://fonts.googleapis.com/${e.param("stylesheet")}${r.search}`,Ss(e.raw)),n=await o.text();if(o.ok)n=n.replaceAll("https://fonts.gstatic.com","/.toddle/fonts/font");else return new Response(void 0,{headers:{"Content-Type":"text/css; charset=utf-8"},status:404});let a=Cs(o.headers);return Array.from(a.entries()).forEach(([s,i])=>t.header(s,i)),t.body(n)}catch{}return new Response(void 0,{headers:{"Content-Type":"text/css; charset=utf-8"},status:404})});We.get("/font/:font{.*}",async e=>{try{let t=Ss(e.req.raw),r=await fetch(`https://fonts.gstatic.com/${e.req.param("font")}`,t),o=Cs(r.headers);if(Array.from(o.entries()).forEach(([n,a])=>e.header(n,a)),r.ok&&r.body)return K(e,n=>n.pipe(r.body))}catch{}return new Response(void 0,{status:404})});var Ss=e=>({method:e.method,headers:["Accept","Accept-Encoding","Accept-Language","Referer","User-Agent"].map(t=>[t,e.headers.get(t)]).filter(t=>typeof t[1]=="string")}),Cs=e=>new Headers(["Content-Type","Cache-Control","Expires","Accept-Ranges","Date","Last-Modified","ETag"].map(t=>[t,e.get(t)]).filter(t=>typeof t[1]=="string"));var _s=v(V()),ks=v(ee());var Tf="application/manifest+json",Rs=async e=>{try{let t=(0,_s.applyFormula)(e.var.project.files.config?.meta?.manifest?.formula,void 0);if(typeof(0,ks.validateUrl)(t)=="string"){let{body:o,ok:n}=await fetch(t);if(n&&o)return e.header("Content-Type",Tf),e.header("Cache-Control","public, max-age=3600"),K(e,a=>a.pipe(o))}}catch{}return new Response(null,{status:404})};var Hs=v(V()),Ps=v(ee());var Ts="text/plain",Ds=async e=>{try{let t=e.var.project.files.config?.meta?.robots,r=(0,Hs.applyFormula)(t?.formula,void 0),o=(0,Ps.validateUrl)(r);if(o){let{body:s,ok:i}=await fetch(o);if(i&&s)return e.header("Content-Type",Ts),e.header("Cache-Control","public, max-age=3600"),K(e,l=>l.pipe(s))}let a=`Sitemap: ${new URL(e.req.url).origin}/sitemap.xml

User-agent: *
Disallow: /_toddle
Disallow: /_toddle/
Disallow: /.toddle
Disallow: /.toddle/
Disallow: /_api
Disallow: /_api/
Allow: /cdn-cgi/imagedelivery/*
Disallow: /cdn-cgi/
`;return new Response(a,{headers:{"Content-Type":Ts,"Cache-Control":"public, max-age=3600"}})}catch{}return new Response("404",{status:404})};var Is=v(V()),$s=v(ee()),Ns=v(x());var Ls=async e=>{try{let t=e.var.project.files.config,r=(0,Ns.isDefined)(t?.meta?.serviceWorker)?(0,Is.applyFormula)(t.meta.serviceWorker.formula,void 0):void 0,o=(0,$s.validateUrl)(r);if(o){let{body:n,ok:a}=await fetch(o);if(a&&n)return e.header("Content-Type","text/javascript"),K(e,s=>s.pipe(n))}return new Response(null,{status:404})}catch{}return new Response(null,{status:404})};var Ms=v(vr()),Us=v(V()),Bs=v(ee()),Vs=v(x());var qs="application/xml",Ks=async e=>{try{let t=new URL(e.req.url),r=e.var.project,o=r.files.config?.meta?.sitemap?.formula;if((0,Vs.isDefined)(o)){let n=(0,Bs.validateUrl)((0,Us.applyFormula)(o,void 0));if(n){let{body:a,ok:s}=await fetch(n);if(s&&a)return e.header("Content-Type",qs),e.header("Cache-Control","public, max-age=3600"),K(e,i=>i.pipe(a))}else return new Response(null,{status:404})}else{let n=`<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
  ${Object.values(r.files.components).filter((a,s)=>!!(a&&(0,Ms.isPageComponent)(a)&&a.route?.path.every(i=>i.type==="static")&&s<1e3)).sort((a,s)=>{let i=a.route.path.length,l=s.route.path.length;return i-l}).map(a=>`
<url>
  <loc>${t.origin}/${a.route.path.map(s=>s.name).join("/")}</loc>
</url>`).join("")}
</urlset>`;return new Response(n,{headers:{"Content-Type":qs,"Cache-Control":"public, max-age=3600"}})}}catch{}return new Response(null,{status:404})};var Ws=v(Pt());var Dr=new pe;Dr.get("/reset.css",e=>(e.header("Content-Type","text/css"),e.header("Cache-Control","public, max-age=3600"),e.body(Ws.RESET_STYLES)));var Pu=v(Ft()),qv=v(V()),Du=v(ei()),Iu=v(Pt()),$u=v(x()),Nu=v(Rr()),Lu=v(ai()),qu=v(Tn()),Gt=v(_u()),Jt=v(Hn()),He=v(Bt());var Fe=v(Q());function Pn(e){return{...e,attributes:(0,Fe.mapObject)(e.attributes,([t,r])=>[t,(0,Fe.omit)(r,["testValue"])]),...e.route?{route:{...e.route,path:e.route.path.map(t=>(0,Fe.omit)(t,["testValue"])),query:(0,Fe.mapObject)(e.route.query,([t,r])=>[t,(0,Fe.omit)(r,["testValue"])])}}:{}}}var ku=(e,...t)=>{let r=[""];for(let o=0,n=e.length-1;o<n;o++){r[0]+=e[o];let a=Array.isArray(t[o])?t[o].flat(1/0):[t[o]];for(let s=0,i=a.length;s<i;s++){let l=a[s];if(typeof l=="string")Ze(l,r);else if(typeof l=="number")r[0]+=l;else{if(typeof l=="boolean"||l===null||l===void 0)continue;if(typeof l=="object"&&l.isEscaped)if(l.callbacks)r.unshift("",l);else{let u=l.toString();u instanceof Promise?r.unshift("",u):r[0]+=u}else l instanceof Promise?r.unshift("",l):Ze(l.toString(),r)}}}return r[0]+=e.at(-1),r.length===1?"callbacks"in r?X(Gn(X(r[0],r.callbacks))):X(r[0]):zn(r,r.callbacks)};var Ru=v(qe()),Dn=v(ee()),Tu=v(Bt()),Hu=async(e,t)=>{let r=(0,Tu.getRouteDestination)({files:e.var.project.files,req:e.req.raw,route:t});if(!r)return e.html("Invalid destination",{status:500});if(t.type==="redirect")return e.redirect(r.href,t.status??302);if(e.req.raw.headers.get(Dn.REWRITE_HEADER)!==null)return e.html("toddle rewrites are not allowed to be recursive",{status:500});try{let o=new Headers;o.set("accept-encoding","gzip"),o.set("accept","*/*"),o.set(Dn.REWRITE_HEADER,"true");let n=await fetch(r,{headers:o,method:"GET"}),a=Ru.NON_BODY_RESPONSE_CODES.includes(n.status)?void 0:n.body??new ReadableStream;return new Response(a,{status:n.status,headers:{...Object.fromEntries(n.headers.entries().filter(([i])=>i!=="content-encoding"))}})}catch{return e.html(`Internal server error when fetching url: ${r.href}`,{status:500})}};var Mu=async e=>{let t=e.var.project,r=new URL(e.req.url),o=(0,He.matchRouteForUrl)({url:r,routes:t.files.routes});if(o)return Hu(e,o);let n=(0,He.matchPageForUrl)({url:r,components:t.files.components});if(!n&&(n=(0,He.get404Page)(t.files.components),!n))return e.html("Page not found",{status:404});let a=(0,qu.getPageFormulaContext)({component:n,branchName:"main",req:e.req.raw,logErrors:!0,files:t.files}),s=(0,Jt.getHtmlLanguage)({pageInfo:n.route.info,formulaContext:a,defaultLanguage:"en"}),i=(t.files.themes?Object.values(t.files.themes)[0]:t.files.config?.theme)??Iu.theme,l=(0,Nu.takeIncludedComponents)({root:n,projectComponents:t.files.components,packages:t.files.packages,includeRoot:!0}),u=(0,Du.createStylesheet)(n,l,i,{includeResetStyle:!1,createFontFaces:!1}),c=new Pu.ToddleComponent({component:n,getComponent:(A,E)=>{let O=[E,A].filter($u.isDefined).join("/"),F=E?t.files.packages?.[E]?.components[A]:t.files.components[A];if(F)return F},packageName:void 0,globalFormulas:{formulas:t.files.formulas,packages:t.files.packages}}),d=(0,Gt.renderHeadItems)({headItems:(0,Gt.getHeadItems)({url:r,cssBasePath:"/.toddle/fonts/stylesheet/css2",page:c,files:t.files,project:t.project,context:a,theme:i})}),{html:h}=await(0,Lu.renderPageBody)({component:c,formulaContext:a,env:a.env,req:e.req.raw,files:t.files,includedComponents:l,evaluateComponentApis:async A=>({}),projectId:"my_project"}),f=(0,Jt.getCharset)({pageInfo:c.route?.info,formulaContext:a}),y={project:e.var.project.project.short_id,branch:"main",commit:"unknown",pageState:a.data,component:Pn(n),components:l.map(Pn),isPageLoaded:!1,cookies:Object.keys(a.env.request.cookies)},b=Ca(c,e.var.project.files),g="";return b?g=`
            <script type="module">
              import { initGlobalObject, createRoot } from '/_static/esm-page.main.js';
              import { loadCustomCode, formulas, actions } from '/.toddle/custom-code.js?${new URLSearchParams([["entry",c.name]]).toString()}';

              window.__toddle = ${JSON.stringify(y).replaceAll("</script>","<\\/script>")};
              window.__toddle.components = [window.__toddle.component, ...window.__toddle.components];
              initGlobalObject({formulas, actions});
              loadCustomCode();
              createRoot(document.getElementById("App"));
            </script>
          `:g=`
        <script type="module">
          import { initGlobalObject, createRoot } from '/_static/esm-page.main.js';

          window.__toddle = ${JSON.stringify(y).replaceAll("</script>","<\\/script>")};
          window.__toddle.components = [window.__toddle.component, ...window.__toddle.components];
          initGlobalObject({formulas: {}, actions: {}});
          createRoot(document.getElementById("App"));
        </script>
    `,e.html(ku`<!doctype html>
      <html lang="${s}">
        <head>
          ${X(d)}
          <style>
            ${X(u)}
          </style>
          ${X(g)}
        </head>
        <body>
          <div id="App">${X(h)}</div>
        </body>
      </html>`,{headers:{"Content-Type":`text/html; charset=${f}`}})};var Uu=()=>{let e=new pe;return e.route("/_static",Dr),e.use(async(t,r)=>{let o=$y;return t.set("project",o),r()}),e.get("/sitemap.xml",Ks),e.get("/robots.txt",Ds),e.get("/manifest.json",Rs),e.get("/favicon.ico",xs),e.get("/serviceWorker.js",Ls),e.route("/.toddle/fonts",We),e.get("/.toddle/custom-code.js",us),e.all("/.toddle/omvej/components/:componentName/apis/:apiName",Ea),e.get("/.toddle/custom-element/:filename{.+.js}",As),e.get("/*",Mu),e};(0,Bu.initIsEqual)();var iF={fetch(e,t){return Uu().fetch(e,t)}};export{iF as default};
